ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 1


   1              		.cpu cortex-m7
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"tcp_in.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.tcp_getoptbyte,"ax",%progbits
  18              		.align	1
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu fpv5-sp-d16
  24              	tcp_getoptbyte:
  25              	.LFB142:
  26              		.file 1 "Middlewares/Third_Party/LwIP/src/core/tcp_in.c"
   1:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /**
   2:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * @file
   3:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Transmission Control Protocol, incoming traffic
   4:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
   5:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * The input processing functions of the TCP layer.
   6:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
   7:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * These functions are generally called in the order (ip_input() ->)
   8:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * tcp_input() -> * tcp_process() -> tcp_receive() (-> application).
   9:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
  10:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  */
  11:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
  12:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /*
  13:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Copyright (c) 2001-2004 Swedish Institute of Computer Science.
  14:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * All rights reserved.
  15:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
  16:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Redistribution and use in source and binary forms, with or without modification,
  17:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * are permitted provided that the following conditions are met:
  18:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
  19:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * 1. Redistributions of source code must retain the above copyright notice,
  20:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *    this list of conditions and the following disclaimer.
  21:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * 2. Redistributions in binary form must reproduce the above copyright notice,
  22:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *    this list of conditions and the following disclaimer in the documentation
  23:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *    and/or other materials provided with the distribution.
  24:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * 3. The name of the author may not be used to endorse or promote products
  25:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *    derived from this software without specific prior written permission.
  26:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
  27:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED
  28:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  29:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
  30:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  31:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
  32:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 2


  33:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
  34:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
  35:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY
  36:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * OF SUCH DAMAGE.
  37:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
  38:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * This file is part of the lwIP TCP/IP stack.
  39:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
  40:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Author: Adam Dunkels <adam@sics.se>
  41:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
  42:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  */
  43:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
  44:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/opt.h"
  45:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
  46:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if LWIP_TCP /* don't build if not configured for use in lwipopts.h */
  47:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
  48:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/priv/tcp_priv.h"
  49:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/def.h"
  50:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/ip_addr.h"
  51:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/netif.h"
  52:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/mem.h"
  53:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/memp.h"
  54:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/inet_chksum.h"
  55:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/stats.h"
  56:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/ip6.h"
  57:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/ip6_addr.h"
  58:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if LWIP_ND6_TCP_REACHABILITY_HINTS
  59:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #include "lwip/nd6.h"
  60:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* LWIP_ND6_TCP_REACHABILITY_HINTS */
  61:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
  62:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /** Initial CWND calculation as defined RFC 2581 */
  63:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #define LWIP_TCP_CALC_INITIAL_CWND(mss) LWIP_MIN((4U * (mss)), LWIP_MAX((2U * (mss)), 4380U));
  64:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /** Initial slow start threshold value: we use the full window */
  65:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #define LWIP_TCP_INITIAL_SSTHRESH(pcb)  ((pcb)->snd_wnd)
  66:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
  67:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /* These variables are global to all functions involved in the input
  68:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****    processing of TCP segments. They are set by the tcp_input()
  69:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****    function. */
  70:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static struct tcp_seg inseg;
  71:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static struct tcp_hdr *tcphdr;
  72:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static u16_t tcphdr_optlen;
  73:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static u16_t tcphdr_opt1len;
  74:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static u8_t* tcphdr_opt2;
  75:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static u16_t tcp_optidx;
  76:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static u32_t seqno, ackno;
  77:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static tcpwnd_size_t recv_acked;
  78:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static u16_t tcplen;
  79:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static u8_t flags;
  80:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
  81:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static u8_t recv_flags;
  82:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static struct pbuf *recv_data;
  83:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
  84:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** struct tcp_pcb *tcp_input_pcb;
  85:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
  86:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /* Forward declarations. */
  87:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static err_t tcp_process(struct tcp_pcb *pcb);
  88:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static void tcp_receive(struct tcp_pcb *pcb);
  89:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static void tcp_parseopt(struct tcp_pcb *pcb);
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 3


  90:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
  91:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static void tcp_listen_input(struct tcp_pcb_listen *pcb);
  92:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static void tcp_timewait_input(struct tcp_pcb *pcb);
  93:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
  94:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /**
  95:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * The initial input processing of TCP. It verifies the TCP header, demultiplexes
  96:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * the segment between the PCBs and passes it on to tcp_process(), which implements
  97:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * the TCP finite state machine. This function is called by the IP layer (in
  98:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * ip_input()).
  99:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
 100:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * @param p received TCP segment to process (p->payload pointing to the TCP header)
 101:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * @param inp network interface on which this segment was received
 102:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  */
 103:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** void
 104:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** tcp_input(struct pbuf *p, struct netif *inp)
 105:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** {
 106:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_pcb *pcb, *prev;
 107:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_pcb_listen *lpcb;
 108:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if SO_REUSE
 109:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_pcb *lpcb_prev = NULL;
 110:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_pcb_listen *lpcb_any = NULL;
 111:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* SO_REUSE */
 112:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   u8_t hdrlen_bytes;
 113:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   err_t err;
 114:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 115:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   LWIP_UNUSED_ARG(inp);
 116:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 117:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   PERF_START;
 118:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 119:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   TCP_STATS_INC(tcp.recv);
 120:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   MIB2_STATS_INC(mib2.tcpinsegs);
 121:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 122:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcphdr = (struct tcp_hdr *)p->payload;
 123:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 124:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_INPUT_DEBUG
 125:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcp_debug_print(tcphdr);
 126:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif
 127:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 128:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* Check that TCP header fits in payload */
 129:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (p->len < TCP_HLEN) {
 130:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* drop short packets */
 131:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_input: short packet (%"U16_F" bytes) discarded\n", p->tot_le
 132:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     TCP_STATS_INC(tcp.lenerr);
 133:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     goto dropped;
 134:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 135:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 136:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* Don't even process incoming broadcasts/multicasts. */
 137:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (ip_addr_isbroadcast(ip_current_dest_addr(), ip_current_netif()) ||
 138:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       ip_addr_ismulticast(ip_current_dest_addr())) {
 139:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     TCP_STATS_INC(tcp.proterr);
 140:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     goto dropped;
 141:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 142:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 143:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if CHECKSUM_CHECK_TCP
 144:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   IF__NETIF_CHECKSUM_ENABLED(inp, NETIF_CHECKSUM_CHECK_TCP) {
 145:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Verify TCP checksum. */
 146:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     u16_t chksum = ip_chksum_pseudo(p, IP_PROTO_TCP, p->tot_len,
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 4


 147:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                ip_current_src_addr(), ip_current_dest_addr());
 148:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (chksum != 0) {
 149:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_input: packet discarded due to failing checksum 0x%04"X1
 150:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           chksum));
 151:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_debug_print(tcphdr);
 152:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_STATS_INC(tcp.chkerr);
 153:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       goto dropped;
 154:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 155:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 156:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* CHECKSUM_CHECK_TCP */
 157:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 158:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* sanity-check header length */
 159:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   hdrlen_bytes = TCPH_HDRLEN(tcphdr) * 4;
 160:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if ((hdrlen_bytes < TCP_HLEN) || (hdrlen_bytes > p->tot_len)) {
 161:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_input: invalid header length (%"U16_F")\n", (u16_t)hdrlen_by
 162:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     TCP_STATS_INC(tcp.lenerr);
 163:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     goto dropped;
 164:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 165:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 166:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* Move the payload pointer in the pbuf so that it points to the
 167:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      TCP data instead of the TCP header. */
 168:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcphdr_optlen = hdrlen_bytes - TCP_HLEN;
 169:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcphdr_opt2 = NULL;
 170:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (p->len >= hdrlen_bytes) {
 171:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* all options are in the first pbuf */
 172:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcphdr_opt1len = tcphdr_optlen;
 173:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     pbuf_header(p, -(s16_t)hdrlen_bytes); /* cannot fail */
 174:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   } else {
 175:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     u16_t opt2len;
 176:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* TCP header fits into first pbuf, options don't - data is in the next pbuf */
 177:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* there must be a next pbuf, due to hdrlen_bytes sanity check above */
 178:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_ASSERT("p->next != NULL", p->next != NULL);
 179:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 180:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* advance over the TCP header (cannot fail) */
 181:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     pbuf_header(p, -TCP_HLEN);
 182:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 183:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* determine how long the first and second parts of the options are */
 184:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcphdr_opt1len = p->len;
 185:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     opt2len = tcphdr_optlen - tcphdr_opt1len;
 186:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 187:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* options continue in the next pbuf: set p to zero length and hide the
 188:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         options in the next pbuf (adjusting p->tot_len) */
 189:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     pbuf_header(p, -(s16_t)tcphdr_opt1len);
 190:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 191:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* check that the options fit in the second pbuf */
 192:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (opt2len > p->next->len) {
 193:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* drop short packets */
 194:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_input: options overflow second pbuf (%"U16_F" bytes)\n", p
 195:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_STATS_INC(tcp.lenerr);
 196:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       goto dropped;
 197:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 198:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 199:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* remember the pointer to the second part of the options */
 200:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcphdr_opt2 = (u8_t*)p->next->payload;
 201:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 202:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* advance p->next to point after the options, and manually
 203:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         adjust p->tot_len to keep it consistent with the changed p->next */
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 5


 204:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     pbuf_header(p->next, -(s16_t)opt2len);
 205:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     p->tot_len -= opt2len;
 206:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 207:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_ASSERT("p->len == 0", p->len == 0);
 208:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_ASSERT("p->tot_len == p->next->tot_len", p->tot_len == p->next->tot_len);
 209:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 210:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 211:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* Convert fields in TCP header to host byte order. */
 212:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcphdr->src = lwip_ntohs(tcphdr->src);
 213:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcphdr->dest = lwip_ntohs(tcphdr->dest);
 214:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   seqno = tcphdr->seqno = lwip_ntohl(tcphdr->seqno);
 215:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   ackno = tcphdr->ackno = lwip_ntohl(tcphdr->ackno);
 216:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcphdr->wnd = lwip_ntohs(tcphdr->wnd);
 217:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 218:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   flags = TCPH_FLAGS(tcphdr);
 219:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcplen = p->tot_len + ((flags & (TCP_FIN | TCP_SYN)) ? 1 : 0);
 220:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 221:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* Demultiplex an incoming segment. First, we check if it is destined
 222:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      for an active connection. */
 223:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   prev = NULL;
 224:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 225:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   for (pcb = tcp_active_pcbs; pcb != NULL; pcb = pcb->next) {
 226:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_ASSERT("tcp_input: active pcb->state != CLOSED", pcb->state != CLOSED);
 227:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_ASSERT("tcp_input: active pcb->state != TIME-WAIT", pcb->state != TIME_WAIT);
 228:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_ASSERT("tcp_input: active pcb->state != LISTEN", pcb->state != LISTEN);
 229:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (pcb->remote_port == tcphdr->src &&
 230:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->local_port == tcphdr->dest &&
 231:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_addr_cmp(&pcb->remote_ip, ip_current_src_addr()) &&
 232:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_addr_cmp(&pcb->local_ip, ip_current_dest_addr())) {
 233:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Move this PCB to the front of the list so that subsequent
 234:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          lookups will be faster (we exploit locality in TCP segment
 235:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          arrivals). */
 236:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("tcp_input: pcb->next != pcb (before cache)", pcb->next != pcb);
 237:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (prev != NULL) {
 238:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         prev->next = pcb->next;
 239:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->next = tcp_active_pcbs;
 240:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_active_pcbs = pcb;
 241:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 242:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCP_STATS_INC(tcp.cachehit);
 243:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 244:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("tcp_input: pcb->next != pcb (after cache)", pcb->next != pcb);
 245:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       break;
 246:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 247:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     prev = pcb;
 248:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 249:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 250:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (pcb == NULL) {
 251:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* If it did not go to an active connection, we check the connections
 252:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        in the TIME-WAIT state. */
 253:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     for (pcb = tcp_tw_pcbs; pcb != NULL; pcb = pcb->next) {
 254:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("tcp_input: TIME-WAIT pcb->state == TIME-WAIT", pcb->state == TIME_WAIT);
 255:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->remote_port == tcphdr->src &&
 256:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->local_port == tcphdr->dest &&
 257:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           ip_addr_cmp(&pcb->remote_ip, ip_current_src_addr()) &&
 258:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           ip_addr_cmp(&pcb->local_ip, ip_current_dest_addr())) {
 259:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* We don't really care enough to move this PCB to the front
 260:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            of the list since we are not very likely to receive that
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 6


 261:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            many segments for connections in TIME-WAIT. */
 262:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_input: packed for TIME_WAITing connection.\n"));
 263:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_timewait_input(pcb);
 264:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pbuf_free(p);
 265:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         return;
 266:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 267:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 268:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 269:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Finally, if we still did not get a match, we check all PCBs that
 270:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        are LISTENing for incoming connections. */
 271:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     prev = NULL;
 272:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     for (lpcb = tcp_listen_pcbs.listen_pcbs; lpcb != NULL; lpcb = lpcb->next) {
 273:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (lpcb->local_port == tcphdr->dest) {
 274:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (IP_IS_ANY_TYPE_VAL(lpcb->local_ip)) {
 275:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* found an ANY TYPE (IPv4/IPv6) match */
 276:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if SO_REUSE
 277:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           lpcb_any = lpcb;
 278:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           lpcb_prev = prev;
 279:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #else /* SO_REUSE */
 280:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           break;
 281:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* SO_REUSE */
 282:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         } else if (IP_ADDR_PCB_VERSION_MATCH_EXACT(lpcb, ip_current_dest_addr())) {
 283:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (ip_addr_cmp(&lpcb->local_ip, ip_current_dest_addr())) {
 284:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* found an exact match */
 285:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             break;
 286:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           } else if (ip_addr_isany(&lpcb->local_ip)) {
 287:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* found an ANY-match */
 288:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if SO_REUSE
 289:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             lpcb_any = lpcb;
 290:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             lpcb_prev = prev;
 291:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #else /* SO_REUSE */
 292:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             break;
 293:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  #endif /* SO_REUSE */
 294:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 295:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 296:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 297:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       prev = (struct tcp_pcb *)lpcb;
 298:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 299:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if SO_REUSE
 300:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* first try specific local IP */
 301:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (lpcb == NULL) {
 302:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* only pass to ANY if no specific local IP has been found */
 303:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       lpcb = lpcb_any;
 304:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       prev = lpcb_prev;
 305:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 306:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* SO_REUSE */
 307:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (lpcb != NULL) {
 308:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Move this PCB to the front of the list so that subsequent
 309:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          lookups will be faster (we exploit locality in TCP segment
 310:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          arrivals). */
 311:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (prev != NULL) {
 312:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ((struct tcp_pcb_listen *)prev)->next = lpcb->next;
 313:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               /* our successor is the remainder of the listening list */
 314:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         lpcb->next = tcp_listen_pcbs.listen_pcbs;
 315:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               /* put this listening pcb at the head of the listening list */
 316:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_listen_pcbs.listen_pcbs = lpcb;
 317:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 7


 318:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCP_STATS_INC(tcp.cachehit);
 319:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 320:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 321:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_input: packed for LISTENing connection.\n"));
 322:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_listen_input(lpcb);
 323:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pbuf_free(p);
 324:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       return;
 325:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 326:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 327:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 328:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_INPUT_DEBUG
 329:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   LWIP_DEBUGF(TCP_INPUT_DEBUG, ("+-+-+-+-+-+-+-+-+-+-+-+-+-+- tcp_input: flags "));
 330:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcp_debug_print_flags(TCPH_FLAGS(tcphdr));
 331:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   LWIP_DEBUGF(TCP_INPUT_DEBUG, ("-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n"));
 332:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_INPUT_DEBUG */
 333:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 334:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 335:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (pcb != NULL) {
 336:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* The incoming segment belongs to a connection. */
 337:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_INPUT_DEBUG
 338:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_debug_print_state(pcb->state);
 339:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_INPUT_DEBUG */
 340:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 341:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Set up a tcp_seg structure. */
 342:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     inseg.next = NULL;
 343:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     inseg.len = p->tot_len;
 344:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     inseg.p = p;
 345:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     inseg.tcphdr = tcphdr;
 346:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 347:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     recv_data = NULL;
 348:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     recv_flags = 0;
 349:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     recv_acked = 0;
 350:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 351:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (flags & TCP_PSH) {
 352:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       p->flags |= PBUF_FLAG_PUSH;
 353:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 354:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 355:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* If there is data which was previously "refused" by upper layer */
 356:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (pcb->refused_data != NULL) {
 357:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if ((tcp_process_refused_data(pcb) == ERR_ABRT) ||
 358:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ((pcb->refused_data != NULL) && (tcplen > 0))) {
 359:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* pcb has been aborted or refused data is still refused and the new
 360:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            segment contains data */
 361:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCP_STATS_INC(tcp.drop);
 362:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         MIB2_STATS_INC(mib2.tcpinerrs);
 363:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         goto aborted;
 364:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 365:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 366:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_input_pcb = pcb;
 367:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     err = tcp_process(pcb);
 368:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* A return value of ERR_ABRT means that tcp_abort() was called
 369:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        and that the pcb has been freed. If so, we don't do anything. */
 370:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (err != ERR_ABRT) {
 371:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (recv_flags & TF_RESET) {
 372:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* TF_RESET means that the connection was reset by the other
 373:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            end. We then call the error callback to inform the
 374:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            application that the connection is dead before we
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 8


 375:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            deallocate the PCB. */
 376:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCP_EVENT_ERR(pcb->errf, pcb->callback_arg, ERR_RST);
 377:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_pcb_remove(&tcp_active_pcbs, pcb);
 378:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         memp_free(MEMP_TCP_PCB, pcb);
 379:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 380:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         err = ERR_OK;
 381:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* If the application has registered a "sent" function to be
 382:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            called when new send buffer space is available, we call it
 383:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            now. */
 384:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (recv_acked > 0) {
 385:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           u16_t acked16;
 386:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if LWIP_WND_SCALE
 387:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* recv_acked is u32_t but the sent callback only takes a u16_t,
 388:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              so we might have to call it multiple times. */
 389:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           u32_t acked = recv_acked;
 390:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           while (acked > 0) {
 391:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             acked16 = (u16_t)LWIP_MIN(acked, 0xffffu);
 392:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             acked -= acked16;
 393:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #else
 394:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           {
 395:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             acked16 = recv_acked;
 396:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif
 397:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             TCP_EVENT_SENT(pcb, (u16_t)acked16, err);
 398:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (err == ERR_ABRT) {
 399:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               goto aborted;
 400:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
 401:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 402:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           recv_acked = 0;
 403:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 404:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (recv_flags & TF_CLOSED) {
 405:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* The connection has been closed and we will deallocate the
 406:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              PCB. */
 407:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (!(pcb->flags & TF_RXCLOSED)) {
 408:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Connection closed although the application has only shut down the
 409:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                tx side: call the PCB's err callback and indicate the closure to
 410:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                ensure the application doesn't continue using the PCB. */
 411:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             TCP_EVENT_ERR(pcb->errf, pcb->callback_arg, ERR_CLSD);
 412:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 413:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           tcp_pcb_remove(&tcp_active_pcbs, pcb);
 414:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           memp_free(MEMP_TCP_PCB, pcb);
 415:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           goto aborted;
 416:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 417:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ && LWIP_WND_SCALE
 418:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         while (recv_data != NULL) {
 419:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           struct pbuf *rest = NULL;
 420:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pbuf_split_64k(recv_data, &rest);
 421:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #else /* TCP_QUEUE_OOSEQ && LWIP_WND_SCALE */
 422:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (recv_data != NULL) {
 423:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_QUEUE_OOSEQ && LWIP_WND_SCALE */
 424:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 425:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("pcb->refused_data == NULL", pcb->refused_data == NULL);
 426:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (pcb->flags & TF_RXCLOSED) {
 427:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* received data although already closed -> abort (send RST) to
 428:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                notify the remote host that not all data has been processed */
 429:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             pbuf_free(recv_data);
 430:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ && LWIP_WND_SCALE
 431:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (rest != NULL) {
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 9


 432:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               pbuf_free(rest);
 433:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
 434:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_QUEUE_OOSEQ && LWIP_WND_SCALE */
 435:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             tcp_abort(pcb);
 436:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             goto aborted;
 437:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 438:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 439:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Notify application that data has been received. */
 440:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           TCP_EVENT_RECV(pcb, recv_data, ERR_OK, err);
 441:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (err == ERR_ABRT) {
 442:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ && LWIP_WND_SCALE
 443:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (rest != NULL) {
 444:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               pbuf_free(rest);
 445:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
 446:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_QUEUE_OOSEQ && LWIP_WND_SCALE */
 447:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             goto aborted;
 448:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 449:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 450:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* If the upper layer can't receive this data, store it */
 451:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (err != ERR_OK) {
 452:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ && LWIP_WND_SCALE
 453:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (rest != NULL) {
 454:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               pbuf_cat(recv_data, rest);
 455:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
 456:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_QUEUE_OOSEQ && LWIP_WND_SCALE */
 457:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             pcb->refused_data = recv_data;
 458:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_input: keep incoming packet, because pcb is \"full\"
 459:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ && LWIP_WND_SCALE
 460:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             break;
 461:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           } else {
 462:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Upper layer received the data, go on with the rest if > 64K */
 463:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             recv_data = rest;
 464:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_QUEUE_OOSEQ && LWIP_WND_SCALE */
 465:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 466:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 467:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 468:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* If a FIN segment was received, we call the callback
 469:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            function with a NULL buffer to indicate EOF. */
 470:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (recv_flags & TF_GOT_FIN) {
 471:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (pcb->refused_data != NULL) {
 472:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Delay this if we have refused data. */
 473:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             pcb->refused_data->flags |= PBUF_FLAG_TCP_FIN;
 474:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           } else {
 475:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* correct rcv_wnd as the application won't call tcp_recved()
 476:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                for the FIN's seqno */
 477:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (pcb->rcv_wnd != TCP_WND_MAX(pcb)) {
 478:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               pcb->rcv_wnd++;
 479:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
 480:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             TCP_EVENT_CLOSED(pcb, err);
 481:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (err == ERR_ABRT) {
 482:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               goto aborted;
 483:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
 484:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 485:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 486:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 487:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_input_pcb = NULL;
 488:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Try to send something out. */
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 10


 489:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_output(pcb);
 490:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_INPUT_DEBUG
 491:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_DEBUG
 492:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_debug_print_state(pcb->state);
 493:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_DEBUG */
 494:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_INPUT_DEBUG */
 495:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 496:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 497:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Jump target if pcb has been aborted in a callback (by calling tcp_abort()).
 498:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        Below this line, 'pcb' may not be dereferenced! */
 499:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** aborted:
 500:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_input_pcb = NULL;
 501:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     recv_data = NULL;
 502:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 503:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* give up our reference to inseg.p */
 504:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (inseg.p != NULL)
 505:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     {
 506:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pbuf_free(inseg.p);
 507:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       inseg.p = NULL;
 508:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 509:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   } else {
 510:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 511:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* If no matching PCB was found, send a TCP RST (reset) to the
 512:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        sender. */
 513:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_DEBUGF(TCP_RST_DEBUG, ("tcp_input: no PCB match found, resetting.\n"));
 514:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (!(TCPH_FLAGS(tcphdr) & TCP_RST)) {
 515:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_STATS_INC(tcp.proterr);
 516:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_STATS_INC(tcp.drop);
 517:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_rst(ackno, seqno + tcplen, ip_current_dest_addr(),
 518:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_current_src_addr(), tcphdr->dest, tcphdr->src);
 519:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 520:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     pbuf_free(p);
 521:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 522:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 523:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   LWIP_ASSERT("tcp_input: tcp_pcbs_sane()", tcp_pcbs_sane());
 524:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   PERF_STOP("tcp_input");
 525:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   return;
 526:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** dropped:
 527:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   TCP_STATS_INC(tcp.drop);
 528:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   MIB2_STATS_INC(mib2.tcpinerrs);
 529:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   pbuf_free(p);
 530:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 531:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 532:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /**
 533:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Called by tcp_input() when a segment arrives for a listening
 534:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * connection (from tcp_input()).
 535:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
 536:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * @param pcb the tcp_pcb_listen for which a segment arrived
 537:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
 538:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * @note the segment which arrived is saved in global variables, therefore only the pcb
 539:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *       involved is passed as a parameter to this function
 540:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  */
 541:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static void
 542:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** tcp_listen_input(struct tcp_pcb_listen *pcb)
 543:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** {
 544:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_pcb *npcb;
 545:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   err_t rc;
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 11


 546:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 547:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (flags & TCP_RST) {
 548:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* An incoming RST should be ignored. Return. */
 549:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     return;
 550:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 551:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 552:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* In the LISTEN state, we check for incoming SYN segments,
 553:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      creates a new PCB, and responds with a SYN|ACK. */
 554:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (flags & TCP_ACK) {
 555:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* For incoming segments with the ACK flag set, respond with a
 556:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        RST. */
 557:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_DEBUGF(TCP_RST_DEBUG, ("tcp_listen_input: ACK in LISTEN, sending reset\n"));
 558:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_rst(ackno, seqno + tcplen, ip_current_dest_addr(),
 559:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       ip_current_src_addr(), tcphdr->dest, tcphdr->src);
 560:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   } else if (flags & TCP_SYN) {
 561:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_DEBUGF(TCP_DEBUG, ("TCP connection request %"U16_F" -> %"U16_F".\n", tcphdr->src, tcphdr->
 562:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_LISTEN_BACKLOG
 563:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (pcb->accepts_pending >= pcb->backlog) {
 564:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("tcp_listen_input: listen backlog exceeded for port %"U16_F"\n", tcph
 565:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       return;
 566:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 567:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_LISTEN_BACKLOG */
 568:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb = tcp_alloc(pcb->prio);
 569:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* If a new PCB could not be created (probably due to lack of memory),
 570:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        we don't do anything, but rely on the sender will retransmit the
 571:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        SYN at a time when we have more memory available. */
 572:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (npcb == NULL) {
 573:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       err_t err;
 574:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("tcp_listen_input: could not allocate PCB\n"));
 575:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_STATS_INC(tcp.memerr);
 576:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_EVENT_ACCEPT(pcb, NULL, pcb->callback_arg, ERR_MEM, err);
 577:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_UNUSED_ARG(err); /* err not useful here */
 578:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       return;
 579:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 580:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_LISTEN_BACKLOG
 581:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     pcb->accepts_pending++;
 582:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->flags |= TF_BACKLOGPEND;
 583:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_LISTEN_BACKLOG */
 584:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Set up the new PCB. */
 585:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     ip_addr_copy(npcb->local_ip, *ip_current_dest_addr());
 586:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     ip_addr_copy(npcb->remote_ip, *ip_current_src_addr());
 587:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->local_port = pcb->local_port;
 588:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->remote_port = tcphdr->src;
 589:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->state = SYN_RCVD;
 590:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->rcv_nxt = seqno + 1;
 591:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->rcv_ann_right_edge = npcb->rcv_nxt;
 592:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->snd_wl1 = seqno - 1;/* initialise to seqno-1 to force window update */
 593:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->callback_arg = pcb->callback_arg;
 594:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if LWIP_CALLBACK_API || TCP_LISTEN_BACKLOG
 595:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->listener = pcb;
 596:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* LWIP_CALLBACK_API || TCP_LISTEN_BACKLOG */
 597:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* inherit socket options */
 598:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->so_options = pcb->so_options & SOF_INHERITED;
 599:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Register the new PCB so that we can begin receiving segments
 600:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        for it. */
 601:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     TCP_REG_ACTIVE(npcb);
 602:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 12


 603:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Parse any options in the SYN. */
 604:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_parseopt(npcb);
 605:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->snd_wnd = SND_WND_SCALE(npcb, tcphdr->wnd);
 606:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->snd_wnd_max = npcb->snd_wnd;
 607:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->ssthresh = LWIP_TCP_INITIAL_SSTHRESH(npcb);
 608:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 609:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_CALCULATE_EFF_SEND_MSS
 610:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->mss = tcp_eff_send_mss(npcb->mss, &npcb->local_ip, &npcb->remote_ip);
 611:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_CALCULATE_EFF_SEND_MSS */
 612:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 613:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     MIB2_STATS_INC(mib2.tcppassiveopens);
 614:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 615:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Send a SYN|ACK together with the MSS option. */
 616:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     rc = tcp_enqueue_flags(npcb, TCP_SYN | TCP_ACK);
 617:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (rc != ERR_OK) {
 618:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_abandon(npcb, 0);
 619:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       return;
 620:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 621:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_output(npcb);
 622:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 623:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   return;
 624:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 625:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 626:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /**
 627:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Called by tcp_input() when a segment arrives for a connection in
 628:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * TIME_WAIT.
 629:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
 630:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * @param pcb the tcp_pcb for which a segment arrived
 631:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
 632:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * @note the segment which arrived is saved in global variables, therefore only the pcb
 633:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *       involved is passed as a parameter to this function
 634:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  */
 635:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static void
 636:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** tcp_timewait_input(struct tcp_pcb *pcb)
 637:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** {
 638:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* RFC 1337: in TIME_WAIT, ignore RST and ACK FINs + any 'acceptable' segments */
 639:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* RFC 793 3.9 Event Processing - Segment Arrives:
 640:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****    * - first check sequence number - we skip that one in TIME_WAIT (always
 641:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****    *   acceptable since we only send ACKs)
 642:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****    * - second check the RST bit (... return) */
 643:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (flags & TCP_RST) {
 644:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     return;
 645:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 646:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* - fourth, check the SYN bit, */
 647:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (flags & TCP_SYN) {
 648:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* If an incoming segment is not acceptable, an acknowledgment
 649:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        should be sent in reply */
 650:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (TCP_SEQ_BETWEEN(seqno, pcb->rcv_nxt, pcb->rcv_nxt + pcb->rcv_wnd)) {
 651:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* If the SYN is in the window it is an error, send a reset */
 652:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_rst(ackno, seqno + tcplen, ip_current_dest_addr(),
 653:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_current_src_addr(), tcphdr->dest, tcphdr->src);
 654:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       return;
 655:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 656:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   } else if (flags & TCP_FIN) {
 657:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* - eighth, check the FIN bit: Remain in the TIME-WAIT state.
 658:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          Restart the 2 MSL time-wait timeout.*/
 659:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     pcb->tmr = tcp_ticks;
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 13


 660:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 661:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 662:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if ((tcplen > 0)) {
 663:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Acknowledge data, FIN or out-of-window SYN */
 664:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     pcb->flags |= TF_ACK_NOW;
 665:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_output(pcb);
 666:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 667:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   return;
 668:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 669:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 670:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /**
 671:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Implements the TCP state machine. Called by tcp_input. In some
 672:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * states tcp_receive() is called to receive data. The tcp_seg
 673:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * argument will be freed by the caller (tcp_input()) unless the
 674:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * recv_data pointer in the pcb is set.
 675:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
 676:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * @param pcb the tcp_pcb for which a segment arrived
 677:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
 678:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * @note the segment which arrived is saved in global variables, therefore only the pcb
 679:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *       involved is passed as a parameter to this function
 680:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  */
 681:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static err_t
 682:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** tcp_process(struct tcp_pcb *pcb)
 683:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** {
 684:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_seg *rseg;
 685:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   u8_t acceptable = 0;
 686:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   err_t err;
 687:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 688:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   err = ERR_OK;
 689:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 690:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* Process incoming RST segments. */
 691:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (flags & TCP_RST) {
 692:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* First, determine if the reset is acceptable. */
 693:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (pcb->state == SYN_SENT) {
 694:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* "In the SYN-SENT state (a RST received in response to an initial SYN),
 695:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           the RST is acceptable if the ACK field acknowledges the SYN." */
 696:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (ackno == pcb->snd_nxt) {
 697:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         acceptable = 1;
 698:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 699:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     } else {
 700:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* "In all states except SYN-SENT, all reset (RST) segments are validated
 701:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           by checking their SEQ-fields." */
 702:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (seqno == pcb->rcv_nxt) {
 703:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         acceptable = 1;
 704:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else  if (TCP_SEQ_BETWEEN(seqno, pcb->rcv_nxt,
 705:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                   pcb->rcv_nxt + pcb->rcv_wnd)) {
 706:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* If the sequence number is inside the window, we only send an ACK
 707:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            and wait for a re-send with matching sequence number.
 708:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            This violates RFC 793, but is required to protection against
 709:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            CVE-2004-0230 (RST spoofing attack). */
 710:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_ack_now(pcb);
 711:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 712:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 713:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 714:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (acceptable) {
 715:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_process: Connection RESET\n"));
 716:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("tcp_input: pcb->state != CLOSED", pcb->state != CLOSED);
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 14


 717:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       recv_flags |= TF_RESET;
 718:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->flags &= ~TF_ACK_DELAY;
 719:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       return ERR_RST;
 720:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     } else {
 721:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_process: unacceptable reset seqno %"U32_F" rcv_nxt %"U32_F
 722:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        seqno, pcb->rcv_nxt));
 723:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("tcp_process: unacceptable reset seqno %"U32_F" rcv_nxt %"U32_F"\n",
 724:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        seqno, pcb->rcv_nxt));
 725:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       return ERR_OK;
 726:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 727:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 728:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 729:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if ((flags & TCP_SYN) && (pcb->state != SYN_SENT && pcb->state != SYN_RCVD)) {
 730:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Cope with new connection attempt after remote end crashed */
 731:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_ack_now(pcb);
 732:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     return ERR_OK;
 733:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 734:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 735:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if ((pcb->flags & TF_RXCLOSED) == 0) {
 736:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Update the PCB (in)activity timer unless rx is closed (see tcp_shutdown) */
 737:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     pcb->tmr = tcp_ticks;
 738:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 739:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   pcb->keep_cnt_sent = 0;
 740:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 741:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcp_parseopt(pcb);
 742:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 743:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* Do different things depending on the TCP state. */
 744:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   switch (pcb->state) {
 745:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   case SYN_SENT:
 746:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_DEBUGF(TCP_INPUT_DEBUG, ("SYN-SENT: ackno %"U32_F" pcb->snd_nxt %"U32_F" unacked %"U32_F"\
 747:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      pcb->snd_nxt, lwip_ntohl(pcb->unacked->tcphdr->seqno)));
 748:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* received SYN ACK with expected sequence number? */
 749:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if ((flags & TCP_ACK) && (flags & TCP_SYN)
 750:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         && (ackno == pcb->lastack + 1)) {
 751:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->rcv_nxt = seqno + 1;
 752:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->rcv_ann_right_edge = pcb->rcv_nxt;
 753:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->lastack = ackno;
 754:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wnd = SND_WND_SCALE(pcb, tcphdr->wnd);
 755:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wnd_max = pcb->snd_wnd;
 756:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wl1 = seqno - 1; /* initialise to seqno - 1 to force window update */
 757:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = ESTABLISHED;
 758:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 759:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_CALCULATE_EFF_SEND_MSS
 760:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->mss = tcp_eff_send_mss(pcb->mss, &pcb->local_ip, &pcb->remote_ip);
 761:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_CALCULATE_EFF_SEND_MSS */
 762:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 763:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Set ssthresh again after changing 'mss' and 'snd_wnd' */
 764:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->ssthresh = LWIP_TCP_INITIAL_SSTHRESH(pcb);
 765:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 766:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->cwnd = LWIP_TCP_CALC_INITIAL_CWND(pcb->mss);
 767:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_CWND_DEBUG, ("tcp_process (SENT): cwnd %"TCPWNDSIZE_F
 768:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                    " ssthresh %"TCPWNDSIZE_F"\n",
 769:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                    pcb->cwnd, pcb->ssthresh));
 770:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("pcb->snd_queuelen > 0", (pcb->snd_queuelen > 0));
 771:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       --pcb->snd_queuelen;
 772:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_QLEN_DEBUG, ("tcp_process: SYN-SENT --queuelen %"TCPWNDSIZE_F"\n", (tcpwnd_si
 773:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       rseg = pcb->unacked;
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 15


 774:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (rseg == NULL) {
 775:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* might happen if tcp_output fails in tcp_rexmit_rto()
 776:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            in which case the segment is on the unsent list */
 777:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         rseg = pcb->unsent;
 778:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_ASSERT("no segment to free", rseg != NULL);
 779:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->unsent = rseg->next;
 780:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 781:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->unacked = rseg->next;
 782:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 783:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_seg_free(rseg);
 784:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 785:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* If there's nothing left to acknowledge, stop the retransmit
 786:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          timer, otherwise reset it to start again */
 787:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->unacked == NULL) {
 788:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->rtime = -1;
 789:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 790:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->rtime = 0;
 791:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->nrtx = 0;
 792:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 793:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 794:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Call the user specified function to call when successfully
 795:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        * connected. */
 796:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_EVENT_CONNECTED(pcb, ERR_OK, err);
 797:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (err == ERR_ABRT) {
 798:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         return ERR_ABRT;
 799:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 800:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_ack_now(pcb);
 801:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 802:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* received ACK? possibly a half-open connection */
 803:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     else if (flags & TCP_ACK) {
 804:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* send a RST to bring the other side in a non-synchronized state. */
 805:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_rst(ackno, seqno + tcplen, ip_current_dest_addr(),
 806:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_current_src_addr(), tcphdr->dest, tcphdr->src);
 807:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Resend SYN immediately (don't wait for rto timeout) to establish
 808:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         connection faster */
 809:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->rtime = 0;
 810:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_rexmit_rto(pcb);
 811:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 812:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     break;
 813:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   case SYN_RCVD:
 814:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (flags & TCP_ACK) {
 815:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* expected ACK number? */
 816:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (TCP_SEQ_BETWEEN(ackno, pcb->lastack+1, pcb->snd_nxt)) {
 817:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = ESTABLISHED;
 818:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_DEBUG, ("TCP connection established %"U16_F" -> %"U16_F".\n", inseg.tcphdr-
 819:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if LWIP_CALLBACK_API
 820:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_ASSERT("pcb->listener->accept != NULL",
 821:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           (pcb->listener == NULL) || (pcb->listener->accept != NULL));
 822:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (pcb->listener == NULL) {
 823:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* listen pcb might be closed by now */
 824:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           err = ERR_VAL;
 825:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         } else
 826:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif
 827:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         {
 828:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           tcp_backlog_accepted(pcb);
 829:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Call the accept function. */
 830:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           TCP_EVENT_ACCEPT(pcb->listener, pcb, pcb->callback_arg, ERR_OK, err);
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 16


 831:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 832:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (err != ERR_OK) {
 833:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* If the accept function returns with an error, we abort
 834:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            * the connection. */
 835:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Already aborted? */
 836:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (err != ERR_ABRT) {
 837:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             tcp_abort(pcb);
 838:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 839:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           return ERR_ABRT;
 840:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 841:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* If there was any data contained within this ACK,
 842:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          * we'd better pass it on to the application as well. */
 843:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_receive(pcb);
 844:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 845:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* passive open: update initial ssthresh now that the correct window is
 846:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            known: if the remote side supports window scaling, the window sent
 847:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            with the initial SYN can be smaller than the one used later */
 848:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->ssthresh = LWIP_TCP_INITIAL_SSTHRESH(pcb);
 849:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 850:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Prevent ACK for SYN to generate a sent event */
 851:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (recv_acked != 0) {
 852:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           recv_acked--;
 853:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 854:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 855:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->cwnd = LWIP_TCP_CALC_INITIAL_CWND(pcb->mss);
 856:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_CWND_DEBUG, ("tcp_process (SYN_RCVD): cwnd %"TCPWNDSIZE_F
 857:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                      " ssthresh %"TCPWNDSIZE_F"\n",
 858:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                      pcb->cwnd, pcb->ssthresh));
 859:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 860:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (recv_flags & TF_GOT_FIN) {
 861:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           tcp_ack_now(pcb);
 862:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->state = CLOSE_WAIT;
 863:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 864:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 865:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* incorrect ACK number, send RST */
 866:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_rst(ackno, seqno + tcplen, ip_current_dest_addr(),
 867:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           ip_current_src_addr(), tcphdr->dest, tcphdr->src);
 868:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 869:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     } else if ((flags & TCP_SYN) && (seqno == pcb->rcv_nxt - 1)) {
 870:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Looks like another copy of the SYN - retransmit our SYN-ACK */
 871:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_rexmit(pcb);
 872:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 873:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     break;
 874:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   case CLOSE_WAIT:
 875:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* FALLTHROUGH */
 876:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   case ESTABLISHED:
 877:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_receive(pcb);
 878:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (recv_flags & TF_GOT_FIN) { /* passive close */
 879:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_ack_now(pcb);
 880:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = CLOSE_WAIT;
 881:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 882:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     break;
 883:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   case FIN_WAIT_1:
 884:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_receive(pcb);
 885:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (recv_flags & TF_GOT_FIN) {
 886:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if ((flags & TCP_ACK) && (ackno == pcb->snd_nxt) &&
 887:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->unsent == NULL) {
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 17


 888:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_DEBUG,
 889:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           ("TCP connection closed: FIN_WAIT_1 %"U16_F" -> %"U16_F".\n", inseg.tcphdr->src, inseg.tc
 890:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_ack_now(pcb);
 891:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_pcb_purge(pcb);
 892:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCP_RMV_ACTIVE(pcb);
 893:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = TIME_WAIT;
 894:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCP_REG(&tcp_tw_pcbs, pcb);
 895:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 896:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_ack_now(pcb);
 897:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = CLOSING;
 898:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 899:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     } else if ((flags & TCP_ACK) && (ackno == pcb->snd_nxt) &&
 900:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                pcb->unsent == NULL) {
 901:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = FIN_WAIT_2;
 902:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 903:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     break;
 904:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   case FIN_WAIT_2:
 905:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_receive(pcb);
 906:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (recv_flags & TF_GOT_FIN) {
 907:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("TCP connection closed: FIN_WAIT_2 %"U16_F" -> %"U16_F".\n", inseg.tc
 908:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_ack_now(pcb);
 909:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_pcb_purge(pcb);
 910:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_RMV_ACTIVE(pcb);
 911:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 912:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_REG(&tcp_tw_pcbs, pcb);
 913:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 914:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     break;
 915:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   case CLOSING:
 916:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_receive(pcb);
 917:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (flags & TCP_ACK && ackno == pcb->snd_nxt && pcb->unsent == NULL) {
 918:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("TCP connection closed: CLOSING %"U16_F" -> %"U16_F".\n", inseg.tcphd
 919:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_pcb_purge(pcb);
 920:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_RMV_ACTIVE(pcb);
 921:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 922:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_REG(&tcp_tw_pcbs, pcb);
 923:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 924:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     break;
 925:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   case LAST_ACK:
 926:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_receive(pcb);
 927:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (flags & TCP_ACK && ackno == pcb->snd_nxt && pcb->unsent == NULL) {
 928:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("TCP connection closed: LAST_ACK %"U16_F" -> %"U16_F".\n", inseg.tcph
 929:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* bugfix #21699: don't set pcb->state to CLOSED here or we risk leaking segments */
 930:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       recv_flags |= TF_CLOSED;
 931:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 932:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     break;
 933:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   default:
 934:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     break;
 935:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   return ERR_OK;
 937:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 938:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 939:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ
 940:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /**
 941:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Insert segment into the list (segments covered with new one will be deleted)
 942:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
 943:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Called from tcp_receive()
 944:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  */
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 18


 945:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static void
 946:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** tcp_oos_insert_segment(struct tcp_seg *cseg, struct tcp_seg *next)
 947:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** {
 948:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_seg *old_seg;
 949:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 950:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (TCPH_FLAGS(cseg->tcphdr) & TCP_FIN) {
 951:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* received segment overlaps all following segments */
 952:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_segs_free(next);
 953:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     next = NULL;
 954:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   } else {
 955:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* delete some following segments
 956:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        oos queue may have segments with FIN flag */
 957:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     while (next &&
 958:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            TCP_SEQ_GEQ((seqno + cseg->len),
 959:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       (next->tcphdr->seqno + next->len))) {
 960:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* cseg with FIN already processed */
 961:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (TCPH_FLAGS(next->tcphdr) & TCP_FIN) {
 962:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCPH_SET_FLAG(cseg->tcphdr, TCP_FIN);
 963:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 964:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       old_seg = next;
 965:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       next = next->next;
 966:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_seg_free(old_seg);
 967:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 968:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (next &&
 969:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCP_SEQ_GT(seqno + cseg->len, next->tcphdr->seqno)) {
 970:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* We need to trim the incoming segment. */
 971:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       cseg->len = (u16_t)(next->tcphdr->seqno - seqno);
 972:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pbuf_realloc(cseg->p, cseg->len);
 973:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 974:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 975:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   cseg->next = next;
 976:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 977:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_QUEUE_OOSEQ */
 978:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 979:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /**
 980:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Called by tcp_process. Checks if the given segment is an ACK for outstanding
 981:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * data, and if so frees the memory of the buffered data. Next, it places the
 982:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * segment on any of the receive queues (pcb->recved or pcb->ooseq). If the segment
 983:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * is buffered, the pbuf is referenced by pbuf_ref so that it will not be freed until
 984:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * it has been removed from the buffer.
 985:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
 986:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * If the incoming segment constitutes an ACK for a segment that was used for RTT
 987:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * estimation, the RTT is estimated here as well.
 988:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
 989:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Called from tcp_process().
 990:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  */
 991:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static void
 992:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** tcp_receive(struct tcp_pcb *pcb)
 993:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** {
 994:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_seg *next;
 995:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ
 996:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_seg *prev, *cseg;
 997:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_QUEUE_OOSEQ */
 998:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   s32_t off;
 999:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   s16_t m;
1000:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   u32_t right_wnd_edge;
1001:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   u16_t new_tot_len;
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 19


1002:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   int found_dupack = 0;
1003:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_OOSEQ_MAX_BYTES || TCP_OOSEQ_MAX_PBUFS
1004:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   u32_t ooseq_blen;
1005:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   u16_t ooseq_qlen;
1006:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_OOSEQ_MAX_BYTES || TCP_OOSEQ_MAX_PBUFS */
1007:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1008:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   LWIP_ASSERT("tcp_receive: wrong state", pcb->state >= ESTABLISHED);
1009:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1010:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (flags & TCP_ACK) {
1011:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     right_wnd_edge = pcb->snd_wnd + pcb->snd_wl2;
1012:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1013:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Update window. */
1014:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (TCP_SEQ_LT(pcb->snd_wl1, seqno) ||
1015:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        (pcb->snd_wl1 == seqno && TCP_SEQ_LT(pcb->snd_wl2, ackno)) ||
1016:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        (pcb->snd_wl2 == ackno && (u32_t)SND_WND_SCALE(pcb, tcphdr->wnd) > pcb->snd_wnd)) {
1017:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wnd = SND_WND_SCALE(pcb, tcphdr->wnd);
1018:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* keep track of the biggest window announced by the remote host to calculate
1019:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          the maximum segment size */
1020:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->snd_wnd_max < pcb->snd_wnd) {
1021:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->snd_wnd_max = pcb->snd_wnd;
1022:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1023:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wl1 = seqno;
1024:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wl2 = ackno;
1025:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->snd_wnd == 0) {
1026:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (pcb->persist_backoff == 0) {
1027:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* start persist timer */
1028:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->persist_cnt = 0;
1029:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->persist_backoff = 1;
1030:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1031:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else if (pcb->persist_backoff > 0) {
1032:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* stop persist timer */
1033:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->persist_backoff = 0;
1034:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1035:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_WND_DEBUG, ("tcp_receive: window update %"TCPWNDSIZE_F"\n", pcb->snd_wnd));
1036:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_WND_DEBUG
1037:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     } else {
1038:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->snd_wnd != (tcpwnd_size_t)SND_WND_SCALE(pcb, tcphdr->wnd)) {
1039:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_WND_DEBUG,
1040:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     ("tcp_receive: no window update lastack %"U32_F" ackno %"
1041:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                      U32_F" wl1 %"U32_F" seqno %"U32_F" wl2 %"U32_F"\n",
1042:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                      pcb->lastack, ackno, pcb->snd_wl1, seqno, pcb->snd_wl2));
1043:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1044:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_WND_DEBUG */
1045:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
1046:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1047:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* (From Stevens TCP/IP Illustrated Vol II, p970.) Its only a
1048:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * duplicate ack if:
1049:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * 1) It doesn't ACK new data
1050:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * 2) length of received packet is zero (i.e. no payload)
1051:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * 3) the advertised window hasn't changed
1052:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * 4) There is outstanding unacknowledged data (retransmission timer running)
1053:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * 5) The ACK is == biggest ACK sequence number so far seen (snd_una)
1054:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      *
1055:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * If it passes all five, should process as a dupack:
1056:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * a) dupacks < 3: do nothing
1057:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * b) dupacks == 3: fast retransmit
1058:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * c) dupacks > 3: increase cwnd
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 20


1059:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      *
1060:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * If it only passes 1-3, should reset dupack counter (and add to
1061:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * stats, which we don't do in lwIP)
1062:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      *
1063:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      * If it only passes 1, should reset dupack counter
1064:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      *
1065:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      */
1066:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1067:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Clause 1 */
1068:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (TCP_SEQ_LEQ(ackno, pcb->lastack)) {
1069:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Clause 2 */
1070:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (tcplen == 0) {
1071:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Clause 3 */
1072:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (pcb->snd_wl2 + pcb->snd_wnd == right_wnd_edge) {
1073:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Clause 4 */
1074:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (pcb->rtime >= 0) {
1075:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Clause 5 */
1076:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (pcb->lastack == ackno) {
1077:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               found_dupack = 1;
1078:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if ((u8_t)(pcb->dupacks + 1) > pcb->dupacks) {
1079:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 ++pcb->dupacks;
1080:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
1081:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if (pcb->dupacks > 3) {
1082:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 /* Inflate the congestion window, but not if it means that
1083:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                    the value overflows. */
1084:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 if ((tcpwnd_size_t)(pcb->cwnd + pcb->mss) > pcb->cwnd) {
1085:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   pcb->cwnd += pcb->mss;
1086:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 }
1087:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               } else if (pcb->dupacks == 3) {
1088:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 /* Do fast retransmit */
1089:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 tcp_rexmit_fast(pcb);
1090:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
1091:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
1092:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
1093:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1094:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1095:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* If Clause (1) or more is true, but not a duplicate ack, reset
1096:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        * count of consecutive duplicate acks */
1097:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (!found_dupack) {
1098:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->dupacks = 0;
1099:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1100:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     } else if (TCP_SEQ_BETWEEN(ackno, pcb->lastack+1, pcb->snd_nxt)) {
1101:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* We come here when the ACK acknowledges new data. */
1102:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1103:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Reset the "IN Fast Retransmit" flag, since we are no longer
1104:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          in fast retransmit. Also reset the congestion window to the
1105:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          slow start threshold. */
1106:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->flags & TF_INFR) {
1107:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->flags &= ~TF_INFR;
1108:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->cwnd = pcb->ssthresh;
1109:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1110:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1111:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Reset the number of retransmissions. */
1112:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->nrtx = 0;
1113:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1114:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Reset the retransmission time-out. */
1115:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->rto = (pcb->sa >> 3) + pcb->sv;
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 21


1116:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1117:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Reset the fast retransmit variables. */
1118:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->dupacks = 0;
1119:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->lastack = ackno;
1120:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1121:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Update the congestion control variables (cwnd and
1122:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          ssthresh). */
1123:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->state >= ESTABLISHED) {
1124:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (pcb->cwnd < pcb->ssthresh) {
1125:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if ((tcpwnd_size_t)(pcb->cwnd + pcb->mss) > pcb->cwnd) {
1126:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             pcb->cwnd += pcb->mss;
1127:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
1128:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_DEBUGF(TCP_CWND_DEBUG, ("tcp_receive: slow start cwnd %"TCPWNDSIZE_F"\n", pcb->cwnd)
1129:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         } else {
1130:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           tcpwnd_size_t new_cwnd = (pcb->cwnd + pcb->mss * pcb->mss / pcb->cwnd);
1131:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (new_cwnd > pcb->cwnd) {
1132:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             pcb->cwnd = new_cwnd;
1133:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
1134:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_DEBUGF(TCP_CWND_DEBUG, ("tcp_receive: congestion avoidance cwnd %"TCPWNDSIZE_F"\n", 
1135:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1136:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1137:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_receive: ACK for %"U32_F", unacked->seqno %"U32_F":%"U32_F
1138:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                     ackno,
1139:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                     pcb->unacked != NULL?
1140:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                     lwip_ntohl(pcb->unacked->tcphdr->seqno): 0,
1141:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                     pcb->unacked != NULL?
1142:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                     lwip_ntohl(pcb->unacked->tcphdr->seqno) + TCP_TCPLEN(pcb->unack
1143:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1144:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Remove segment from the unacknowledged list if the incoming
1145:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          ACK acknowledges them. */
1146:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       while (pcb->unacked != NULL &&
1147:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              TCP_SEQ_LEQ(lwip_ntohl(pcb->unacked->tcphdr->seqno) +
1148:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                          TCP_TCPLEN(pcb->unacked), ackno)) {
1149:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_receive: removing %"U32_F":%"U32_F" from pcb->unacked\n"
1150:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                       lwip_ntohl(pcb->unacked->tcphdr->seqno),
1151:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                       lwip_ntohl(pcb->unacked->tcphdr->seqno) +
1152:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                       TCP_TCPLEN(pcb->unacked)));
1153:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1154:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         next = pcb->unacked;
1155:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->unacked = pcb->unacked->next;
1156:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1157:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_QLEN_DEBUG, ("tcp_receive: queuelen %"TCPWNDSIZE_F" ... ", (tcpwnd_size_t)p
1158:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_ASSERT("pcb->snd_queuelen >= pbuf_clen(next->p)", (pcb->snd_queuelen >= pbuf_clen(next
1159:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1160:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->snd_queuelen -= pbuf_clen(next->p);
1161:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         recv_acked += next->len;
1162:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_seg_free(next);
1163:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1164:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_QLEN_DEBUG, ("%"TCPWNDSIZE_F" (after freeing unacked)\n", (tcpwnd_size_t)pc
1165:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (pcb->snd_queuelen != 0) {
1166:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("tcp_receive: valid queue length", pcb->unacked != NULL ||
1167:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       pcb->unsent != NULL);
1168:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1169:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1170:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1171:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* If there's nothing left to acknowledge, stop the retransmit
1172:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          timer, otherwise reset it to start again */
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 22


1173:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->unacked == NULL) {
1174:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->rtime = -1;
1175:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
1176:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->rtime = 0;
1177:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1178:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1179:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->polltmr = 0;
1180:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1181:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if LWIP_IPV6 && LWIP_ND6_TCP_REACHABILITY_HINTS
1182:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (ip_current_is_v6()) {
1183:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Inform neighbor reachability of forward progress. */
1184:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         nd6_reachability_hint(ip6_current_src_addr());
1185:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1186:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* LWIP_IPV6 && LWIP_ND6_TCP_REACHABILITY_HINTS*/
1187:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     } else {
1188:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Out of sequence ACK, didn't really ack anything */
1189:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_send_empty_ack(pcb);
1190:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
1191:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1192:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* We go through the ->unsent list to see if any of the segments
1193:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        on the list are acknowledged by the ACK. This may seem
1194:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        strange since an "unsent" segment shouldn't be acked. The
1195:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        rationale is that lwIP puts all outstanding segments on the
1196:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        ->unsent list after a retransmission, so these segments may
1197:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        in fact have been sent once. */
1198:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     while (pcb->unsent != NULL &&
1199:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            TCP_SEQ_BETWEEN(ackno, lwip_ntohl(pcb->unsent->tcphdr->seqno) +
1200:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                            TCP_TCPLEN(pcb->unsent), pcb->snd_nxt)) {
1201:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_receive: removing %"U32_F":%"U32_F" from pcb->unsent\n",
1202:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                     lwip_ntohl(pcb->unsent->tcphdr->seqno), lwip_ntohl(pcb->unsent-
1203:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                     TCP_TCPLEN(pcb->unsent)));
1204:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1205:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       next = pcb->unsent;
1206:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->unsent = pcb->unsent->next;
1207:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_OVERSIZE
1208:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->unsent == NULL) {
1209:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->unsent_oversize = 0;
1210:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1211:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_OVERSIZE */
1212:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_QLEN_DEBUG, ("tcp_receive: queuelen %"TCPWNDSIZE_F" ... ", (tcpwnd_size_t)pcb
1213:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("pcb->snd_queuelen >= pbuf_clen(next->p)", (pcb->snd_queuelen >= pbuf_clen(next->
1214:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Prevent ACK for FIN to generate a sent event */
1215:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_queuelen -= pbuf_clen(next->p);
1216:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       recv_acked += next->len;
1217:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_seg_free(next);
1218:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_QLEN_DEBUG, ("%"TCPWNDSIZE_F" (after freeing unsent)\n", (tcpwnd_size_t)pcb->
1219:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->snd_queuelen != 0) {
1220:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_ASSERT("tcp_receive: valid queue length",
1221:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->unacked != NULL || pcb->unsent != NULL);
1222:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1223:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
1224:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     pcb->snd_buf += recv_acked;
1225:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* End of ACK for new data processing. */
1226:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1227:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_DEBUGF(TCP_RTO_DEBUG, ("tcp_receive: pcb->rttest %"U32_F" rtseq %"U32_F" ackno %"U32_F"\n"
1228:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                 pcb->rttest, pcb->rtseq, ackno));
1229:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 23


1230:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* RTT estimation calculations. This is done by checking if the
1231:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        incoming segment acknowledges the segment we use to take a
1232:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        round-trip time measurement. */
1233:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (pcb->rttest && TCP_SEQ_LT(pcb->rtseq, ackno)) {
1234:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* diff between this shouldn't exceed 32K since this are tcp timer ticks
1235:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          and a round-trip shouldn't be that long... */
1236:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       m = (s16_t)(tcp_ticks - pcb->rttest);
1237:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1238:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_RTO_DEBUG, ("tcp_receive: experienced rtt %"U16_F" ticks (%"U16_F" msec).\n",
1239:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                   m, (u16_t)(m * TCP_SLOW_INTERVAL)));
1240:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1241:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* This is taken directly from VJs original code in his paper */
1242:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       m = m - (pcb->sa >> 3);
1243:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->sa += m;
1244:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (m < 0) {
1245:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         m = -m;
1246:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1247:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       m = m - (pcb->sv >> 2);
1248:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->sv += m;
1249:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->rto = (pcb->sa >> 3) + pcb->sv;
1250:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1251:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_RTO_DEBUG, ("tcp_receive: RTO %"U16_F" (%"U16_F" milliseconds)\n",
1252:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                   pcb->rto, (u16_t)(pcb->rto * TCP_SLOW_INTERVAL)));
1253:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1254:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->rttest = 0;
1255:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
1256:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
1257:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1258:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* If the incoming segment contains data, we must process it
1259:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      further unless the pcb already received a FIN.
1260:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      (RFC 793, chapter 3.9, "SEGMENT ARRIVES" in states CLOSE-WAIT, CLOSING,
1261:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****      LAST-ACK and TIME-WAIT: "Ignore the segment text.") */
1262:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if ((tcplen > 0) && (pcb->state < CLOSE_WAIT)) {
1263:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* This code basically does three things:
1264:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1265:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     +) If the incoming segment contains data that is the next
1266:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     in-sequence data, this data is passed to the application. This
1267:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     might involve trimming the first edge of the data. The rcv_nxt
1268:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     variable and the advertised window are adjusted.
1269:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1270:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     +) If the incoming segment has data that is above the next
1271:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     sequence number expected (->rcv_nxt), the segment is placed on
1272:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     the ->ooseq queue. This is done by finding the appropriate
1273:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     place in the ->ooseq queue (which is ordered by sequence
1274:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     number) and trim the segment in both ends if needed. An
1275:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     immediate ACK is sent to indicate that we received an
1276:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     out-of-sequence segment.
1277:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1278:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     +) Finally, we check if the first segment on the ->ooseq queue
1279:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     now is in sequence (i.e., if rcv_nxt >= ooseq->seqno). If
1280:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     rcv_nxt > ooseq->seqno, we must trim the first edge of the
1281:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     segment on ->ooseq before we adjust rcv_nxt. The data in the
1282:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     segments that are now on sequence are chained onto the
1283:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     incoming segment so that we only need to call the application
1284:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     once.
1285:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     */
1286:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 24


1287:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* First, we check if we must trim the first edge. We have to do
1288:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        this if the sequence number of the incoming segment is less
1289:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        than rcv_nxt, and the sequence number plus the length of the
1290:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        segment is larger than rcv_nxt. */
1291:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /*    if (TCP_SEQ_LT(seqno, pcb->rcv_nxt)) {
1292:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (TCP_SEQ_LT(pcb->rcv_nxt, seqno + tcplen)) {*/
1293:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (TCP_SEQ_BETWEEN(pcb->rcv_nxt, seqno + 1, seqno + tcplen - 1)) {
1294:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Trimming the first edge is done by pushing the payload
1295:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          pointer in the pbuf downwards. This is somewhat tricky since
1296:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          we do not want to discard the full contents of the pbuf up to
1297:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          the new starting point of the data since we have to keep the
1298:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          TCP header which is present in the first pbuf in the chain.
1299:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1300:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          What is done is really quite a nasty hack: the first pbuf in
1301:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          the pbuf chain is pointed to by inseg.p. Since we need to be
1302:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          able to deallocate the whole pbuf, we cannot change this
1303:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          inseg.p pointer to point to any of the later pbufs in the
1304:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          chain. Instead, we point the ->payload pointer in the first
1305:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          pbuf to data in one of the later pbufs. We also set the
1306:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          inseg.data pointer to point to the right place. This way, the
1307:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          ->p pointer will still point to the first pbuf, but the
1308:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          ->p->payload pointer will point to data in another pbuf.
1309:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1310:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          After we are done with adjusting the pbuf pointers we must
1311:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          adjust the ->data pointer in the seg and the segment
1312:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****          length.*/
1313:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1314:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       struct pbuf *p = inseg.p;
1315:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       off = pcb->rcv_nxt - seqno;
1316:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("inseg.p != NULL", inseg.p);
1317:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("insane offset!", (off < 0x7fff));
1318:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (inseg.p->len < off) {
1319:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_ASSERT("pbuf too short!", (((s32_t)inseg.p->tot_len) >= off));
1320:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         new_tot_len = (u16_t)(inseg.p->tot_len - off);
1321:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         while (p->len < off) {
1322:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           off -= p->len;
1323:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* KJM following line changed (with addition of new_tot_len var)
1324:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              to fix bug #9076
1325:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              inseg.p->tot_len -= p->len; */
1326:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           p->tot_len = new_tot_len;
1327:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           p->len = 0;
1328:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           p = p->next;
1329:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1330:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (pbuf_header(p, (s16_t)-off)) {
1331:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Do we need to cope with this failing?  Assert for now */
1332:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("pbuf_header failed", 0);
1333:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1334:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
1335:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (pbuf_header(inseg.p, (s16_t)-off)) {
1336:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Do we need to cope with this failing?  Assert for now */
1337:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("pbuf_header failed", 0);
1338:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1339:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1340:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       inseg.len -= (u16_t)(pcb->rcv_nxt - seqno);
1341:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       inseg.tcphdr->seqno = seqno = pcb->rcv_nxt;
1342:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
1343:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     else {
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 25


1344:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (TCP_SEQ_LT(seqno, pcb->rcv_nxt)) {
1345:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* the whole segment is < rcv_nxt */
1346:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* must be a duplicate of a packet that has already been correctly handled */
1347:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1348:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_receive: duplicate seqno %"U32_F"\n", seqno));
1349:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_ack_now(pcb);
1350:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1351:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
1352:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1353:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* The sequence number must be within the window (above rcv_nxt
1354:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        and below rcv_nxt + rcv_wnd) in order to be further
1355:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        processed. */
1356:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (TCP_SEQ_BETWEEN(seqno, pcb->rcv_nxt,
1357:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                         pcb->rcv_nxt + pcb->rcv_wnd - 1)) {
1358:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->rcv_nxt == seqno) {
1359:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* The incoming segment is the next in sequence. We check if
1360:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            we have to trim the end of the segment and update rcv_nxt
1361:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            and pass the data to the application. */
1362:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcplen = TCP_TCPLEN(&inseg);
1363:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1364:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (tcplen > pcb->rcv_wnd) {
1365:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_DEBUGF(TCP_INPUT_DEBUG,
1366:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       ("tcp_receive: other end overran receive window"
1367:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                        "seqno %"U32_F" len %"U16_F" right edge %"U32_F"\n",
1368:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                        seqno, tcplen, pcb->rcv_nxt + pcb->rcv_wnd));
1369:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (TCPH_FLAGS(inseg.tcphdr) & TCP_FIN) {
1370:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Must remove the FIN from the header as we're trimming
1371:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              * that byte of sequence-space from the packet */
1372:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             TCPH_FLAGS_SET(inseg.tcphdr, TCPH_FLAGS(inseg.tcphdr) & ~(unsigned int)TCP_FIN);
1373:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
1374:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Adjust length of segment to fit in the window. */
1375:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           TCPWND_CHECK16(pcb->rcv_wnd);
1376:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           inseg.len = (u16_t)pcb->rcv_wnd;
1377:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (TCPH_FLAGS(inseg.tcphdr) & TCP_SYN) {
1378:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             inseg.len -= 1;
1379:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
1380:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pbuf_realloc(inseg.p, inseg.len);
1381:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           tcplen = TCP_TCPLEN(&inseg);
1382:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("tcp_receive: segment not trimmed correctly to rcv_wnd\n",
1383:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       (seqno + tcplen) == (pcb->rcv_nxt + pcb->rcv_wnd));
1384:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1385:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ
1386:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Received in-sequence data, adjust ooseq data if:
1387:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            - FIN has been received or
1388:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            - inseq overlaps with ooseq */
1389:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (pcb->ooseq != NULL) {
1390:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (TCPH_FLAGS(inseg.tcphdr) & TCP_FIN) {
1391:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             LWIP_DEBUGF(TCP_INPUT_DEBUG,
1392:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                         ("tcp_receive: received in-order FIN, binning ooseq queue\n"));
1393:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Received in-order FIN means anything that was received
1394:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              * out of order must now have been received in-order, so
1395:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              * bin the ooseq queue */
1396:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             while (pcb->ooseq != NULL) {
1397:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               struct tcp_seg *old_ooseq = pcb->ooseq;
1398:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               pcb->ooseq = pcb->ooseq->next;
1399:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               tcp_seg_free(old_ooseq);
1400:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 26


1401:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           } else {
1402:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             next = pcb->ooseq;
1403:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Remove all segments on ooseq that are covered by inseg already.
1404:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              * FIN is copied from ooseq to inseg if present. */
1405:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             while (next &&
1406:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                    TCP_SEQ_GEQ(seqno + tcplen,
1407:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                next->tcphdr->seqno + next->len)) {
1408:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               /* inseg cannot have FIN here (already processed above) */
1409:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if (TCPH_FLAGS(next->tcphdr) & TCP_FIN &&
1410:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   (TCPH_FLAGS(inseg.tcphdr) & TCP_SYN) == 0) {
1411:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 TCPH_SET_FLAG(inseg.tcphdr, TCP_FIN);
1412:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 tcplen = TCP_TCPLEN(&inseg);
1413:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
1414:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               prev = next;
1415:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               next = next->next;
1416:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               tcp_seg_free(prev);
1417:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
1418:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Now trim right side of inseg if it overlaps with the first
1419:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              * segment on ooseq */
1420:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (next &&
1421:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 TCP_SEQ_GT(seqno + tcplen,
1422:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                            next->tcphdr->seqno)) {
1423:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               /* inseg cannot have FIN here (already processed above) */
1424:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               inseg.len = (u16_t)(next->tcphdr->seqno - seqno);
1425:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if (TCPH_FLAGS(inseg.tcphdr) & TCP_SYN) {
1426:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 inseg.len -= 1;
1427:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
1428:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               pbuf_realloc(inseg.p, inseg.len);
1429:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               tcplen = TCP_TCPLEN(&inseg);
1430:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               LWIP_ASSERT("tcp_receive: segment not trimmed correctly to ooseq queue\n",
1431:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                           (seqno + tcplen) == next->tcphdr->seqno);
1432:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
1433:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             pcb->ooseq = next;
1434:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
1435:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1436:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_QUEUE_OOSEQ */
1437:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1438:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->rcv_nxt = seqno + tcplen;
1439:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1440:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Update the receiver's (our) window. */
1441:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_ASSERT("tcp_receive: tcplen > rcv_wnd\n", pcb->rcv_wnd >= tcplen);
1442:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->rcv_wnd -= tcplen;
1443:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1444:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_update_rcv_ann_wnd(pcb);
1445:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1446:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* If there is data in the segment, we make preparations to
1447:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            pass this up to the application. The ->recv_data variable
1448:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            is used for holding the pbuf that goes to the
1449:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            application. The code for reassembling out-of-sequence data
1450:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            chains its data on this pbuf as well.
1451:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1452:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            If the segment was a FIN, we set the TF_GOT_FIN flag that will
1453:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            be used to indicate to the application that the remote side has
1454:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            closed its end of the connection. */
1455:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (inseg.p->tot_len > 0) {
1456:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           recv_data = inseg.p;
1457:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Since this pbuf now is the responsibility of the
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 27


1458:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              application, we delete our reference to it so that we won't
1459:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              (mistakingly) deallocate it. */
1460:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           inseg.p = NULL;
1461:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1462:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (TCPH_FLAGS(inseg.tcphdr) & TCP_FIN) {
1463:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_receive: received FIN.\n"));
1464:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           recv_flags |= TF_GOT_FIN;
1465:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1466:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1467:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ
1468:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* We now check if we have segments on the ->ooseq queue that
1469:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            are now in sequence. */
1470:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         while (pcb->ooseq != NULL &&
1471:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                pcb->ooseq->tcphdr->seqno == pcb->rcv_nxt) {
1472:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1473:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           cseg = pcb->ooseq;
1474:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           seqno = pcb->ooseq->tcphdr->seqno;
1475:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1476:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->rcv_nxt += TCP_TCPLEN(cseg);
1477:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("tcp_receive: ooseq tcplen > rcv_wnd\n",
1478:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       pcb->rcv_wnd >= TCP_TCPLEN(cseg));
1479:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->rcv_wnd -= TCP_TCPLEN(cseg);
1480:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1481:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           tcp_update_rcv_ann_wnd(pcb);
1482:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1483:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (cseg->p->tot_len > 0) {
1484:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Chain this pbuf onto the pbuf that we will pass to
1485:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                the application. */
1486:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* With window scaling, this can overflow recv_data->tot_len, but
1487:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                that's not a problem since we explicitly fix that before passing
1488:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                recv_data to the application. */
1489:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (recv_data) {
1490:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               pbuf_cat(recv_data, cseg->p);
1491:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             } else {
1492:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               recv_data = cseg->p;
1493:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
1494:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             cseg->p = NULL;
1495:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
1496:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (TCPH_FLAGS(cseg->tcphdr) & TCP_FIN) {
1497:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_receive: dequeued FIN.\n"));
1498:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             recv_flags |= TF_GOT_FIN;
1499:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (pcb->state == ESTABLISHED) { /* force passive close or we can move to active close 
1500:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               pcb->state = CLOSE_WAIT;
1501:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
1502:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
1503:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1504:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->ooseq = cseg->next;
1505:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           tcp_seg_free(cseg);
1506:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1507:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_QUEUE_OOSEQ */
1508:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1509:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1510:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Acknowledge the segment(s). */
1511:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_ack(pcb);
1512:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1513:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if LWIP_IPV6 && LWIP_ND6_TCP_REACHABILITY_HINTS
1514:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (ip_current_is_v6()) {
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 28


1515:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Inform neighbor reachability of forward progress. */
1516:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           nd6_reachability_hint(ip6_current_src_addr());
1517:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1518:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* LWIP_IPV6 && LWIP_ND6_TCP_REACHABILITY_HINTS*/
1519:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1520:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
1521:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* We get here if the incoming segment is out-of-sequence. */
1522:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_send_empty_ack(pcb);
1523:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ
1524:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* We queue the segment on the ->ooseq queue. */
1525:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (pcb->ooseq == NULL) {
1526:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->ooseq = tcp_seg_copy(&inseg);
1527:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         } else {
1528:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* If the queue is not empty, we walk through the queue and
1529:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              try to find a place where the sequence number of the
1530:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              incoming segment is between the sequence numbers of the
1531:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              previous and the next segment on the ->ooseq queue. That is
1532:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              the place where we put the incoming segment. If needed, we
1533:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              trim the second edges of the previous and the incoming
1534:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              segment so that it will fit into the sequence.
1535:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1536:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              If the incoming segment has the same sequence number as a
1537:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              segment on the ->ooseq queue, we discard the segment that
1538:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              contains less data. */
1539:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1540:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           prev = NULL;
1541:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           for (next = pcb->ooseq; next != NULL; next = next->next) {
1542:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (seqno == next->tcphdr->seqno) {
1543:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               /* The sequence number of the incoming segment is the
1544:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                  same as the sequence number of the segment on
1545:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                  ->ooseq. We check the lengths to see which one to
1546:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                  discard. */
1547:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if (inseg.len > next->len) {
1548:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 /* The incoming segment is larger than the old
1549:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                    segment. We replace some segments with the new
1550:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                    one. */
1551:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 cseg = tcp_seg_copy(&inseg);
1552:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 if (cseg != NULL) {
1553:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   if (prev != NULL) {
1554:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     prev->next = cseg;
1555:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   } else {
1556:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     pcb->ooseq = cseg;
1557:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   }
1558:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   tcp_oos_insert_segment(cseg, next);
1559:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 }
1560:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 break;
1561:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               } else {
1562:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 /* Either the lengths are the same or the incoming
1563:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                    segment was smaller than the old one; in either
1564:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                    case, we ditch the incoming segment. */
1565:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 break;
1566:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
1567:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             } else {
1568:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if (prev == NULL) {
1569:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 if (TCP_SEQ_LT(seqno, next->tcphdr->seqno)) {
1570:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   /* The sequence number of the incoming segment is lower
1571:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                      than the sequence number of the first segment on the
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 29


1572:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                      queue. We put the incoming segment first on the
1573:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                      queue. */
1574:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   cseg = tcp_seg_copy(&inseg);
1575:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   if (cseg != NULL) {
1576:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     pcb->ooseq = cseg;
1577:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     tcp_oos_insert_segment(cseg, next);
1578:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   }
1579:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   break;
1580:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 }
1581:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               } else {
1582:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 /*if (TCP_SEQ_LT(prev->tcphdr->seqno, seqno) &&
1583:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   TCP_SEQ_LT(seqno, next->tcphdr->seqno)) {*/
1584:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 if (TCP_SEQ_BETWEEN(seqno, prev->tcphdr->seqno+1, next->tcphdr->seqno-1)) {
1585:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   /* The sequence number of the incoming segment is in
1586:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                      between the sequence numbers of the previous and
1587:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                      the next segment on ->ooseq. We trim trim the previous
1588:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                      segment, delete next segments that included in received segment
1589:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                      and trim received, if needed. */
1590:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   cseg = tcp_seg_copy(&inseg);
1591:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   if (cseg != NULL) {
1592:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     if (TCP_SEQ_GT(prev->tcphdr->seqno + prev->len, seqno)) {
1593:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       /* We need to trim the prev segment. */
1594:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       prev->len = (u16_t)(seqno - prev->tcphdr->seqno);
1595:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       pbuf_realloc(prev->p, prev->len);
1596:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     }
1597:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     prev->next = cseg;
1598:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     tcp_oos_insert_segment(cseg, next);
1599:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   }
1600:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   break;
1601:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 }
1602:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
1603:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               /* If the "next" segment is the last segment on the
1604:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                  ooseq queue, we add the incoming segment to the end
1605:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                  of the list. */
1606:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if (next->next == NULL &&
1607:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   TCP_SEQ_GT(seqno, next->tcphdr->seqno)) {
1608:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 if (TCPH_FLAGS(next->tcphdr) & TCP_FIN) {
1609:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   /* segment "next" already contains all data */
1610:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   break;
1611:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 }
1612:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 next->next = tcp_seg_copy(&inseg);
1613:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 if (next->next != NULL) {
1614:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   if (TCP_SEQ_GT(next->tcphdr->seqno + next->len, seqno)) {
1615:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     /* We need to trim the last segment. */
1616:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     next->len = (u16_t)(seqno - next->tcphdr->seqno);
1617:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     pbuf_realloc(next->p, next->len);
1618:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   }
1619:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   /* check if the remote side overruns our receive window */
1620:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   if (TCP_SEQ_GT((u32_t)tcplen + seqno, pcb->rcv_nxt + (u32_t)pcb->rcv_wnd)) {
1621:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     LWIP_DEBUGF(TCP_INPUT_DEBUG,
1622:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                 ("tcp_receive: other end overran receive window"
1623:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                  "seqno %"U32_F" len %"U16_F" right edge %"U32_F"\n",
1624:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                  seqno, tcplen, pcb->rcv_nxt + pcb->rcv_wnd));
1625:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     if (TCPH_FLAGS(next->next->tcphdr) & TCP_FIN) {
1626:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       /* Must remove the FIN from the header as we're trimming
1627:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                        * that byte of sequence-space from the packet */
1628:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       TCPH_FLAGS_SET(next->next->tcphdr, TCPH_FLAGS(next->next->tcphdr) & ~TCP_FIN)
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 30


1629:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     }
1630:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     /* Adjust length of segment to fit in the window. */
1631:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     next->next->len = (u16_t)(pcb->rcv_nxt + pcb->rcv_wnd - seqno);
1632:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     pbuf_realloc(next->next->p, next->next->len);
1633:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     tcplen = TCP_TCPLEN(next->next);
1634:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     LWIP_ASSERT("tcp_receive: segment not trimmed correctly to rcv_wnd\n",
1635:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                 (seqno + tcplen) == (pcb->rcv_nxt + pcb->rcv_wnd));
1636:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   }
1637:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 }
1638:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 break;
1639:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
1640:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
1641:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             prev = next;
1642:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
1643:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1644:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_OOSEQ_MAX_BYTES || TCP_OOSEQ_MAX_PBUFS
1645:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Check that the data on ooseq doesn't exceed one of the limits
1646:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            and throw away everything above that limit. */
1647:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ooseq_blen = 0;
1648:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ooseq_qlen = 0;
1649:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         prev = NULL;
1650:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         for (next = pcb->ooseq; next != NULL; prev = next, next = next->next) {
1651:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           struct pbuf *p = next->p;
1652:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           ooseq_blen += p->tot_len;
1653:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           ooseq_qlen += pbuf_clen(p);
1654:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if ((ooseq_blen > TCP_OOSEQ_MAX_BYTES) ||
1655:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               (ooseq_qlen > TCP_OOSEQ_MAX_PBUFS)) {
1656:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              /* too much ooseq data, dump this and everything after it */
1657:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              tcp_segs_free(next);
1658:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              if (prev == NULL) {
1659:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                /* first ooseq segment is too much, dump the whole queue */
1660:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                pcb->ooseq = NULL;
1661:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              } else {
1662:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                /* just dump 'next' and everything after it */
1663:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                prev->next = NULL;
1664:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              }
1665:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              break;
1666:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
1667:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1668:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_OOSEQ_MAX_BYTES || TCP_OOSEQ_MAX_PBUFS */
1669:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_QUEUE_OOSEQ */
1670:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1671:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     } else {
1672:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* The incoming segment is not within the window. */
1673:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_send_empty_ack(pcb);
1674:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
1675:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   } else {
1676:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Segments with length 0 is taken care of here. Segments that
1677:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        fall out of the window are ACKed. */
1678:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (!TCP_SEQ_BETWEEN(seqno, pcb->rcv_nxt, pcb->rcv_nxt + pcb->rcv_wnd - 1)) {
1679:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_ack_now(pcb);
1680:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
1681:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
1682:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
1683:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1684:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static u8_t
1685:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** tcp_getoptbyte(void)
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 31


1686:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** {
  27              		.loc 1 1686 0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		@ link register save eliminated.
1687:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if ((tcphdr_opt2 == NULL) || (tcp_optidx < tcphdr_opt1len)) {
  32              		.loc 1 1687 0
  33 0000 0E4B     		ldr	r3, .L8
  34 0002 1968     		ldr	r1, [r3]
  35 0004 89B1     		cbz	r1, .L2
  36              		.loc 1 1687 0 is_stmt 0 discriminator 1
  37 0006 0E4B     		ldr	r3, .L8+4
  38 0008 1B88     		ldrh	r3, [r3]
  39 000a 0E4A     		ldr	r2, .L8+8
  40 000c 1288     		ldrh	r2, [r2]
  41 000e 9342     		cmp	r3, r2
  42 0010 0BD3     		bcc	.L2
1686:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if ((tcphdr_opt2 == NULL) || (tcp_optidx < tcphdr_opt1len)) {
  43              		.loc 1 1686 0 is_stmt 1
  44 0012 10B4     		push	{r4}
  45              	.LCFI0:
  46              		.cfi_def_cfa_offset 4
  47              		.cfi_offset 4, -4
  48              	.LBB2:
1688:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     u8_t* opts = (u8_t *)tcphdr + TCP_HLEN;
1689:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     return opts[tcp_optidx++];
1690:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   } else {
1691:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     u8_t idx = (u8_t)(tcp_optidx++ - tcphdr_opt1len);
  49              		.loc 1 1691 0
  50 0014 5C1C     		adds	r4, r3, #1
  51 0016 0A48     		ldr	r0, .L8+4
  52 0018 0480     		strh	r4, [r0]	@ movhi
  53 001a DBB2     		uxtb	r3, r3
  54 001c D2B2     		uxtb	r2, r2
  55 001e 9B1A     		subs	r3, r3, r2
  56 0020 DBB2     		uxtb	r3, r3
  57              	.LVL0:
1692:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     return tcphdr_opt2[idx];
  58              		.loc 1 1692 0
  59 0022 C85C     		ldrb	r0, [r1, r3]	@ zero_extendqisi2
  60              	.LBE2:
1693:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
1694:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
  61              		.loc 1 1694 0
  62 0024 5DF8044B 		ldr	r4, [sp], #4
  63              	.LCFI1:
  64              		.cfi_restore 4
  65              		.cfi_def_cfa_offset 0
  66 0028 7047     		bx	lr
  67              	.LVL1:
  68              	.L2:
  69              	.LBB3:
1688:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     return opts[tcp_optidx++];
  70              		.loc 1 1688 0
  71 002a 074B     		ldr	r3, .L8+12
  72 002c 1B68     		ldr	r3, [r3]
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 32


  73              	.LVL2:
1689:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   } else {
  74              		.loc 1 1689 0
  75 002e 0449     		ldr	r1, .L8+4
  76 0030 0A88     		ldrh	r2, [r1]
  77 0032 501C     		adds	r0, r2, #1
  78 0034 0880     		strh	r0, [r1]	@ movhi
  79 0036 1344     		add	r3, r3, r2
  80              	.LVL3:
  81 0038 187D     		ldrb	r0, [r3, #20]	@ zero_extendqisi2
  82 003a 7047     		bx	lr
  83              	.L9:
  84              		.align	2
  85              	.L8:
  86 003c 00000000 		.word	.LANCHOR0
  87 0040 00000000 		.word	.LANCHOR1
  88 0044 00000000 		.word	.LANCHOR2
  89 0048 00000000 		.word	.LANCHOR3
  90              	.LBE3:
  91              		.cfi_endproc
  92              	.LFE142:
  94              		.section	.text.tcp_parseopt,"ax",%progbits
  95              		.align	1
  96              		.syntax unified
  97              		.thumb
  98              		.thumb_func
  99              		.fpu fpv5-sp-d16
 101              	tcp_parseopt:
 102              	.LFB143:
1695:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1696:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** /**
1697:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Parses the options contained in the incoming segment.
1698:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
1699:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Called from tcp_listen_input() and tcp_process().
1700:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * Currently, only the MSS option is supported!
1701:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  *
1702:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  * @param pcb the tcp_pcb for which a segment arrived
1703:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****  */
1704:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** static void
1705:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** tcp_parseopt(struct tcp_pcb *pcb)
1706:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** {
 103              		.loc 1 1706 0
 104              		.cfi_startproc
 105              		@ args = 0, pretend = 0, frame = 0
 106              		@ frame_needed = 0, uses_anonymous_args = 0
 107              	.LVL4:
 108 0000 38B5     		push	{r3, r4, r5, lr}
 109              	.LCFI2:
 110              		.cfi_def_cfa_offset 16
 111              		.cfi_offset 3, -16
 112              		.cfi_offset 4, -12
 113              		.cfi_offset 5, -8
 114              		.cfi_offset 14, -4
1707:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   u8_t data;
1708:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   u16_t mss;
1709:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if LWIP_TCP_TIMESTAMPS
1710:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   u32_t tsval;
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 33


1711:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif
1712:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1713:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* Parse the TCP MSS option, if present. */
1714:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (tcphdr_optlen != 0) {
 115              		.loc 1 1714 0
 116 0002 1F4B     		ldr	r3, .L22
 117 0004 1B88     		ldrh	r3, [r3]
 118 0006 002B     		cmp	r3, #0
 119 0008 38D0     		beq	.L10
 120 000a 0546     		mov	r5, r0
1715:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     for (tcp_optidx = 0; tcp_optidx < tcphdr_optlen; ) {
 121              		.loc 1 1715 0
 122 000c 0022     		movs	r2, #0
 123 000e 1D4B     		ldr	r3, .L22+4
 124 0010 1A80     		strh	r2, [r3]	@ movhi
 125              	.LVL5:
 126              	.L14:
 127              		.loc 1 1715 0 is_stmt 0 discriminator 1
 128 0012 1C4B     		ldr	r3, .L22+4
 129 0014 1A88     		ldrh	r2, [r3]
 130 0016 1A4B     		ldr	r3, .L22
 131 0018 1B88     		ldrh	r3, [r3]
 132 001a 9A42     		cmp	r2, r3
 133 001c 2ED2     		bcs	.L10
 134              	.LBB4:
1716:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       u8_t opt = tcp_getoptbyte();
 135              		.loc 1 1716 0 is_stmt 1
 136 001e FFF7FEFF 		bl	tcp_getoptbyte
 137              	.LVL6:
1717:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       switch (opt) {
 138              		.loc 1 1717 0
 139 0022 0128     		cmp	r0, #1
 140 0024 F5D0     		beq	.L14
 141 0026 48B3     		cbz	r0, .L10
 142 0028 0228     		cmp	r0, #2
 143 002a 1DD1     		bne	.L20
1718:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       case LWIP_TCP_OPT_EOL:
1719:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* End of options. */
1720:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_parseopt: EOL\n"));
1721:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         return;
1722:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       case LWIP_TCP_OPT_NOP:
1723:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* NOP option. */
1724:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_parseopt: NOP\n"));
1725:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         break;
1726:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       case LWIP_TCP_OPT_MSS:
1727:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_parseopt: MSS\n"));
1728:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (tcp_getoptbyte() != LWIP_TCP_OPT_LEN_MSS || (tcp_optidx - 2 + LWIP_TCP_OPT_LEN_MSS) > t
 144              		.loc 1 1728 0
 145 002c FFF7FEFF 		bl	tcp_getoptbyte
 146              	.LVL7:
 147 0030 0428     		cmp	r0, #4
 148 0032 23D1     		bne	.L10
 149              		.loc 1 1728 0 is_stmt 0 discriminator 1
 150 0034 134B     		ldr	r3, .L22+4
 151 0036 1B88     		ldrh	r3, [r3]
 152 0038 0233     		adds	r3, r3, #2
 153 003a 114A     		ldr	r2, .L22
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 34


 154 003c 1288     		ldrh	r2, [r2]
 155 003e 9342     		cmp	r3, r2
 156 0040 1CDC     		bgt	.L10
1729:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Bad length */
1730:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_parseopt: bad length\n"));
1731:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           return;
1732:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1733:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* An MSS option with the right option length. */
1734:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         mss = (tcp_getoptbyte() << 8);
 157              		.loc 1 1734 0 is_stmt 1
 158 0042 FFF7FEFF 		bl	tcp_getoptbyte
 159              	.LVL8:
 160 0046 83B2     		uxth	r3, r0
 161 0048 1B02     		lsls	r3, r3, #8
 162 004a 9CB2     		uxth	r4, r3
 163              	.LVL9:
1735:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         mss |= tcp_getoptbyte();
 164              		.loc 1 1735 0
 165 004c FFF7FEFF 		bl	tcp_getoptbyte
 166              	.LVL10:
 167 0050 80B2     		uxth	r0, r0
 168 0052 44EA0003 		orr	r3, r4, r0
 169              	.LVL11:
1736:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Limit the mss to the configured TCP_MSS and prevent division by zero */
1737:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->mss = ((mss > TCP_MSS) || (mss == 0)) ? TCP_MSS : mss;
 170              		.loc 1 1737 0
 171 0056 5A1E     		subs	r2, r3, #1
 172 0058 92B2     		uxth	r2, r2
 173 005a B2F5067F 		cmp	r2, #536
 174 005e 01D3     		bcc	.L16
 175 0060 4FF40673 		mov	r3, #536
 176              	.LVL12:
 177              	.L16:
 178              		.loc 1 1737 0 is_stmt 0 discriminator 4
 179 0064 6B86     		strh	r3, [r5, #50]	@ movhi
1738:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         break;
 180              		.loc 1 1738 0 is_stmt 1 discriminator 4
 181 0066 D4E7     		b	.L14
 182              	.LVL13:
 183              	.L20:
1739:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if LWIP_WND_SCALE
1740:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       case LWIP_TCP_OPT_WS:
1741:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_parseopt: WND_SCALE\n"));
1742:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (tcp_getoptbyte() != LWIP_TCP_OPT_LEN_WS || (tcp_optidx - 2 + LWIP_TCP_OPT_LEN_WS) > tcp
1743:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Bad length */
1744:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_parseopt: bad length\n"));
1745:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           return;
1746:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1747:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* If syn was received with wnd scale option,
1748:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            activate wnd scale opt, but only if this is not a retransmission */
1749:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if ((flags & TCP_SYN) && !(pcb->flags & TF_WND_SCALE)) {
1750:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* An WND_SCALE option with the right option length. */
1751:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           data = tcp_getoptbyte();
1752:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->snd_scale = data;
1753:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (pcb->snd_scale > 14U) {
1754:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             pcb->snd_scale = 14U;
1755:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 35


1756:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->rcv_scale = TCP_RCV_SCALE;
1757:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->flags |= TF_WND_SCALE;
1758:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* window scaling is enabled, we can use the full receive window */
1759:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("window not at default value", pcb->rcv_wnd == TCPWND_MIN16(TCP_WND));
1760:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("window not at default value", pcb->rcv_ann_wnd == TCPWND_MIN16(TCP_WND));
1761:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->rcv_wnd = pcb->rcv_ann_wnd = TCP_WND;
1762:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1763:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         break;
1764:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif
1765:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if LWIP_TCP_TIMESTAMPS
1766:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       case LWIP_TCP_OPT_TS:
1767:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_parseopt: TS\n"));
1768:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (tcp_getoptbyte() != LWIP_TCP_OPT_LEN_TS || (tcp_optidx - 2 + LWIP_TCP_OPT_LEN_TS) > tcp
1769:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Bad length */
1770:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_parseopt: bad length\n"));
1771:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           return;
1772:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1773:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* TCP timestamp option with valid length */
1774:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tsval = tcp_getoptbyte();
1775:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tsval |= (tcp_getoptbyte() << 8);
1776:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tsval |= (tcp_getoptbyte() << 16);
1777:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tsval |= (tcp_getoptbyte() << 24);
1778:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (flags & TCP_SYN) {
1779:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->ts_recent = lwip_ntohl(tsval);
1780:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Enable sending timestamps in every segment now that we know
1781:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              the remote host supports it. */
1782:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->flags |= TF_TIMESTAMP;
1783:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         } else if (TCP_SEQ_BETWEEN(pcb->ts_lastacksent, seqno, seqno+tcplen)) {
1784:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->ts_recent = lwip_ntohl(tsval);
1785:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1786:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Advance to next option (6 bytes already read) */
1787:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_optidx += LWIP_TCP_OPT_LEN_TS - 6;
1788:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         break;
1789:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif
1790:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       default:
1791:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_parseopt: other\n"));
1792:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         data = tcp_getoptbyte();
 184              		.loc 1 1792 0
 185 0068 FFF7FEFF 		bl	tcp_getoptbyte
 186              	.LVL14:
1793:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (data < 2) {
 187              		.loc 1 1793 0
 188 006c 0128     		cmp	r0, #1
 189 006e 05D9     		bls	.L10
1794:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_parseopt: bad length\n"));
1795:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* If the length field is zero, the options are malformed
1796:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              and we don't process them further. */
1797:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           return;
1798:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
1799:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* All other options have a length field, so that we easily
1800:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            can skip past them. */
1801:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_optidx += data - 2;
 190              		.loc 1 1801 0
 191 0070 044B     		ldr	r3, .L22+4
 192 0072 1A88     		ldrh	r2, [r3]
 193 0074 1044     		add	r0, r0, r2
 194              	.LVL15:
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 36


 195 0076 0238     		subs	r0, r0, #2
 196 0078 1880     		strh	r0, [r3]	@ movhi
 197 007a CAE7     		b	.L14
 198              	.LVL16:
 199              	.L10:
 200 007c 38BD     		pop	{r3, r4, r5, pc}
 201              	.L23:
 202 007e 00BF     		.align	2
 203              	.L22:
 204 0080 00000000 		.word	.LANCHOR4
 205 0084 00000000 		.word	.LANCHOR1
 206              	.LBE4:
 207              		.cfi_endproc
 208              	.LFE143:
 210              		.section	.text.tcp_timewait_input,"ax",%progbits
 211              		.align	1
 212              		.syntax unified
 213              		.thumb
 214              		.thumb_func
 215              		.fpu fpv5-sp-d16
 217              	tcp_timewait_input:
 218              	.LFB138:
 637:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* RFC 1337: in TIME_WAIT, ignore RST and ACK FINs + any 'acceptable' segments */
 219              		.loc 1 637 0
 220              		.cfi_startproc
 221              		@ args = 0, pretend = 0, frame = 0
 222              		@ frame_needed = 0, uses_anonymous_args = 0
 223              	.LVL17:
 643:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     return;
 224              		.loc 1 643 0
 225 0000 1C4B     		ldr	r3, .L32
 226 0002 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 227 0004 13F0040F 		tst	r3, #4
 228 0008 32D1     		bne	.L29
 637:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   /* RFC 1337: in TIME_WAIT, ignore RST and ACK FINs + any 'acceptable' segments */
 229              		.loc 1 637 0
 230 000a 10B5     		push	{r4, lr}
 231              	.LCFI3:
 232              		.cfi_def_cfa_offset 8
 233              		.cfi_offset 4, -8
 234              		.cfi_offset 14, -4
 235 000c 82B0     		sub	sp, sp, #8
 236              	.LCFI4:
 237              		.cfi_def_cfa_offset 16
 647:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* If an incoming segment is not acceptable, an acknowledgment
 238              		.loc 1 647 0
 239 000e 13F0020F 		tst	r3, #2
 240 0012 1CD0     		beq	.L26
 650:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* If the SYN is in the window it is an error, send a reset */
 241              		.loc 1 650 0
 242 0014 184B     		ldr	r3, .L32+4
 243 0016 1968     		ldr	r1, [r3]
 244 0018 436A     		ldr	r3, [r0, #36]
 245 001a CA1A     		subs	r2, r1, r3
 246 001c 002A     		cmp	r2, #0
 247 001e 1CDB     		blt	.L27
 650:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* If the SYN is in the window it is an error, send a reset */
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 37


 248              		.loc 1 650 0 is_stmt 0 discriminator 1
 249 0020 028D     		ldrh	r2, [r0, #40]
 250 0022 1344     		add	r3, r3, r2
 251 0024 CB1A     		subs	r3, r1, r3
 252 0026 002B     		cmp	r3, #0
 253 0028 17DC     		bgt	.L27
 653:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       return;
 254              		.loc 1 653 0 is_stmt 1
 255 002a 144B     		ldr	r3, .L32+8
 256 002c 1B68     		ldr	r3, [r3]
 652:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_current_src_addr(), tcphdr->dest, tcphdr->src);
 257              		.loc 1 652 0
 258 002e 144A     		ldr	r2, .L32+12
 259 0030 1448     		ldr	r0, .L32+16
 260              	.LVL18:
 261 0032 0088     		ldrh	r0, [r0]
 262 0034 1C88     		ldrh	r4, [r3]	@ unaligned
 263 0036 0194     		str	r4, [sp, #4]
 264 0038 5B88     		ldrh	r3, [r3, #2]	@ unaligned
 265 003a 0093     		str	r3, [sp]
 266 003c 1346     		mov	r3, r2
 267 003e 0432     		adds	r2, r2, #4
 268 0040 0144     		add	r1, r1, r0
 269 0042 1148     		ldr	r0, .L32+20
 270 0044 0068     		ldr	r0, [r0]
 271 0046 FFF7FEFF 		bl	tcp_rst
 272              	.LVL19:
 273              	.L24:
 668:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 274              		.loc 1 668 0
 275 004a 02B0     		add	sp, sp, #8
 276              	.LCFI5:
 277              		.cfi_remember_state
 278              		.cfi_def_cfa_offset 8
 279              		@ sp needed
 280 004c 10BD     		pop	{r4, pc}
 281              	.LVL20:
 282              	.L26:
 283              	.LCFI6:
 284              		.cfi_restore_state
 656:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* - eighth, check the FIN bit: Remain in the TIME-WAIT state.
 285              		.loc 1 656 0
 286 004e 13F0010F 		tst	r3, #1
 287 0052 02D0     		beq	.L27
 659:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 288              		.loc 1 659 0
 289 0054 0D4B     		ldr	r3, .L32+24
 290 0056 1B68     		ldr	r3, [r3]
 291 0058 0362     		str	r3, [r0, #32]
 292              	.L27:
 662:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Acknowledge data, FIN or out-of-window SYN */
 293              		.loc 1 662 0
 294 005a 0A4B     		ldr	r3, .L32+16
 295 005c 1B88     		ldrh	r3, [r3]
 296 005e 002B     		cmp	r3, #0
 297 0060 F3D0     		beq	.L24
 664:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     tcp_output(pcb);
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 38


 298              		.loc 1 664 0
 299 0062 837E     		ldrb	r3, [r0, #26]	@ zero_extendqisi2
 300 0064 43F00203 		orr	r3, r3, #2
 301 0068 8376     		strb	r3, [r0, #26]
 665:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 302              		.loc 1 665 0
 303 006a FFF7FEFF 		bl	tcp_output
 304              	.LVL21:
 305 006e ECE7     		b	.L24
 306              	.LVL22:
 307              	.L29:
 308              	.LCFI7:
 309              		.cfi_def_cfa_offset 0
 310              		.cfi_restore 4
 311              		.cfi_restore 14
 312 0070 7047     		bx	lr
 313              	.L33:
 314 0072 00BF     		.align	2
 315              	.L32:
 316 0074 00000000 		.word	.LANCHOR5
 317 0078 00000000 		.word	.LANCHOR6
 318 007c 00000000 		.word	.LANCHOR3
 319 0080 10000000 		.word	ip_data+16
 320 0084 00000000 		.word	.LANCHOR7
 321 0088 00000000 		.word	.LANCHOR8
 322 008c 00000000 		.word	tcp_ticks
 323              		.cfi_endproc
 324              	.LFE138:
 326              		.section	.text.tcp_listen_input,"ax",%progbits
 327              		.align	1
 328              		.syntax unified
 329              		.thumb
 330              		.thumb_func
 331              		.fpu fpv5-sp-d16
 333              	tcp_listen_input:
 334              	.LFB137:
 543:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_pcb *npcb;
 335              		.loc 1 543 0
 336              		.cfi_startproc
 337              		@ args = 0, pretend = 0, frame = 0
 338              		@ frame_needed = 0, uses_anonymous_args = 0
 339              	.LVL23:
 547:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* An incoming RST should be ignored. Return. */
 340              		.loc 1 547 0
 341 0000 3B4B     		ldr	r3, .L47
 342 0002 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 343 0004 13F0040F 		tst	r3, #4
 344 0008 70D1     		bne	.L40
 543:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_pcb *npcb;
 345              		.loc 1 543 0
 346 000a 70B5     		push	{r4, r5, r6, lr}
 347              	.LCFI8:
 348              		.cfi_def_cfa_offset 16
 349              		.cfi_offset 4, -16
 350              		.cfi_offset 5, -12
 351              		.cfi_offset 6, -8
 352              		.cfi_offset 14, -4
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 39


 353 000c 82B0     		sub	sp, sp, #8
 354              	.LCFI9:
 355              		.cfi_def_cfa_offset 24
 356 000e 0446     		mov	r4, r0
 554:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* For incoming segments with the ACK flag set, respond with a
 357              		.loc 1 554 0
 358 0010 13F0100F 		tst	r3, #16
 359 0014 04D1     		bne	.L43
 560:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_DEBUGF(TCP_DEBUG, ("TCP connection request %"U16_F" -> %"U16_F".\n", tcphdr->src, tcphdr->
 360              		.loc 1 560 0
 361 0016 13F0020F 		tst	r3, #2
 362 001a 14D1     		bne	.L44
 363              	.LVL24:
 364              	.L34:
 624:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 365              		.loc 1 624 0
 366 001c 02B0     		add	sp, sp, #8
 367              	.LCFI10:
 368              		.cfi_remember_state
 369              		.cfi_def_cfa_offset 16
 370              		@ sp needed
 371 001e 70BD     		pop	{r4, r5, r6, pc}
 372              	.LVL25:
 373              	.L43:
 374              	.LCFI11:
 375              		.cfi_restore_state
 559:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   } else if (flags & TCP_SYN) {
 376              		.loc 1 559 0
 377 0020 344B     		ldr	r3, .L47+4
 378 0022 1B68     		ldr	r3, [r3]
 558:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       ip_current_src_addr(), tcphdr->dest, tcphdr->src);
 379              		.loc 1 558 0
 380 0024 344A     		ldr	r2, .L47+8
 381 0026 3549     		ldr	r1, .L47+12
 382 0028 0C88     		ldrh	r4, [r1]
 383 002a 3549     		ldr	r1, .L47+16
 384 002c 0968     		ldr	r1, [r1]
 385 002e 3548     		ldr	r0, .L47+20
 386              	.LVL26:
 387 0030 0068     		ldr	r0, [r0]
 388 0032 1D88     		ldrh	r5, [r3]	@ unaligned
 389 0034 0195     		str	r5, [sp, #4]
 390 0036 5B88     		ldrh	r3, [r3, #2]	@ unaligned
 391 0038 0093     		str	r3, [sp]
 392 003a 1346     		mov	r3, r2
 393 003c 0432     		adds	r2, r2, #4
 394 003e 2144     		add	r1, r1, r4
 395 0040 FFF7FEFF 		bl	tcp_rst
 396              	.LVL27:
 397 0044 EAE7     		b	.L34
 398              	.LVL28:
 399              	.L44:
 568:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* If a new PCB could not be created (probably due to lack of memory),
 400              		.loc 1 568 0
 401 0046 407D     		ldrb	r0, [r0, #21]	@ zero_extendqisi2
 402              	.LVL29:
 403 0048 FFF7FEFF 		bl	tcp_alloc
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 40


 404              	.LVL30:
 572:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       err_t err;
 405              		.loc 1 572 0
 406 004c 0546     		mov	r5, r0
 407 004e 0028     		cmp	r0, #0
 408 0050 3CD0     		beq	.L45
 585:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     ip_addr_copy(npcb->remote_ip, *ip_current_src_addr());
 409              		.loc 1 585 0
 410 0052 2D4B     		ldr	r3, .L47+24
 411 0054 5A69     		ldr	r2, [r3, #20]
 412 0056 0260     		str	r2, [r0]
 586:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->local_port = pcb->local_port;
 413              		.loc 1 586 0
 414 0058 1B69     		ldr	r3, [r3, #16]
 415 005a 4360     		str	r3, [r0, #4]
 587:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->remote_port = tcphdr->src;
 416              		.loc 1 587 0
 417 005c E38A     		ldrh	r3, [r4, #22]
 418 005e C382     		strh	r3, [r0, #22]	@ movhi
 588:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->state = SYN_RCVD;
 419              		.loc 1 588 0
 420 0060 244E     		ldr	r6, .L47+4
 421 0062 3368     		ldr	r3, [r6]
 422 0064 1B88     		ldrh	r3, [r3]	@ unaligned
 423 0066 0383     		strh	r3, [r0, #24]	@ movhi
 589:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->rcv_nxt = seqno + 1;
 424              		.loc 1 589 0
 425 0068 0323     		movs	r3, #3
 426 006a 0375     		strb	r3, [r0, #20]
 590:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->rcv_ann_right_edge = npcb->rcv_nxt;
 427              		.loc 1 590 0
 428 006c 244B     		ldr	r3, .L47+16
 429 006e 1B68     		ldr	r3, [r3]
 430 0070 5A1C     		adds	r2, r3, #1
 431 0072 4262     		str	r2, [r0, #36]
 591:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->snd_wl1 = seqno - 1;/* initialise to seqno-1 to force window update */
 432              		.loc 1 591 0
 433 0074 C262     		str	r2, [r0, #44]
 592:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->callback_arg = pcb->callback_arg;
 434              		.loc 1 592 0
 435 0076 013B     		subs	r3, r3, #1
 436 0078 0365     		str	r3, [r0, #80]
 593:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if LWIP_CALLBACK_API || TCP_LISTEN_BACKLOG
 437              		.loc 1 593 0
 438 007a 2369     		ldr	r3, [r4, #16]
 439 007c 0361     		str	r3, [r0, #16]
 595:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* LWIP_CALLBACK_API || TCP_LISTEN_BACKLOG */
 440              		.loc 1 595 0
 441 007e 8467     		str	r4, [r0, #120]
 598:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Register the new PCB so that we can begin receiving segments
 442              		.loc 1 598 0
 443 0080 237A     		ldrb	r3, [r4, #8]	@ zero_extendqisi2
 444 0082 03F00C03 		and	r3, r3, #12
 445 0086 0372     		strb	r3, [r0, #8]
 601:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 446              		.loc 1 601 0
 447 0088 204B     		ldr	r3, .L47+28
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 41


 448 008a 1A68     		ldr	r2, [r3]
 449 008c C260     		str	r2, [r0, #12]
 450 008e 1860     		str	r0, [r3]
 451 0090 FFF7FEFF 		bl	tcp_timer_needed
 452              	.LVL31:
 453 0094 0122     		movs	r2, #1
 454 0096 1E4B     		ldr	r3, .L47+32
 455 0098 1A70     		strb	r2, [r3]
 604:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->snd_wnd = SND_WND_SCALE(npcb, tcphdr->wnd);
 456              		.loc 1 604 0
 457 009a 2846     		mov	r0, r5
 458 009c FFF7FEFF 		bl	tcp_parseopt
 459              	.LVL32:
 605:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->snd_wnd_max = npcb->snd_wnd;
 460              		.loc 1 605 0
 461 00a0 3368     		ldr	r3, [r6]
 462 00a2 DB89     		ldrh	r3, [r3, #14]	@ unaligned
 463 00a4 A5F85C30 		strh	r3, [r5, #92]	@ movhi
 606:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     npcb->ssthresh = LWIP_TCP_INITIAL_SSTHRESH(npcb);
 464              		.loc 1 606 0
 465 00a8 A5F85E30 		strh	r3, [r5, #94]	@ movhi
 607:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 466              		.loc 1 607 0
 467 00ac A5F84A30 		strh	r3, [r5, #74]	@ movhi
 610:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_CALCULATE_EFF_SEND_MSS */
 468              		.loc 1 610 0
 469 00b0 291D     		adds	r1, r5, #4
 470 00b2 688E     		ldrh	r0, [r5, #50]
 471 00b4 FFF7FEFF 		bl	tcp_eff_send_mss_impl
 472              	.LVL33:
 473 00b8 6886     		strh	r0, [r5, #50]	@ movhi
 616:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (rc != ERR_OK) {
 474              		.loc 1 616 0
 475 00ba 1221     		movs	r1, #18
 476 00bc 2846     		mov	r0, r5
 477 00be FFF7FEFF 		bl	tcp_enqueue_flags
 478              	.LVL34:
 617:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_abandon(npcb, 0);
 479              		.loc 1 617 0
 480 00c2 70B9     		cbnz	r0, .L46
 621:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 481              		.loc 1 621 0
 482 00c4 2846     		mov	r0, r5
 483              	.LVL35:
 484 00c6 FFF7FEFF 		bl	tcp_output
 485              	.LVL36:
 486 00ca A7E7     		b	.L34
 487              	.LVL37:
 488              	.L45:
 489              	.LBB5:
 576:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_UNUSED_ARG(err); /* err not useful here */
 490              		.loc 1 576 0
 491 00cc 002C     		cmp	r4, #0
 492 00ce A5D0     		beq	.L34
 576:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_UNUSED_ARG(err); /* err not useful here */
 493              		.loc 1 576 0 is_stmt 0 discriminator 1
 494 00d0 A369     		ldr	r3, [r4, #24]
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 42


 495 00d2 002B     		cmp	r3, #0
 496 00d4 A2D0     		beq	.L34
 576:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_UNUSED_ARG(err); /* err not useful here */
 497              		.loc 1 576 0 discriminator 3
 498 00d6 4FF0FF32 		mov	r2, #-1
 499 00da 0021     		movs	r1, #0
 500 00dc 2069     		ldr	r0, [r4, #16]
 501              	.LVL38:
 502 00de 9847     		blx	r3
 503              	.LVL39:
 504 00e0 9CE7     		b	.L34
 505              	.LVL40:
 506              	.L46:
 507              	.LBE5:
 618:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       return;
 508              		.loc 1 618 0 is_stmt 1
 509 00e2 0021     		movs	r1, #0
 510 00e4 2846     		mov	r0, r5
 511              	.LVL41:
 512 00e6 FFF7FEFF 		bl	tcp_abandon
 513              	.LVL42:
 619:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 514              		.loc 1 619 0
 515 00ea 97E7     		b	.L34
 516              	.LVL43:
 517              	.L40:
 518              	.LCFI12:
 519              		.cfi_def_cfa_offset 0
 520              		.cfi_restore 4
 521              		.cfi_restore 5
 522              		.cfi_restore 6
 523              		.cfi_restore 14
 524 00ec 7047     		bx	lr
 525              	.L48:
 526 00ee 00BF     		.align	2
 527              	.L47:
 528 00f0 00000000 		.word	.LANCHOR5
 529 00f4 00000000 		.word	.LANCHOR3
 530 00f8 10000000 		.word	ip_data+16
 531 00fc 00000000 		.word	.LANCHOR7
 532 0100 00000000 		.word	.LANCHOR6
 533 0104 00000000 		.word	.LANCHOR8
 534 0108 00000000 		.word	ip_data
 535 010c 00000000 		.word	tcp_active_pcbs
 536 0110 00000000 		.word	tcp_active_pcbs_changed
 537              		.cfi_endproc
 538              	.LFE137:
 540              		.section	.text.tcp_oos_insert_segment,"ax",%progbits
 541              		.align	1
 542              		.syntax unified
 543              		.thumb
 544              		.thumb_func
 545              		.fpu fpv5-sp-d16
 547              	tcp_oos_insert_segment:
 548              	.LFB140:
 947:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_seg *old_seg;
 549              		.loc 1 947 0
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 43


 550              		.cfi_startproc
 551              		@ args = 0, pretend = 0, frame = 0
 552              		@ frame_needed = 0, uses_anonymous_args = 0
 553              	.LVL44:
 554 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 555              	.LCFI13:
 556              		.cfi_def_cfa_offset 24
 557              		.cfi_offset 3, -24
 558              		.cfi_offset 4, -20
 559              		.cfi_offset 5, -16
 560              		.cfi_offset 6, -12
 561              		.cfi_offset 7, -8
 562              		.cfi_offset 14, -4
 563 0002 0546     		mov	r5, r0
 564 0004 0C46     		mov	r4, r1
 950:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* received segment overlaps all following segments */
 565              		.loc 1 950 0
 566 0006 C368     		ldr	r3, [r0, #12]
 567 0008 9889     		ldrh	r0, [r3, #12]	@ unaligned
 568              	.LVL45:
 569 000a FFF7FEFF 		bl	lwip_htons
 570              	.LVL46:
 571 000e 10F0010F 		tst	r0, #1
 572 0012 09D0     		beq	.L50
 952:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     next = NULL;
 573              		.loc 1 952 0
 574 0014 2046     		mov	r0, r4
 575 0016 FFF7FEFF 		bl	tcp_segs_free
 576              	.LVL47:
 953:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   } else {
 577              		.loc 1 953 0
 578 001a 0024     		movs	r4, #0
 579 001c 2EE0     		b	.L51
 580              	.LVL48:
 581              	.L52:
 965:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_seg_free(old_seg);
 582              		.loc 1 965 0
 583 001e 2668     		ldr	r6, [r4]
 584              	.LVL49:
 966:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 585              		.loc 1 966 0
 586 0020 2046     		mov	r0, r4
 587 0022 FFF7FEFF 		bl	tcp_seg_free
 588              	.LVL50:
 965:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_seg_free(old_seg);
 589              		.loc 1 965 0
 590 0026 3446     		mov	r4, r6
 591              	.LVL51:
 592              	.L50:
 957:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            TCP_SEQ_GEQ((seqno + cseg->len),
 593              		.loc 1 957 0
 594 0028 C4B1     		cbz	r4, .L53
 958:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       (next->tcphdr->seqno + next->len))) {
 595              		.loc 1 958 0 discriminator 1
 596 002a 2B89     		ldrh	r3, [r5, #8]
 597 002c 144A     		ldr	r2, .L56
 598 002e 1268     		ldr	r2, [r2]
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 44


 599 0030 1344     		add	r3, r3, r2
 600 0032 E168     		ldr	r1, [r4, #12]
 601 0034 4A68     		ldr	r2, [r1, #4]	@ unaligned
 602 0036 2089     		ldrh	r0, [r4, #8]
 603 0038 0244     		add	r2, r2, r0
 604 003a 9B1A     		subs	r3, r3, r2
 957:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            TCP_SEQ_GEQ((seqno + cseg->len),
 605              		.loc 1 957 0 discriminator 1
 606 003c 002B     		cmp	r3, #0
 607 003e 0DDB     		blt	.L53
 961:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCPH_SET_FLAG(cseg->tcphdr, TCP_FIN);
 608              		.loc 1 961 0
 609 0040 8889     		ldrh	r0, [r1, #12]	@ unaligned
 610 0042 FFF7FEFF 		bl	lwip_htons
 611              	.LVL52:
 612 0046 10F0010F 		tst	r0, #1
 613 004a E8D0     		beq	.L52
 962:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 614              		.loc 1 962 0
 615 004c EF68     		ldr	r7, [r5, #12]
 616 004e BE89     		ldrh	r6, [r7, #12]	@ unaligned
 617 0050 0120     		movs	r0, #1
 618 0052 FFF7FEFF 		bl	lwip_htons
 619              	.LVL53:
 620 0056 3043     		orrs	r0, r0, r6
 621 0058 B881     		strh	r0, [r7, #12]	@ unaligned
 622 005a E0E7     		b	.L52
 623              	.L53:
 968:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCP_SEQ_GT(seqno + cseg->len, next->tcphdr->seqno)) {
 624              		.loc 1 968 0
 625 005c 74B1     		cbz	r4, .L51
 969:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* We need to trim the incoming segment. */
 626              		.loc 1 969 0 discriminator 1
 627 005e 2B89     		ldrh	r3, [r5, #8]
 628 0060 074A     		ldr	r2, .L56
 629 0062 1168     		ldr	r1, [r2]
 630 0064 0B44     		add	r3, r3, r1
 631 0066 E268     		ldr	r2, [r4, #12]
 632 0068 5268     		ldr	r2, [r2, #4]	@ unaligned
 633 006a 9B1A     		subs	r3, r3, r2
 968:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCP_SEQ_GT(seqno + cseg->len, next->tcphdr->seqno)) {
 634              		.loc 1 968 0 discriminator 1
 635 006c 002B     		cmp	r3, #0
 636 006e 05DD     		ble	.L51
 971:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pbuf_realloc(cseg->p, cseg->len);
 637              		.loc 1 971 0
 638 0070 521A     		subs	r2, r2, r1
 639 0072 91B2     		uxth	r1, r2
 640 0074 2981     		strh	r1, [r5, #8]	@ movhi
 972:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 641              		.loc 1 972 0
 642 0076 6868     		ldr	r0, [r5, #4]
 643 0078 FFF7FEFF 		bl	pbuf_realloc
 644              	.LVL54:
 645              	.L51:
 975:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 646              		.loc 1 975 0
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 45


 647 007c 2C60     		str	r4, [r5]
 648 007e F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 649              	.LVL55:
 650              	.L57:
 651              		.align	2
 652              	.L56:
 653 0080 00000000 		.word	.LANCHOR6
 654              		.cfi_endproc
 655              	.LFE140:
 657              		.section	.text.tcp_receive,"ax",%progbits
 658              		.align	1
 659              		.syntax unified
 660              		.thumb
 661              		.thumb_func
 662              		.fpu fpv5-sp-d16
 664              	tcp_receive:
 665              	.LFB141:
 993:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_seg *next;
 666              		.loc 1 993 0
 667              		.cfi_startproc
 668              		@ args = 0, pretend = 0, frame = 0
 669              		@ frame_needed = 0, uses_anonymous_args = 0
 670              	.LVL56:
 671 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 672              	.LCFI14:
 673              		.cfi_def_cfa_offset 24
 674              		.cfi_offset 4, -24
 675              		.cfi_offset 5, -20
 676              		.cfi_offset 6, -16
 677              		.cfi_offset 7, -12
 678              		.cfi_offset 8, -8
 679              		.cfi_offset 14, -4
 680 0004 0446     		mov	r4, r0
 681              	.LVL57:
1008:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 682              		.loc 1 1008 0
 683 0006 057D     		ldrb	r5, [r0, #20]	@ zero_extendqisi2
1010:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     right_wnd_edge = pcb->snd_wnd + pcb->snd_wl2;
 684              		.loc 1 1010 0
 685 0008 9E4B     		ldr	r3, .L184
 686 000a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 687 000c 13F0100F 		tst	r3, #16
 688 0010 00F05381 		beq	.L59
1011:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 689              		.loc 1 1011 0
 690 0014 B0F85C00 		ldrh	r0, [r0, #92]
 691              	.LVL58:
 692 0018 626D     		ldr	r2, [r4, #84]
 693 001a 8718     		adds	r7, r0, r2
 694              	.LVL59:
1014:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        (pcb->snd_wl1 == seqno && TCP_SEQ_LT(pcb->snd_wl2, ackno)) ||
 695              		.loc 1 1014 0
 696 001c 216D     		ldr	r1, [r4, #80]
 697 001e 9A4B     		ldr	r3, .L184+4
 698 0020 1B68     		ldr	r3, [r3]
 699 0022 CE1A     		subs	r6, r1, r3
 700 0024 002E     		cmp	r6, #0
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 46


 701 0026 20DB     		blt	.L60
1014:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        (pcb->snd_wl1 == seqno && TCP_SEQ_LT(pcb->snd_wl2, ackno)) ||
 702              		.loc 1 1014 0 is_stmt 0 discriminator 1
 703 0028 9942     		cmp	r1, r3
 704 002a 13D0     		beq	.L157
 705              	.L61:
1016:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wnd = SND_WND_SCALE(pcb, tcphdr->wnd);
 706              		.loc 1 1016 0 is_stmt 1 discriminator 1
 707 002c 9749     		ldr	r1, .L184+8
 708 002e 0968     		ldr	r1, [r1]
1015:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        (pcb->snd_wl2 == ackno && (u32_t)SND_WND_SCALE(pcb, tcphdr->wnd) > pcb->snd_wnd)) {
 709              		.loc 1 1015 0 discriminator 1
 710 0030 8A42     		cmp	r2, r1
 711 0032 15D0     		beq	.L158
 712              	.L62:
1068:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Clause 2 */
 713              		.loc 1 1068 0
 714 0034 954B     		ldr	r3, .L184+8
 715 0036 1B68     		ldr	r3, [r3]
 716 0038 616C     		ldr	r1, [r4, #68]
 717 003a 5A1A     		subs	r2, r3, r1
 718 003c 002A     		cmp	r2, #0
 719 003e 37DD     		ble	.L159
1100:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* We come here when the ACK acknowledges new data. */
 720              		.loc 1 1100 0
 721 0040 012A     		cmp	r2, #1
 722 0042 03D4     		bmi	.L70
1100:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* We come here when the ACK acknowledges new data. */
 723              		.loc 1 1100 0 is_stmt 0 discriminator 1
 724 0044 E26C     		ldr	r2, [r4, #76]
 725 0046 9A1A     		subs	r2, r3, r2
 726 0048 002A     		cmp	r2, #0
 727 004a 6FDD     		ble	.L160
 728              	.L70:
1189:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 729              		.loc 1 1189 0 is_stmt 1
 730 004c 2046     		mov	r0, r4
 731 004e FFF7FEFF 		bl	tcp_send_empty_ack
 732              	.LVL60:
 733 0052 02E1     		b	.L80
 734              	.L157:
1015:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****        (pcb->snd_wl2 == ackno && (u32_t)SND_WND_SCALE(pcb, tcphdr->wnd) > pcb->snd_wnd)) {
 735              		.loc 1 1015 0
 736 0054 8D49     		ldr	r1, .L184+8
 737 0056 0968     		ldr	r1, [r1]
 738 0058 511A     		subs	r1, r2, r1
 739 005a 0029     		cmp	r1, #0
 740 005c E6DA     		bge	.L61
 741 005e 04E0     		b	.L60
 742              	.L158:
1016:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wnd = SND_WND_SCALE(pcb, tcphdr->wnd);
 743              		.loc 1 1016 0
 744 0060 8B4A     		ldr	r2, .L184+12
 745 0062 1268     		ldr	r2, [r2]
 746 0064 D289     		ldrh	r2, [r2, #14]	@ unaligned
 747 0066 9042     		cmp	r0, r2
 748 0068 E4D2     		bcs	.L62
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 47


 749              	.L60:
1017:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* keep track of the biggest window announced by the remote host to calculate
 750              		.loc 1 1017 0
 751 006a 894A     		ldr	r2, .L184+12
 752 006c 1268     		ldr	r2, [r2]
 753 006e D289     		ldrh	r2, [r2, #14]	@ unaligned
 754 0070 91B2     		uxth	r1, r2
 755 0072 A4F85C20 		strh	r2, [r4, #92]	@ movhi
1020:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->snd_wnd_max = pcb->snd_wnd;
 756              		.loc 1 1020 0
 757 0076 B4F85E00 		ldrh	r0, [r4, #94]
 758 007a 8142     		cmp	r1, r0
 759 007c 01D9     		bls	.L63
1021:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 760              		.loc 1 1021 0
 761 007e A4F85E20 		strh	r2, [r4, #94]	@ movhi
 762              	.L63:
1023:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wl2 = ackno;
 763              		.loc 1 1023 0
 764 0082 2365     		str	r3, [r4, #80]
1024:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (pcb->snd_wnd == 0) {
 765              		.loc 1 1024 0
 766 0084 814B     		ldr	r3, .L184+8
 767 0086 1B68     		ldr	r3, [r3]
 768 0088 6365     		str	r3, [r4, #84]
1025:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (pcb->persist_backoff == 0) {
 769              		.loc 1 1025 0
 770 008a 49B9     		cbnz	r1, .L64
1026:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* start persist timer */
 771              		.loc 1 1026 0
 772 008c 94F89530 		ldrb	r3, [r4, #149]	@ zero_extendqisi2
 773 0090 002B     		cmp	r3, #0
 774 0092 CFD1     		bne	.L62
1028:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->persist_backoff = 1;
 775              		.loc 1 1028 0
 776 0094 84F89430 		strb	r3, [r4, #148]
1029:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 777              		.loc 1 1029 0
 778 0098 0123     		movs	r3, #1
 779 009a 84F89530 		strb	r3, [r4, #149]
 780 009e C9E7     		b	.L62
 781              	.L64:
1031:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* stop persist timer */
 782              		.loc 1 1031 0
 783 00a0 94F89530 		ldrb	r3, [r4, #149]	@ zero_extendqisi2
 784 00a4 002B     		cmp	r3, #0
 785 00a6 C5D0     		beq	.L62
1033:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 786              		.loc 1 1033 0
 787 00a8 0023     		movs	r3, #0
 788 00aa 84F89530 		strb	r3, [r4, #149]
 789 00ae C1E7     		b	.L62
 790              	.L159:
1070:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Clause 3 */
 791              		.loc 1 1070 0
 792 00b0 784A     		ldr	r2, .L184+16
 793 00b2 1288     		ldrh	r2, [r2]
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 48


 794 00b4 7ABB     		cbnz	r2, .L137
1072:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Clause 4 */
 795              		.loc 1 1072 0
 796 00b6 626D     		ldr	r2, [r4, #84]
 797 00b8 B4F85C00 		ldrh	r0, [r4, #92]
 798 00bc 0244     		add	r2, r2, r0
 799 00be 9742     		cmp	r7, r2
 800 00c0 01D0     		beq	.L161
1002:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_OOSEQ_MAX_BYTES || TCP_OOSEQ_MAX_PBUFS
 801              		.loc 1 1002 0
 802 00c2 0023     		movs	r3, #0
 803 00c4 28E0     		b	.L66
 804              	.L161:
1074:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Clause 5 */
 805              		.loc 1 1074 0
 806 00c6 B4F93020 		ldrsh	r2, [r4, #48]
 807 00ca 002A     		cmp	r2, #0
 808 00cc 2ADB     		blt	.L139
1076:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               found_dupack = 1;
 809              		.loc 1 1076 0
 810 00ce 8B42     		cmp	r3, r1
 811 00d0 01D0     		beq	.L162
1002:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_OOSEQ_MAX_BYTES || TCP_OOSEQ_MAX_PBUFS
 812              		.loc 1 1002 0
 813 00d2 0023     		movs	r3, #0
 814 00d4 20E0     		b	.L66
 815              	.L162:
 816              	.LVL61:
1078:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 ++pcb->dupacks;
 817              		.loc 1 1078 0
 818 00d6 94F84320 		ldrb	r2, [r4, #67]	@ zero_extendqisi2
 819 00da 531C     		adds	r3, r2, #1
 820 00dc DBB2     		uxtb	r3, r3
 821 00de 9A42     		cmp	r2, r3
 822 00e0 01D2     		bcs	.L67
1079:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
 823              		.loc 1 1079 0
 824 00e2 84F84330 		strb	r3, [r4, #67]
 825              	.L67:
1081:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 /* Inflate the congestion window, but not if it means that
 826              		.loc 1 1081 0
 827 00e6 94F84330 		ldrb	r3, [r4, #67]	@ zero_extendqisi2
 828 00ea 032B     		cmp	r3, #3
 829 00ec 0AD9     		bls	.L68
1084:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   pcb->cwnd += pcb->mss;
 830              		.loc 1 1084 0
 831 00ee B4F84820 		ldrh	r2, [r4, #72]
 832 00f2 638E     		ldrh	r3, [r4, #50]
 833 00f4 1344     		add	r3, r3, r2
 834 00f6 9BB2     		uxth	r3, r3
 835 00f8 9A42     		cmp	r2, r3
 836 00fa 15D2     		bcs	.L141
1085:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 }
 837              		.loc 1 1085 0
 838 00fc A4F84830 		strh	r3, [r4, #72]	@ movhi
1077:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if ((u8_t)(pcb->dupacks + 1) > pcb->dupacks) {
 839              		.loc 1 1077 0
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 49


 840 0100 0123     		movs	r3, #1
 841 0102 09E0     		b	.L66
 842              	.L68:
1087:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 /* Do fast retransmit */
 843              		.loc 1 1087 0
 844 0104 032B     		cmp	r3, #3
 845 0106 01D0     		beq	.L163
1077:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if ((u8_t)(pcb->dupacks + 1) > pcb->dupacks) {
 846              		.loc 1 1077 0
 847 0108 0123     		movs	r3, #1
 848 010a 05E0     		b	.L66
 849              	.L163:
1089:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
 850              		.loc 1 1089 0
 851 010c 2046     		mov	r0, r4
 852 010e FFF7FEFF 		bl	tcp_rexmit_fast
 853              	.LVL62:
1077:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if ((u8_t)(pcb->dupacks + 1) > pcb->dupacks) {
 854              		.loc 1 1077 0
 855 0112 0123     		movs	r3, #1
 856 0114 00E0     		b	.L66
 857              	.LVL63:
 858              	.L137:
1002:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_OOSEQ_MAX_BYTES || TCP_OOSEQ_MAX_PBUFS
 859              		.loc 1 1002 0
 860 0116 0023     		movs	r3, #0
 861              	.LVL64:
 862              	.L66:
1097:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->dupacks = 0;
 863              		.loc 1 1097 0
 864 0118 002B     		cmp	r3, #0
 865 011a 40F09E80 		bne	.L80
1098:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 866              		.loc 1 1098 0
 867 011e 84F84330 		strb	r3, [r4, #67]
 868 0122 9AE0     		b	.L80
 869              	.LVL65:
 870              	.L139:
1002:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_OOSEQ_MAX_BYTES || TCP_OOSEQ_MAX_PBUFS
 871              		.loc 1 1002 0
 872 0124 0023     		movs	r3, #0
 873 0126 F7E7     		b	.L66
 874              	.LVL66:
 875              	.L141:
1077:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if ((u8_t)(pcb->dupacks + 1) > pcb->dupacks) {
 876              		.loc 1 1077 0
 877 0128 0123     		movs	r3, #1
 878 012a F5E7     		b	.L66
 879              	.LVL67:
 880              	.L160:
1106:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->flags &= ~TF_INFR;
 881              		.loc 1 1106 0
 882 012c A27E     		ldrb	r2, [r4, #26]	@ zero_extendqisi2
 883 012e 12F0040F 		tst	r2, #4
 884 0132 06D0     		beq	.L71
1107:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->cwnd = pcb->ssthresh;
 885              		.loc 1 1107 0
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 50


 886 0134 22F00402 		bic	r2, r2, #4
 887 0138 A276     		strb	r2, [r4, #26]
1108:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 888              		.loc 1 1108 0
 889 013a B4F84A20 		ldrh	r2, [r4, #74]
 890 013e A4F84820 		strh	r2, [r4, #72]	@ movhi
 891              	.L71:
1112:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 892              		.loc 1 1112 0
 893 0142 0021     		movs	r1, #0
 894 0144 84F84210 		strb	r1, [r4, #66]
1115:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 895              		.loc 1 1115 0
 896 0148 B4F93C00 		ldrsh	r0, [r4, #60]
 897 014c E28F     		ldrh	r2, [r4, #62]
 898 014e 02EBE002 		add	r2, r2, r0, asr #3
 899 0152 A4F84020 		strh	r2, [r4, #64]	@ movhi
1118:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->lastack = ackno;
 900              		.loc 1 1118 0
 901 0156 84F84310 		strb	r1, [r4, #67]
1119:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 902              		.loc 1 1119 0
 903 015a 6364     		str	r3, [r4, #68]
1123:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (pcb->cwnd < pcb->ssthresh) {
 904              		.loc 1 1123 0
 905 015c 032D     		cmp	r5, #3
 906 015e 38D9     		bls	.L74
1124:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if ((tcpwnd_size_t)(pcb->cwnd + pcb->mss) > pcb->cwnd) {
 907              		.loc 1 1124 0
 908 0160 B4F84820 		ldrh	r2, [r4, #72]
 909 0164 B4F84A30 		ldrh	r3, [r4, #74]
 910 0168 9A42     		cmp	r2, r3
 911 016a 07D2     		bcs	.L73
1125:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             pcb->cwnd += pcb->mss;
 912              		.loc 1 1125 0
 913 016c 638E     		ldrh	r3, [r4, #50]
 914 016e 1344     		add	r3, r3, r2
 915 0170 9BB2     		uxth	r3, r3
 916 0172 9A42     		cmp	r2, r3
 917 0174 2DD2     		bcs	.L74
1126:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 918              		.loc 1 1126 0
 919 0176 A4F84830 		strh	r3, [r4, #72]	@ movhi
 920 017a 2AE0     		b	.L74
 921              	.L73:
 922              	.LBB6:
1130:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (new_cwnd > pcb->cwnd) {
 923              		.loc 1 1130 0
 924 017c 638E     		ldrh	r3, [r4, #50]
 925 017e 03FB03F3 		mul	r3, r3, r3
 926 0182 93FBF2F3 		sdiv	r3, r3, r2
 927 0186 12FA83F3 		uxtah	r3, r2, r3
 928 018a 9BB2     		uxth	r3, r3
 929              	.LVL68:
1131:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             pcb->cwnd = new_cwnd;
 930              		.loc 1 1131 0
 931 018c 9A42     		cmp	r2, r3
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 51


 932 018e 20D2     		bcs	.L74
1132:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 933              		.loc 1 1132 0
 934 0190 A4F84830 		strh	r3, [r4, #72]	@ movhi
 935 0194 1DE0     		b	.L74
 936              	.LVL69:
 937              	.L143:
 938              	.LBE6:
1147:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                          TCP_TCPLEN(pcb->unacked), ackno)) {
 939              		.loc 1 1147 0
 940 0196 0023     		movs	r3, #0
 941              	.L76:
1147:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                          TCP_TCPLEN(pcb->unacked), ackno)) {
 942              		.loc 1 1147 0 is_stmt 0 discriminator 4
 943 0198 3344     		add	r3, r3, r6
 944 019a 1D44     		add	r5, r5, r3
 945 019c 3B4B     		ldr	r3, .L184+8
 946 019e 1B68     		ldr	r3, [r3]
 947 01a0 ED1A     		subs	r5, r5, r3
1146:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              TCP_SEQ_LEQ(lwip_ntohl(pcb->unacked->tcphdr->seqno) +
 948              		.loc 1 1146 0 is_stmt 1 discriminator 4
 949 01a2 002D     		cmp	r5, #0
 950 01a4 27DC     		bgt	.L75
1154:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->unacked = pcb->unacked->next;
 951              		.loc 1 1154 0
 952 01a6 E56E     		ldr	r5, [r4, #108]
 953              	.LVL70:
1155:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 954              		.loc 1 1155 0
 955 01a8 2B68     		ldr	r3, [r5]
 956 01aa E366     		str	r3, [r4, #108]
1158:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 957              		.loc 1 1158 0
 958 01ac 6868     		ldr	r0, [r5, #4]
 959 01ae FFF7FEFF 		bl	pbuf_clen
 960              	.LVL71:
1160:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         recv_acked += next->len;
 961              		.loc 1 1160 0
 962 01b2 6868     		ldr	r0, [r5, #4]
 963 01b4 FFF7FEFF 		bl	pbuf_clen
 964              	.LVL72:
 965 01b8 B4F86230 		ldrh	r3, [r4, #98]
 966 01bc 181A     		subs	r0, r3, r0
 967 01be A4F86200 		strh	r0, [r4, #98]	@ movhi
1161:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_seg_free(next);
 968              		.loc 1 1161 0
 969 01c2 2B89     		ldrh	r3, [r5, #8]
 970 01c4 344A     		ldr	r2, .L184+20
 971 01c6 1188     		ldrh	r1, [r2]
 972 01c8 0B44     		add	r3, r3, r1
 973 01ca 1380     		strh	r3, [r2]	@ movhi
1162:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 974              		.loc 1 1162 0
 975 01cc 2846     		mov	r0, r5
 976 01ce FFF7FEFF 		bl	tcp_seg_free
 977              	.LVL73:
 978              	.L74:
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 52


1146:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****              TCP_SEQ_LEQ(lwip_ntohl(pcb->unacked->tcphdr->seqno) +
 979              		.loc 1 1146 0
 980 01d2 E36E     		ldr	r3, [r4, #108]
 981 01d4 7BB1     		cbz	r3, .L75
1147:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                          TCP_TCPLEN(pcb->unacked), ackno)) {
 982              		.loc 1 1147 0
 983 01d6 DB68     		ldr	r3, [r3, #12]
 984 01d8 5868     		ldr	r0, [r3, #4]	@ unaligned
 985 01da FFF7FEFF 		bl	lwip_htonl
 986              	.LVL74:
 987 01de 0546     		mov	r5, r0
 988 01e0 E36E     		ldr	r3, [r4, #108]
 989 01e2 1E89     		ldrh	r6, [r3, #8]
 990 01e4 DB68     		ldr	r3, [r3, #12]
 991 01e6 9889     		ldrh	r0, [r3, #12]	@ unaligned
 992 01e8 FFF7FEFF 		bl	lwip_htons
 993              	.LVL75:
 994 01ec 10F0030F 		tst	r0, #3
 995 01f0 D1D0     		beq	.L143
 996 01f2 0123     		movs	r3, #1
 997 01f4 D0E7     		b	.L76
 998              	.L75:
1173:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->rtime = -1;
 999              		.loc 1 1173 0
 1000 01f6 E36E     		ldr	r3, [r4, #108]
 1001 01f8 23B1     		cbz	r3, .L164
1176:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 1002              		.loc 1 1176 0
 1003 01fa 0023     		movs	r3, #0
 1004 01fc 2386     		strh	r3, [r4, #48]	@ movhi
 1005              	.L79:
1179:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1006              		.loc 1 1179 0
 1007 01fe 0023     		movs	r3, #0
 1008 0200 E376     		strb	r3, [r4, #27]
 1009 0202 2AE0     		b	.L80
 1010              	.L164:
1174:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 1011              		.loc 1 1174 0
 1012 0204 4FF6FF73 		movw	r3, #65535
 1013 0208 2386     		strh	r3, [r4, #48]	@ movhi
 1014 020a F8E7     		b	.L79
 1015              	.LVL76:
 1016              	.L165:
1209:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 1017              		.loc 1 1209 0
 1018 020c A4F86430 		strh	r3, [r4, #100]	@ movhi
 1019 0210 10E0     		b	.L81
 1020              	.LVL77:
 1021              	.L144:
1199:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                            TCP_TCPLEN(pcb->unsent), pcb->snd_nxt)) {
 1022              		.loc 1 1199 0
 1023 0212 0023     		movs	r3, #0
 1024              	.L83:
1199:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                            TCP_TCPLEN(pcb->unsent), pcb->snd_nxt)) {
 1025              		.loc 1 1199 0 is_stmt 0 discriminator 4
 1026 0214 3B44     		add	r3, r3, r7
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 53


 1027 0216 1E44     		add	r6, r6, r3
 1028 0218 AD1B     		subs	r5, r5, r6
1198:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            TCP_SEQ_BETWEEN(ackno, lwip_ntohl(pcb->unsent->tcphdr->seqno) +
 1029              		.loc 1 1198 0 is_stmt 1 discriminator 4
 1030 021a 002D     		cmp	r5, #0
 1031 021c 3EDB     		blt	.L82
1199:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                            TCP_TCPLEN(pcb->unsent), pcb->snd_nxt)) {
 1032              		.loc 1 1199 0
 1033 021e 1B4B     		ldr	r3, .L184+8
 1034 0220 1B68     		ldr	r3, [r3]
 1035 0222 E26C     		ldr	r2, [r4, #76]
 1036 0224 9B1A     		subs	r3, r3, r2
 1037 0226 002B     		cmp	r3, #0
 1038 0228 38DC     		bgt	.L82
1205:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->unsent = pcb->unsent->next;
 1039              		.loc 1 1205 0
 1040 022a A56E     		ldr	r5, [r4, #104]
 1041              	.LVL78:
1206:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_OVERSIZE
 1042              		.loc 1 1206 0
 1043 022c 2B68     		ldr	r3, [r5]
 1044 022e A366     		str	r3, [r4, #104]
1208:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->unsent_oversize = 0;
 1045              		.loc 1 1208 0
 1046 0230 002B     		cmp	r3, #0
 1047 0232 EBD0     		beq	.L165
 1048              	.L81:
1213:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Prevent ACK for FIN to generate a sent event */
 1049              		.loc 1 1213 0
 1050 0234 6868     		ldr	r0, [r5, #4]
 1051 0236 FFF7FEFF 		bl	pbuf_clen
 1052              	.LVL79:
1215:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       recv_acked += next->len;
 1053              		.loc 1 1215 0
 1054 023a 6868     		ldr	r0, [r5, #4]
 1055 023c FFF7FEFF 		bl	pbuf_clen
 1056              	.LVL80:
 1057 0240 B4F86230 		ldrh	r3, [r4, #98]
 1058 0244 181A     		subs	r0, r3, r0
 1059 0246 A4F86200 		strh	r0, [r4, #98]	@ movhi
1216:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_seg_free(next);
 1060              		.loc 1 1216 0
 1061 024a 2B89     		ldrh	r3, [r5, #8]
 1062 024c 124A     		ldr	r2, .L184+20
 1063 024e 1188     		ldrh	r1, [r2]
 1064 0250 0B44     		add	r3, r3, r1
 1065 0252 1380     		strh	r3, [r2]	@ movhi
1217:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_QLEN_DEBUG, ("%"TCPWNDSIZE_F" (after freeing unsent)\n", (tcpwnd_size_t)pcb->
 1066              		.loc 1 1217 0
 1067 0254 2846     		mov	r0, r5
 1068 0256 FFF7FEFF 		bl	tcp_seg_free
 1069              	.LVL81:
 1070              	.L80:
1198:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****            TCP_SEQ_BETWEEN(ackno, lwip_ntohl(pcb->unsent->tcphdr->seqno) +
 1071              		.loc 1 1198 0
 1072 025a A36E     		ldr	r3, [r4, #104]
 1073 025c F3B1     		cbz	r3, .L82
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 54


1199:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                            TCP_TCPLEN(pcb->unsent), pcb->snd_nxt)) {
 1074              		.loc 1 1199 0
 1075 025e 0B4A     		ldr	r2, .L184+8
 1076 0260 1568     		ldr	r5, [r2]
 1077 0262 DB68     		ldr	r3, [r3, #12]
 1078 0264 5868     		ldr	r0, [r3, #4]	@ unaligned
 1079 0266 FFF7FEFF 		bl	lwip_htonl
 1080              	.LVL82:
 1081 026a 0646     		mov	r6, r0
 1082 026c A36E     		ldr	r3, [r4, #104]
 1083 026e 1F89     		ldrh	r7, [r3, #8]
 1084 0270 DB68     		ldr	r3, [r3, #12]
 1085 0272 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1086 0274 FFF7FEFF 		bl	lwip_htons
 1087              	.LVL83:
 1088 0278 10F0030F 		tst	r0, #3
 1089 027c C9D0     		beq	.L144
 1090 027e 0123     		movs	r3, #1
 1091 0280 C8E7     		b	.L83
 1092              	.L185:
 1093 0282 00BF     		.align	2
 1094              	.L184:
 1095 0284 00000000 		.word	.LANCHOR5
 1096 0288 00000000 		.word	.LANCHOR6
 1097 028c 00000000 		.word	.LANCHOR8
 1098 0290 00000000 		.word	.LANCHOR3
 1099 0294 00000000 		.word	.LANCHOR7
 1100 0298 00000000 		.word	.LANCHOR9
 1101              	.L82:
1224:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* End of ACK for new data processing. */
 1102              		.loc 1 1224 0
 1103 029c B4F86030 		ldrh	r3, [r4, #96]
 1104 02a0 954A     		ldr	r2, .L186
 1105 02a2 1288     		ldrh	r2, [r2]
 1106 02a4 1344     		add	r3, r3, r2
 1107 02a6 A4F86030 		strh	r3, [r4, #96]	@ movhi
1233:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* diff between this shouldn't exceed 32K since this are tcp timer ticks
 1108              		.loc 1 1233 0
 1109 02aa 636B     		ldr	r3, [r4, #52]
 1110 02ac 2BB1     		cbz	r3, .L59
1233:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* diff between this shouldn't exceed 32K since this are tcp timer ticks
 1111              		.loc 1 1233 0 is_stmt 0 discriminator 1
 1112 02ae A26B     		ldr	r2, [r4, #56]
 1113 02b0 9249     		ldr	r1, .L186+4
 1114 02b2 0968     		ldr	r1, [r1]
 1115 02b4 521A     		subs	r2, r2, r1
 1116 02b6 002A     		cmp	r2, #0
 1117 02b8 27DB     		blt	.L166
 1118              	.L59:
1262:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* This code basically does three things:
 1119              		.loc 1 1262 0 is_stmt 1
 1120 02ba 914B     		ldr	r3, .L186+8
 1121 02bc 1B88     		ldrh	r3, [r3]
 1122 02be 002B     		cmp	r3, #0
 1123 02c0 00F0AA82 		beq	.L86
1262:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* This code basically does three things:
 1124              		.loc 1 1262 0 is_stmt 0 discriminator 1
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 55


 1125 02c4 227D     		ldrb	r2, [r4, #20]	@ zero_extendqisi2
 1126 02c6 062A     		cmp	r2, #6
 1127 02c8 00F2A682 		bhi	.L86
1293:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Trimming the first edge is done by pushing the payload
 1128              		.loc 1 1293 0 is_stmt 1
 1129 02cc 616A     		ldr	r1, [r4, #36]
 1130 02ce 8D4A     		ldr	r2, .L186+12
 1131 02d0 1268     		ldr	r2, [r2]
 1132 02d2 8D1A     		subs	r5, r1, r2
 1133 02d4 012D     		cmp	r5, #1
 1134 02d6 04D4     		bmi	.L87
1293:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Trimming the first edge is done by pushing the payload
 1135              		.loc 1 1293 0 is_stmt 0 discriminator 1
 1136 02d8 1344     		add	r3, r3, r2
 1137 02da CB1A     		subs	r3, r1, r3
 1138 02dc 0133     		adds	r3, r3, #1
 1139 02de 002B     		cmp	r3, #0
 1140 02e0 34DD     		ble	.L167
 1141              	.L87:
1344:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* the whole segment is < rcv_nxt */
 1142              		.loc 1 1344 0 is_stmt 1
 1143 02e2 521A     		subs	r2, r2, r1
 1144 02e4 002A     		cmp	r2, #0
 1145 02e6 5ADB     		blt	.L168
 1146              	.L92:
1356:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                         pcb->rcv_nxt + pcb->rcv_wnd - 1)) {
 1147              		.loc 1 1356 0
 1148 02e8 864B     		ldr	r3, .L186+12
 1149 02ea 1968     		ldr	r1, [r3]
 1150 02ec 626A     		ldr	r2, [r4, #36]
 1151 02ee 8B1A     		subs	r3, r1, r2
 1152 02f0 002B     		cmp	r3, #0
 1153 02f2 05DB     		blt	.L93
1356:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                         pcb->rcv_nxt + pcb->rcv_wnd - 1)) {
 1154              		.loc 1 1356 0 is_stmt 0 discriminator 1
 1155 02f4 238D     		ldrh	r3, [r4, #40]
 1156 02f6 1344     		add	r3, r3, r2
 1157 02f8 CB1A     		subs	r3, r1, r3
 1158 02fa 0133     		adds	r3, r3, #1
 1159 02fc 002B     		cmp	r3, #0
 1160 02fe 53DD     		ble	.L169
 1161              	.L93:
1673:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 1162              		.loc 1 1673 0 is_stmt 1
 1163 0300 2046     		mov	r0, r4
 1164 0302 FFF7FEFF 		bl	tcp_send_empty_ack
 1165              	.LVL84:
 1166 0306 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1167              	.LVL85:
 1168              	.L166:
1236:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1169              		.loc 1 1236 0
 1170 030a 7F4A     		ldr	r2, .L186+16
 1171 030c 1268     		ldr	r2, [r2]
 1172 030e D21A     		subs	r2, r2, r3
 1173 0310 92B2     		uxth	r2, r2
 1174              	.LVL86:
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 56


1242:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->sa += m;
 1175              		.loc 1 1242 0
 1176 0312 B4F93C10 		ldrsh	r1, [r4, #60]
 1177 0316 A2EBE102 		sub	r2, r2, r1, asr #3
 1178              	.LVL87:
 1179 031a 92B2     		uxth	r2, r2
 1180 031c 13B2     		sxth	r3, r2
 1181              	.LVL88:
1243:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (m < 0) {
 1182              		.loc 1 1243 0
 1183 031e 1144     		add	r1, r1, r2
 1184 0320 09B2     		sxth	r1, r1
 1185 0322 A187     		strh	r1, [r4, #60]	@ movhi
1244:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         m = -m;
 1186              		.loc 1 1244 0
 1187 0324 002B     		cmp	r3, #0
 1188 0326 0EDB     		blt	.L170
 1189              	.L85:
1247:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->sv += m;
 1190              		.loc 1 1247 0
 1191 0328 B4F93E20 		ldrsh	r2, [r4, #62]
 1192 032c A3EBA203 		sub	r3, r3, r2, asr #2
 1193              	.LVL89:
1248:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->rto = (pcb->sa >> 3) + pcb->sv;
 1194              		.loc 1 1248 0
 1195 0330 12FA83F3 		uxtah	r3, r2, r3
 1196              	.LVL90:
 1197 0334 9BB2     		uxth	r3, r3
 1198 0336 E387     		strh	r3, [r4, #62]	@ movhi
1249:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1199              		.loc 1 1249 0
 1200 0338 03EBE103 		add	r3, r3, r1, asr #3
 1201 033c A4F84030 		strh	r3, [r4, #64]	@ movhi
1254:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 1202              		.loc 1 1254 0
 1203 0340 0023     		movs	r3, #0
 1204 0342 6363     		str	r3, [r4, #52]
 1205 0344 B9E7     		b	.L59
 1206              	.LVL91:
 1207              	.L170:
1245:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 1208              		.loc 1 1245 0
 1209 0346 5342     		negs	r3, r2
 1210              	.LVL92:
 1211 0348 1BB2     		sxth	r3, r3
 1212              	.LVL93:
 1213 034a EDE7     		b	.L85
 1214              	.LVL94:
 1215              	.L167:
 1216              	.LBB7:
1314:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       off = pcb->rcv_nxt - seqno;
 1217              		.loc 1 1314 0
 1218 034c 6F4B     		ldr	r3, .L186+20
 1219 034e 5868     		ldr	r0, [r3, #4]
 1220              	.LVL95:
1315:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("inseg.p != NULL", inseg.p);
 1221              		.loc 1 1315 0
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 57


 1222 0350 2B46     		mov	r3, r5
 1223              	.LVL96:
1318:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_ASSERT("pbuf too short!", (((s32_t)inseg.p->tot_len) >= off));
 1224              		.loc 1 1318 0
 1225 0352 4289     		ldrh	r2, [r0, #10]
 1226 0354 9542     		cmp	r5, r2
 1227 0356 1DDD     		ble	.L88
1319:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         new_tot_len = (u16_t)(inseg.p->tot_len - off);
 1228              		.loc 1 1319 0
 1229 0358 0189     		ldrh	r1, [r0, #8]
1320:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         while (p->len < off) {
 1230              		.loc 1 1320 0
 1231 035a ADB2     		uxth	r5, r5
 1232 035c 4D1B     		subs	r5, r1, r5
 1233 035e A9B2     		uxth	r1, r5
 1234              	.LVL97:
1321:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           off -= p->len;
 1235              		.loc 1 1321 0
 1236 0360 04E0     		b	.L89
 1237              	.L90:
1322:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* KJM following line changed (with addition of new_tot_len var)
 1238              		.loc 1 1322 0
 1239 0362 9B1A     		subs	r3, r3, r2
 1240              	.LVL98:
1326:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           p->len = 0;
 1241              		.loc 1 1326 0
 1242 0364 0181     		strh	r1, [r0, #8]	@ movhi
1327:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           p = p->next;
 1243              		.loc 1 1327 0
 1244 0366 0022     		movs	r2, #0
 1245 0368 4281     		strh	r2, [r0, #10]	@ movhi
1328:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 1246              		.loc 1 1328 0
 1247 036a 0068     		ldr	r0, [r0]
 1248              	.LVL99:
 1249              	.L89:
1321:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           off -= p->len;
 1250              		.loc 1 1321 0
 1251 036c 4289     		ldrh	r2, [r0, #10]
 1252 036e 9342     		cmp	r3, r2
 1253 0370 F7DC     		bgt	.L90
1330:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Do we need to cope with this failing?  Assert for now */
 1254              		.loc 1 1330 0
 1255 0372 5B42     		negs	r3, r3
 1256              	.LVL100:
 1257 0374 19B2     		sxth	r1, r3
 1258              	.LVL101:
 1259 0376 FFF7FEFF 		bl	pbuf_header
 1260              	.LVL102:
 1261              	.L91:
1340:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       inseg.tcphdr->seqno = seqno = pcb->rcv_nxt;
 1262              		.loc 1 1340 0
 1263 037a 626A     		ldr	r2, [r4, #36]
 1264 037c 6148     		ldr	r0, .L186+12
 1265 037e 0368     		ldr	r3, [r0]
 1266 0380 9B1A     		subs	r3, r3, r2
 1267 0382 6249     		ldr	r1, .L186+20
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 58


 1268 0384 0D89     		ldrh	r5, [r1, #8]
 1269 0386 15FA83F3 		uxtah	r3, r5, r3
 1270 038a 0B81     		strh	r3, [r1, #8]	@ movhi
1341:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 1271              		.loc 1 1341 0
 1272 038c CB68     		ldr	r3, [r1, #12]
 1273 038e 0260     		str	r2, [r0]
 1274 0390 5A60     		str	r2, [r3, #4]	@ unaligned
 1275              	.LBE7:
1293:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Trimming the first edge is done by pushing the payload
 1276              		.loc 1 1293 0
 1277 0392 A9E7     		b	.L92
 1278              	.LVL103:
 1279              	.L88:
 1280              	.LBB8:
1335:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Do we need to cope with this failing?  Assert for now */
 1281              		.loc 1 1335 0
 1282 0394 6942     		negs	r1, r5
 1283 0396 09B2     		sxth	r1, r1
 1284 0398 FFF7FEFF 		bl	pbuf_header
 1285              	.LVL104:
 1286 039c EDE7     		b	.L91
 1287              	.LVL105:
 1288              	.L168:
 1289              	.LBE8:
1349:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 1290              		.loc 1 1349 0
 1291 039e A37E     		ldrb	r3, [r4, #26]	@ zero_extendqisi2
 1292 03a0 43F00203 		orr	r3, r3, #2
 1293 03a4 A376     		strb	r3, [r4, #26]
 1294 03a6 9FE7     		b	.L92
 1295              	.L169:
1358:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* The incoming segment is the next in sequence. We check if
 1296              		.loc 1 1358 0
 1297 03a8 9142     		cmp	r1, r2
 1298 03aa 08D0     		beq	.L171
1522:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ
 1299              		.loc 1 1522 0
 1300 03ac 2046     		mov	r0, r4
 1301 03ae FFF7FEFF 		bl	tcp_send_empty_ack
 1302              	.LVL106:
1525:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->ooseq = tcp_seg_copy(&inseg);
 1303              		.loc 1 1525 0
 1304 03b2 256F     		ldr	r5, [r4, #112]
 1305 03b4 002D     		cmp	r5, #0
 1306 03b6 00F05F81 		beq	.L172
 1307 03ba 0026     		movs	r6, #0
 1308 03bc 81E1     		b	.L125
 1309              	.L171:
1362:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1310              		.loc 1 1362 0
 1311 03be 534B     		ldr	r3, .L186+20
 1312 03c0 1D89     		ldrh	r5, [r3, #8]
 1313 03c2 DB68     		ldr	r3, [r3, #12]
 1314 03c4 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1315 03c6 FFF7FEFF 		bl	lwip_htons
 1316              	.LVL107:
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 59


 1317 03ca 10F0030F 		tst	r0, #3
 1318 03ce 15D0     		beq	.L145
 1319 03d0 0123     		movs	r3, #1
 1320              	.L95:
1362:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1321              		.loc 1 1362 0 is_stmt 0 discriminator 4
 1322 03d2 2B44     		add	r3, r3, r5
 1323 03d4 9BB2     		uxth	r3, r3
 1324 03d6 4A4A     		ldr	r2, .L186+8
 1325 03d8 1380     		strh	r3, [r2]	@ movhi
1364:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_DEBUGF(TCP_INPUT_DEBUG,
 1326              		.loc 1 1364 0 is_stmt 1 discriminator 4
 1327 03da 228D     		ldrh	r2, [r4, #40]
 1328 03dc 9342     		cmp	r3, r2
 1329 03de 0FD8     		bhi	.L173
 1330              	.L96:
1389:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (TCPH_FLAGS(inseg.tcphdr) & TCP_FIN) {
 1331              		.loc 1 1389 0
 1332 03e0 236F     		ldr	r3, [r4, #112]
 1333 03e2 002B     		cmp	r3, #0
 1334 03e4 00F0BF80 		beq	.L100
1390:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             LWIP_DEBUGF(TCP_INPUT_DEBUG,
 1335              		.loc 1 1390 0
 1336 03e8 484B     		ldr	r3, .L186+20
 1337 03ea DB68     		ldr	r3, [r3, #12]
 1338 03ec 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1339 03ee FFF7FEFF 		bl	lwip_htons
 1340              	.LVL108:
 1341 03f2 10F0010F 		tst	r0, #1
 1342 03f6 3CD1     		bne	.L101
1402:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Remove all segments on ooseq that are covered by inseg already.
 1343              		.loc 1 1402 0
 1344 03f8 256F     		ldr	r5, [r4, #112]
 1345              	.LVL109:
1405:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                    TCP_SEQ_GEQ(seqno + tcplen,
 1346              		.loc 1 1405 0
 1347 03fa 4BE0     		b	.L104
 1348              	.LVL110:
 1349              	.L145:
1362:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1350              		.loc 1 1362 0
 1351 03fc 0023     		movs	r3, #0
 1352 03fe E8E7     		b	.L95
 1353              	.L173:
1369:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Must remove the FIN from the header as we're trimming
 1354              		.loc 1 1369 0
 1355 0400 424B     		ldr	r3, .L186+20
 1356 0402 DB68     		ldr	r3, [r3, #12]
 1357 0404 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1358 0406 FFF7FEFF 		bl	lwip_htons
 1359              	.LVL111:
 1360 040a 10F0010F 		tst	r0, #1
 1361 040e 1FD1     		bne	.L174
 1362              	.L97:
1376:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (TCPH_FLAGS(inseg.tcphdr) & TCP_SYN) {
 1363              		.loc 1 1376 0
 1364 0410 228D     		ldrh	r2, [r4, #40]
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 60


 1365 0412 3E4B     		ldr	r3, .L186+20
 1366 0414 1A81     		strh	r2, [r3, #8]	@ movhi
1377:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             inseg.len -= 1;
 1367              		.loc 1 1377 0
 1368 0416 DB68     		ldr	r3, [r3, #12]
 1369 0418 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1370 041a FFF7FEFF 		bl	lwip_htons
 1371              	.LVL112:
 1372 041e 10F0020F 		tst	r0, #2
 1373 0422 03D0     		beq	.L98
1378:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 1374              		.loc 1 1378 0
 1375 0424 394A     		ldr	r2, .L186+20
 1376 0426 1389     		ldrh	r3, [r2, #8]
 1377 0428 013B     		subs	r3, r3, #1
 1378 042a 1381     		strh	r3, [r2, #8]	@ movhi
 1379              	.L98:
1380:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           tcplen = TCP_TCPLEN(&inseg);
 1380              		.loc 1 1380 0
 1381 042c 374D     		ldr	r5, .L186+20
 1382 042e 2989     		ldrh	r1, [r5, #8]
 1383 0430 6868     		ldr	r0, [r5, #4]
 1384 0432 FFF7FEFF 		bl	pbuf_realloc
 1385              	.LVL113:
1381:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("tcp_receive: segment not trimmed correctly to rcv_wnd\n",
 1386              		.loc 1 1381 0
 1387 0436 2E89     		ldrh	r6, [r5, #8]
 1388 0438 EB68     		ldr	r3, [r5, #12]
 1389 043a 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1390 043c FFF7FEFF 		bl	lwip_htons
 1391              	.LVL114:
 1392 0440 10F0030F 		tst	r0, #3
 1393 0444 13D0     		beq	.L146
 1394 0446 0123     		movs	r3, #1
 1395              	.L99:
1381:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("tcp_receive: segment not trimmed correctly to rcv_wnd\n",
 1396              		.loc 1 1381 0 is_stmt 0 discriminator 4
 1397 0448 3344     		add	r3, r3, r6
 1398 044a 2D4A     		ldr	r2, .L186+8
 1399 044c 1380     		strh	r3, [r2]	@ movhi
 1400 044e C7E7     		b	.L96
 1401              	.L174:
1372:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 1402              		.loc 1 1372 0 is_stmt 1
 1403 0450 2E4B     		ldr	r3, .L186+20
 1404 0452 DE68     		ldr	r6, [r3, #12]
 1405 0454 B089     		ldrh	r0, [r6, #12]	@ unaligned
 1406 0456 20F47C55 		bic	r5, r0, #16128
 1407 045a ADB2     		uxth	r5, r5
 1408 045c FFF7FEFF 		bl	lwip_htons
 1409              	.LVL115:
 1410 0460 00F03E00 		and	r0, r0, #62
 1411 0464 FFF7FEFF 		bl	lwip_htons
 1412              	.LVL116:
 1413 0468 2843     		orrs	r0, r0, r5
 1414 046a B081     		strh	r0, [r6, #12]	@ unaligned
 1415 046c D0E7     		b	.L97
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 61


 1416              	.L146:
1381:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("tcp_receive: segment not trimmed correctly to rcv_wnd\n",
 1417              		.loc 1 1381 0
 1418 046e 0023     		movs	r3, #0
 1419 0470 EAE7     		b	.L99
 1420              	.L101:
1396:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               struct tcp_seg *old_ooseq = pcb->ooseq;
 1421              		.loc 1 1396 0
 1422 0472 206F     		ldr	r0, [r4, #112]
 1423 0474 0028     		cmp	r0, #0
 1424 0476 76D0     		beq	.L100
 1425              	.LVL117:
 1426              	.LBB9:
1398:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               tcp_seg_free(old_ooseq);
 1427              		.loc 1 1398 0
 1428 0478 0368     		ldr	r3, [r0]
 1429 047a 2367     		str	r3, [r4, #112]
1399:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
 1430              		.loc 1 1399 0
 1431 047c FFF7FEFF 		bl	tcp_seg_free
 1432              	.LVL118:
 1433 0480 F7E7     		b	.L101
 1434              	.LVL119:
 1435              	.L147:
 1436              	.LBE9:
1412:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
 1437              		.loc 1 1412 0
 1438 0482 0023     		movs	r3, #0
 1439              	.L106:
1412:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
 1440              		.loc 1 1412 0 is_stmt 0 discriminator 4
 1441 0484 3B44     		add	r3, r3, r7
 1442 0486 1E4A     		ldr	r2, .L186+8
 1443 0488 1380     		strh	r3, [r2]	@ movhi
 1444              	.L105:
 1445              	.LVL120:
1415:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               tcp_seg_free(prev);
 1446              		.loc 1 1415 0 is_stmt 1
 1447 048a 2E68     		ldr	r6, [r5]
 1448              	.LVL121:
1416:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
 1449              		.loc 1 1416 0
 1450 048c 2846     		mov	r0, r5
 1451 048e FFF7FEFF 		bl	tcp_seg_free
 1452              	.LVL122:
1415:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               tcp_seg_free(prev);
 1453              		.loc 1 1415 0
 1454 0492 3546     		mov	r5, r6
 1455              	.LVL123:
 1456              	.L104:
1405:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                    TCP_SEQ_GEQ(seqno + tcplen,
 1457              		.loc 1 1405 0
 1458 0494 002D     		cmp	r5, #0
 1459 0496 3BD0     		beq	.L107
1406:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                next->tcphdr->seqno + next->len)) {
 1460              		.loc 1 1406 0 discriminator 1
 1461 0498 194B     		ldr	r3, .L186+8
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 62


 1462 049a 1B88     		ldrh	r3, [r3]
 1463 049c 194A     		ldr	r2, .L186+12
 1464 049e 1268     		ldr	r2, [r2]
 1465 04a0 1344     		add	r3, r3, r2
 1466 04a2 E968     		ldr	r1, [r5, #12]
 1467 04a4 4A68     		ldr	r2, [r1, #4]	@ unaligned
 1468 04a6 2889     		ldrh	r0, [r5, #8]
 1469 04a8 0244     		add	r2, r2, r0
 1470 04aa 9B1A     		subs	r3, r3, r2
1405:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                    TCP_SEQ_GEQ(seqno + tcplen,
 1471              		.loc 1 1405 0 discriminator 1
 1472 04ac 002B     		cmp	r3, #0
 1473 04ae 2FDB     		blt	.L107
1409:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   (TCPH_FLAGS(inseg.tcphdr) & TCP_SYN) == 0) {
 1474              		.loc 1 1409 0
 1475 04b0 8889     		ldrh	r0, [r1, #12]	@ unaligned
 1476 04b2 FFF7FEFF 		bl	lwip_htons
 1477              	.LVL124:
 1478 04b6 10F0010F 		tst	r0, #1
 1479 04ba E6D0     		beq	.L105
1410:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 TCPH_SET_FLAG(inseg.tcphdr, TCP_FIN);
 1480              		.loc 1 1410 0 discriminator 1
 1481 04bc 134B     		ldr	r3, .L186+20
 1482 04be DB68     		ldr	r3, [r3, #12]
 1483 04c0 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1484 04c2 FFF7FEFF 		bl	lwip_htons
 1485              	.LVL125:
1409:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   (TCPH_FLAGS(inseg.tcphdr) & TCP_SYN) == 0) {
 1486              		.loc 1 1409 0 discriminator 1
 1487 04c6 10F0020F 		tst	r0, #2
 1488 04ca DED1     		bne	.L105
1411:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 tcplen = TCP_TCPLEN(&inseg);
 1489              		.loc 1 1411 0
 1490 04cc 0F4E     		ldr	r6, .L186+20
 1491 04ce D6F80C80 		ldr	r8, [r6, #12]
 1492 04d2 B8F80C70 		ldrh	r7, [r8, #12]	@ unaligned
 1493 04d6 0120     		movs	r0, #1
 1494 04d8 FFF7FEFF 		bl	lwip_htons
 1495              	.LVL126:
 1496 04dc 3843     		orrs	r0, r0, r7
 1497 04de A8F80C00 		strh	r0, [r8, #12]	@ unaligned
1412:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
 1498              		.loc 1 1412 0
 1499 04e2 3789     		ldrh	r7, [r6, #8]
 1500 04e4 F368     		ldr	r3, [r6, #12]
 1501 04e6 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1502 04e8 FFF7FEFF 		bl	lwip_htons
 1503              	.LVL127:
 1504 04ec 10F0030F 		tst	r0, #3
 1505 04f0 C7D0     		beq	.L147
 1506 04f2 0123     		movs	r3, #1
 1507 04f4 C6E7     		b	.L106
 1508              	.L187:
 1509 04f6 00BF     		.align	2
 1510              	.L186:
 1511 04f8 00000000 		.word	.LANCHOR9
 1512 04fc 00000000 		.word	.LANCHOR8
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 63


 1513 0500 00000000 		.word	.LANCHOR7
 1514 0504 00000000 		.word	.LANCHOR6
 1515 0508 00000000 		.word	tcp_ticks
 1516 050c 00000000 		.word	.LANCHOR10
 1517              	.L107:
1420:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 TCP_SEQ_GT(seqno + tcplen,
 1518              		.loc 1 1420 0
 1519 0510 45B3     		cbz	r5, .L109
1421:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                            next->tcphdr->seqno)) {
 1520              		.loc 1 1421 0 discriminator 1
 1521 0512 8D4B     		ldr	r3, .L188
 1522 0514 1968     		ldr	r1, [r3]
 1523 0516 8D4B     		ldr	r3, .L188+4
 1524 0518 1B88     		ldrh	r3, [r3]
 1525 051a 0B44     		add	r3, r3, r1
 1526 051c EA68     		ldr	r2, [r5, #12]
 1527 051e 5268     		ldr	r2, [r2, #4]	@ unaligned
 1528 0520 9B1A     		subs	r3, r3, r2
1420:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 TCP_SEQ_GT(seqno + tcplen,
 1529              		.loc 1 1420 0 discriminator 1
 1530 0522 002B     		cmp	r3, #0
 1531 0524 1EDD     		ble	.L109
1424:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               if (TCPH_FLAGS(inseg.tcphdr) & TCP_SYN) {
 1532              		.loc 1 1424 0
 1533 0526 521A     		subs	r2, r2, r1
 1534 0528 894B     		ldr	r3, .L188+8
 1535 052a 1A81     		strh	r2, [r3, #8]	@ movhi
1425:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 inseg.len -= 1;
 1536              		.loc 1 1425 0
 1537 052c DB68     		ldr	r3, [r3, #12]
 1538 052e 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1539 0530 FFF7FEFF 		bl	lwip_htons
 1540              	.LVL128:
 1541 0534 10F0020F 		tst	r0, #2
 1542 0538 03D0     		beq	.L110
1426:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               }
 1543              		.loc 1 1426 0
 1544 053a 854A     		ldr	r2, .L188+8
 1545 053c 1389     		ldrh	r3, [r2, #8]
 1546 053e 013B     		subs	r3, r3, #1
 1547 0540 1381     		strh	r3, [r2, #8]	@ movhi
 1548              	.L110:
1428:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               tcplen = TCP_TCPLEN(&inseg);
 1549              		.loc 1 1428 0
 1550 0542 834E     		ldr	r6, .L188+8
 1551 0544 3189     		ldrh	r1, [r6, #8]
 1552 0546 7068     		ldr	r0, [r6, #4]
 1553 0548 FFF7FEFF 		bl	pbuf_realloc
 1554              	.LVL129:
1429:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               LWIP_ASSERT("tcp_receive: segment not trimmed correctly to ooseq queue\n",
 1555              		.loc 1 1429 0
 1556 054c 3789     		ldrh	r7, [r6, #8]
 1557 054e F368     		ldr	r3, [r6, #12]
 1558 0550 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1559 0552 FFF7FEFF 		bl	lwip_htons
 1560              	.LVL130:
 1561 0556 10F0030F 		tst	r0, #3
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 64


 1562 055a 27D0     		beq	.L148
 1563 055c 0123     		movs	r3, #1
 1564              	.L111:
1429:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               LWIP_ASSERT("tcp_receive: segment not trimmed correctly to ooseq queue\n",
 1565              		.loc 1 1429 0 is_stmt 0 discriminator 4
 1566 055e 3B44     		add	r3, r3, r7
 1567 0560 7A4A     		ldr	r2, .L188+4
 1568 0562 1380     		strh	r3, [r2]	@ movhi
 1569              	.L109:
1433:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 1570              		.loc 1 1433 0 is_stmt 1
 1571 0564 2567     		str	r5, [r4, #112]
 1572              	.LVL131:
 1573              	.L100:
1438:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1574              		.loc 1 1438 0
 1575 0566 794B     		ldr	r3, .L188+4
 1576 0568 1A88     		ldrh	r2, [r3]
 1577 056a 774B     		ldr	r3, .L188
 1578 056c 1B68     		ldr	r3, [r3]
 1579 056e 1344     		add	r3, r3, r2
 1580 0570 6362     		str	r3, [r4, #36]
1441:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->rcv_wnd -= tcplen;
 1581              		.loc 1 1441 0
 1582 0572 238D     		ldrh	r3, [r4, #40]
1442:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1583              		.loc 1 1442 0
 1584 0574 9B1A     		subs	r3, r3, r2
 1585 0576 2385     		strh	r3, [r4, #40]	@ movhi
1444:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1586              		.loc 1 1444 0
 1587 0578 2046     		mov	r0, r4
 1588 057a FFF7FEFF 		bl	tcp_update_rcv_ann_wnd
 1589              	.LVL132:
1455:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           recv_data = inseg.p;
 1590              		.loc 1 1455 0
 1591 057e 744B     		ldr	r3, .L188+8
 1592 0580 5B68     		ldr	r3, [r3, #4]
 1593 0582 1A89     		ldrh	r2, [r3, #8]
 1594 0584 22B1     		cbz	r2, .L112
1456:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* Since this pbuf now is the responsibility of the
 1595              		.loc 1 1456 0
 1596 0586 734A     		ldr	r2, .L188+12
 1597 0588 1360     		str	r3, [r2]
1460:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 1598              		.loc 1 1460 0
 1599 058a 0022     		movs	r2, #0
 1600 058c 704B     		ldr	r3, .L188+8
 1601 058e 5A60     		str	r2, [r3, #4]
 1602              	.L112:
1462:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_receive: received FIN.\n"));
 1603              		.loc 1 1462 0
 1604 0590 6F4B     		ldr	r3, .L188+8
 1605 0592 DB68     		ldr	r3, [r3, #12]
 1606 0594 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1607 0596 FFF7FEFF 		bl	lwip_htons
 1608              	.LVL133:
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 65


 1609 059a 10F0010F 		tst	r0, #1
 1610 059e 23D0     		beq	.L114
1464:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 1611              		.loc 1 1464 0
 1612 05a0 6D4A     		ldr	r2, .L188+16
 1613 05a2 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1614 05a4 43F02003 		orr	r3, r3, #32
 1615 05a8 1370     		strb	r3, [r2]
 1616 05aa 1DE0     		b	.L114
 1617              	.LVL134:
 1618              	.L148:
1429:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               LWIP_ASSERT("tcp_receive: segment not trimmed correctly to ooseq queue\n",
 1619              		.loc 1 1429 0
 1620 05ac 0023     		movs	r3, #0
 1621 05ae D6E7     		b	.L111
 1622              	.LVL135:
 1623              	.L149:
1476:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("tcp_receive: ooseq tcplen > rcv_wnd\n",
 1624              		.loc 1 1476 0
 1625 05b0 0023     		movs	r3, #0
 1626 05b2 2BE0     		b	.L115
 1627              	.L150:
1479:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1628              		.loc 1 1479 0
 1629 05b4 0023     		movs	r3, #0
 1630 05b6 3AE0     		b	.L116
 1631              	.L118:
1492:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
 1632              		.loc 1 1492 0
 1633 05b8 664B     		ldr	r3, .L188+12
 1634 05ba 1960     		str	r1, [r3]
 1635              	.L119:
1494:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 1636              		.loc 1 1494 0
 1637 05bc 0023     		movs	r3, #0
 1638 05be 6B60     		str	r3, [r5, #4]
 1639              	.L117:
1496:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_receive: dequeued FIN.\n"));
 1640              		.loc 1 1496 0
 1641 05c0 EB68     		ldr	r3, [r5, #12]
 1642 05c2 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1643 05c4 FFF7FEFF 		bl	lwip_htons
 1644              	.LVL136:
 1645 05c8 10F0010F 		tst	r0, #1
 1646 05cc 07D0     		beq	.L120
1498:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (pcb->state == ESTABLISHED) { /* force passive close or we can move to active close 
 1647              		.loc 1 1498 0
 1648 05ce 624A     		ldr	r2, .L188+16
 1649 05d0 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1650 05d2 43F02003 		orr	r3, r3, #32
 1651 05d6 1370     		strb	r3, [r2]
1499:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               pcb->state = CLOSE_WAIT;
 1652              		.loc 1 1499 0
 1653 05d8 237D     		ldrb	r3, [r4, #20]	@ zero_extendqisi2
 1654 05da 042B     		cmp	r3, #4
 1655 05dc 39D0     		beq	.L175
 1656              	.L120:
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 66


1504:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           tcp_seg_free(cseg);
 1657              		.loc 1 1504 0
 1658 05de 2B68     		ldr	r3, [r5]
 1659 05e0 2367     		str	r3, [r4, #112]
1505:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 1660              		.loc 1 1505 0
 1661 05e2 2846     		mov	r0, r5
 1662 05e4 FFF7FEFF 		bl	tcp_seg_free
 1663              	.LVL137:
 1664              	.L114:
1470:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                pcb->ooseq->tcphdr->seqno == pcb->rcv_nxt) {
 1665              		.loc 1 1470 0
 1666 05e8 256F     		ldr	r5, [r4, #112]
 1667 05ea 002D     		cmp	r5, #0
 1668 05ec 34D0     		beq	.L121
1471:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1669              		.loc 1 1471 0 discriminator 1
 1670 05ee EA68     		ldr	r2, [r5, #12]
 1671 05f0 5368     		ldr	r3, [r2, #4]	@ unaligned
 1672 05f2 616A     		ldr	r1, [r4, #36]
1470:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                pcb->ooseq->tcphdr->seqno == pcb->rcv_nxt) {
 1673              		.loc 1 1470 0 discriminator 1
 1674 05f4 8B42     		cmp	r3, r1
 1675 05f6 2FD1     		bne	.L121
 1676              	.LVL138:
1474:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1677              		.loc 1 1474 0
 1678 05f8 5349     		ldr	r1, .L188
 1679 05fa 0B60     		str	r3, [r1]
1476:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("tcp_receive: ooseq tcplen > rcv_wnd\n",
 1680              		.loc 1 1476 0
 1681 05fc 2E89     		ldrh	r6, [r5, #8]
 1682 05fe 9089     		ldrh	r0, [r2, #12]	@ unaligned
 1683 0600 FFF7FEFF 		bl	lwip_htons
 1684              	.LVL139:
 1685 0604 10F0030F 		tst	r0, #3
 1686 0608 D2D0     		beq	.L149
 1687 060a 0123     		movs	r3, #1
 1688              	.L115:
1476:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           LWIP_ASSERT("tcp_receive: ooseq tcplen > rcv_wnd\n",
 1689              		.loc 1 1476 0 is_stmt 0 discriminator 4
 1690 060c 9A19     		adds	r2, r3, r6
 1691 060e 636A     		ldr	r3, [r4, #36]
 1692 0610 1344     		add	r3, r3, r2
 1693 0612 6362     		str	r3, [r4, #36]
1477:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       pcb->rcv_wnd >= TCP_TCPLEN(cseg));
 1694              		.loc 1 1477 0 is_stmt 1 discriminator 4
 1695 0614 EB68     		ldr	r3, [r5, #12]
 1696 0616 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1697 0618 FFF7FEFF 		bl	lwip_htons
 1698              	.LVL140:
1479:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1699              		.loc 1 1479 0 discriminator 4
 1700 061c 2E89     		ldrh	r6, [r5, #8]
 1701 061e EB68     		ldr	r3, [r5, #12]
 1702 0620 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1703 0622 FFF7FEFF 		bl	lwip_htons
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 67


 1704              	.LVL141:
 1705 0626 10F0030F 		tst	r0, #3
 1706 062a C3D0     		beq	.L150
1479:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1707              		.loc 1 1479 0 is_stmt 0
 1708 062c 0123     		movs	r3, #1
 1709              	.L116:
1479:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1710              		.loc 1 1479 0 discriminator 4
 1711 062e 9A19     		adds	r2, r3, r6
 1712 0630 238D     		ldrh	r3, [r4, #40]
 1713 0632 9B1A     		subs	r3, r3, r2
 1714 0634 2385     		strh	r3, [r4, #40]	@ movhi
1481:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1715              		.loc 1 1481 0 is_stmt 1 discriminator 4
 1716 0636 2046     		mov	r0, r4
 1717 0638 FFF7FEFF 		bl	tcp_update_rcv_ann_wnd
 1718              	.LVL142:
1483:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Chain this pbuf onto the pbuf that we will pass to
 1719              		.loc 1 1483 0 discriminator 4
 1720 063c 6968     		ldr	r1, [r5, #4]
 1721 063e 0B89     		ldrh	r3, [r1, #8]
 1722 0640 002B     		cmp	r3, #0
 1723 0642 BDD0     		beq	.L117
1489:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               pbuf_cat(recv_data, cseg->p);
 1724              		.loc 1 1489 0
 1725 0644 434B     		ldr	r3, .L188+12
 1726 0646 1868     		ldr	r0, [r3]
 1727 0648 0028     		cmp	r0, #0
 1728 064a B5D0     		beq	.L118
1490:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             } else {
 1729              		.loc 1 1490 0
 1730 064c FFF7FEFF 		bl	pbuf_cat
 1731              	.LVL143:
 1732 0650 B4E7     		b	.L119
 1733              	.L175:
1500:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
 1734              		.loc 1 1500 0
 1735 0652 0723     		movs	r3, #7
 1736 0654 2375     		strb	r3, [r4, #20]
 1737 0656 C2E7     		b	.L120
 1738              	.LVL144:
 1739              	.L121:
1511:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1740              		.loc 1 1511 0
 1741 0658 A37E     		ldrb	r3, [r4, #26]	@ zero_extendqisi2
 1742 065a 13F0010F 		tst	r3, #1
 1743 065e 06D0     		beq	.L123
1511:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 1744              		.loc 1 1511 0 is_stmt 0 discriminator 1
 1745 0660 03F0FE03 		and	r3, r3, #254
 1746 0664 43F00203 		orr	r3, r3, #2
 1747 0668 A376     		strb	r3, [r4, #26]
 1748 066a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1749              	.LVL145:
 1750              	.L123:
1511:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 68


 1751              		.loc 1 1511 0 discriminator 2
 1752 066e 43F00103 		orr	r3, r3, #1
 1753 0672 A376     		strb	r3, [r4, #26]
 1754 0674 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1755              	.LVL146:
 1756              	.L172:
1526:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         } else {
 1757              		.loc 1 1526 0 is_stmt 1
 1758 0678 3548     		ldr	r0, .L188+8
 1759 067a FFF7FEFF 		bl	tcp_seg_copy
 1760              	.LVL147:
 1761 067e 2067     		str	r0, [r4, #112]
 1762 0680 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1763              	.LVL148:
 1764              	.L179:
1547:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 /* The incoming segment is larger than the old
 1765              		.loc 1 1547 0
 1766 0684 324B     		ldr	r3, .L188+8
 1767 0686 1A89     		ldrh	r2, [r3, #8]
 1768 0688 2B89     		ldrh	r3, [r5, #8]
 1769 068a 9A42     		cmp	r2, r3
 1770 068c 40F2D480 		bls	.L58
1551:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 if (cseg != NULL) {
 1771              		.loc 1 1551 0
 1772 0690 2F48     		ldr	r0, .L188+8
 1773 0692 FFF7FEFF 		bl	tcp_seg_copy
 1774              	.LVL149:
1552:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   if (prev != NULL) {
 1775              		.loc 1 1552 0
 1776 0696 0346     		mov	r3, r0
 1777 0698 0028     		cmp	r0, #0
 1778 069a 00F0CD80 		beq	.L58
1553:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     prev->next = cseg;
 1779              		.loc 1 1553 0
 1780 069e 36B1     		cbz	r6, .L127
1554:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   } else {
 1781              		.loc 1 1554 0
 1782 06a0 3060     		str	r0, [r6]
 1783              	.L128:
1558:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 }
 1784              		.loc 1 1558 0
 1785 06a2 2946     		mov	r1, r5
 1786 06a4 1846     		mov	r0, r3
 1787              	.LVL150:
 1788 06a6 FFF7FEFF 		bl	tcp_oos_insert_segment
 1789              	.LVL151:
 1790 06aa BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1791              	.LVL152:
 1792              	.L127:
1556:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   }
 1793              		.loc 1 1556 0
 1794 06ae 2067     		str	r0, [r4, #112]
 1795 06b0 F7E7     		b	.L128
 1796              	.LVL153:
 1797              	.L180:
1569:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   /* The sequence number of the incoming segment is lower
 1798              		.loc 1 1569 0
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 69


 1799 06b2 5A1A     		subs	r2, r3, r1
 1800 06b4 002A     		cmp	r2, #0
 1801 06b6 35DB     		blt	.L176
 1802              	.L130:
1606:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   TCP_SEQ_GT(seqno, next->tcphdr->seqno)) {
 1803              		.loc 1 1606 0
 1804 06b8 2A68     		ldr	r2, [r5]
 1805 06ba 2E46     		mov	r6, r5
 1806              	.LVL154:
 1807 06bc 002A     		cmp	r2, #0
 1808 06be 3DD0     		beq	.L177
 1809 06c0 1546     		mov	r5, r2
 1810              	.LVL155:
 1811              	.L125:
1541:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (seqno == next->tcphdr->seqno) {
 1812              		.loc 1 1541 0 discriminator 1
 1813 06c2 002D     		cmp	r5, #0
 1814 06c4 00F0A680 		beq	.L178
1542:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               /* The sequence number of the incoming segment is the
 1815              		.loc 1 1542 0
 1816 06c8 E868     		ldr	r0, [r5, #12]
 1817 06ca 4168     		ldr	r1, [r0, #4]	@ unaligned
 1818 06cc 1E4B     		ldr	r3, .L188
 1819 06ce 1B68     		ldr	r3, [r3]
 1820 06d0 9942     		cmp	r1, r3
 1821 06d2 D7D0     		beq	.L179
1568:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 if (TCP_SEQ_LT(seqno, next->tcphdr->seqno)) {
 1822              		.loc 1 1568 0
 1823 06d4 002E     		cmp	r6, #0
 1824 06d6 ECD0     		beq	.L180
1584:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   /* The sequence number of the incoming segment is in
 1825              		.loc 1 1584 0
 1826 06d8 F268     		ldr	r2, [r6, #12]
 1827 06da 5268     		ldr	r2, [r2, #4]	@ unaligned
 1828 06dc 9A1A     		subs	r2, r3, r2
 1829 06de 012A     		cmp	r2, #1
 1830 06e0 EAD4     		bmi	.L130
1584:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   /* The sequence number of the incoming segment is in
 1831              		.loc 1 1584 0 is_stmt 0 discriminator 1
 1832 06e2 5A1A     		subs	r2, r3, r1
 1833 06e4 0132     		adds	r2, r2, #1
 1834 06e6 002A     		cmp	r2, #0
 1835 06e8 E6DC     		bgt	.L130
1590:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   if (cseg != NULL) {
 1836              		.loc 1 1590 0 is_stmt 1
 1837 06ea 1948     		ldr	r0, .L188+8
 1838 06ec FFF7FEFF 		bl	tcp_seg_copy
 1839              	.LVL156:
1591:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     if (TCP_SEQ_GT(prev->tcphdr->seqno + prev->len, seqno)) {
 1840              		.loc 1 1591 0
 1841 06f0 0446     		mov	r4, r0
 1842              	.LVL157:
 1843 06f2 0028     		cmp	r0, #0
 1844 06f4 00F0A080 		beq	.L58
1592:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       /* We need to trim the prev segment. */
 1845              		.loc 1 1592 0
 1846 06f8 F368     		ldr	r3, [r6, #12]
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 70


 1847 06fa 5968     		ldr	r1, [r3, #4]	@ unaligned
 1848 06fc 3289     		ldrh	r2, [r6, #8]
 1849 06fe 0A44     		add	r2, r2, r1
 1850 0700 114B     		ldr	r3, .L188
 1851 0702 1B68     		ldr	r3, [r3]
 1852 0704 D21A     		subs	r2, r2, r3
 1853 0706 002A     		cmp	r2, #0
 1854 0708 05DD     		ble	.L131
1594:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       pbuf_realloc(prev->p, prev->len);
 1855              		.loc 1 1594 0
 1856 070a 5B1A     		subs	r3, r3, r1
 1857 070c 99B2     		uxth	r1, r3
 1858 070e 3181     		strh	r1, [r6, #8]	@ movhi
1595:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     }
 1859              		.loc 1 1595 0
 1860 0710 7068     		ldr	r0, [r6, #4]
 1861              	.LVL158:
 1862 0712 FFF7FEFF 		bl	pbuf_realloc
 1863              	.LVL159:
 1864              	.L131:
1597:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     tcp_oos_insert_segment(cseg, next);
 1865              		.loc 1 1597 0
 1866 0716 3460     		str	r4, [r6]
1598:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   }
 1867              		.loc 1 1598 0
 1868 0718 2946     		mov	r1, r5
 1869 071a 2046     		mov	r0, r4
 1870 071c FFF7FEFF 		bl	tcp_oos_insert_segment
 1871              	.LVL160:
 1872 0720 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1873              	.LVL161:
 1874              	.L176:
1574:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   if (cseg != NULL) {
 1875              		.loc 1 1574 0
 1876 0724 0A48     		ldr	r0, .L188+8
 1877 0726 FFF7FEFF 		bl	tcp_seg_copy
 1878              	.LVL162:
1575:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     pcb->ooseq = cseg;
 1879              		.loc 1 1575 0
 1880 072a 0028     		cmp	r0, #0
 1881 072c 00F08480 		beq	.L58
1576:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     tcp_oos_insert_segment(cseg, next);
 1882              		.loc 1 1576 0
 1883 0730 2067     		str	r0, [r4, #112]
1577:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   }
 1884              		.loc 1 1577 0
 1885 0732 2946     		mov	r1, r5
 1886 0734 FFF7FEFF 		bl	tcp_oos_insert_segment
 1887              	.LVL163:
 1888 0738 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1889              	.LVL164:
 1890              	.L177:
1607:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 if (TCPH_FLAGS(next->tcphdr) & TCP_FIN) {
 1891              		.loc 1 1607 0 discriminator 1
 1892 073c 5B1A     		subs	r3, r3, r1
1606:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   TCP_SEQ_GT(seqno, next->tcphdr->seqno)) {
 1893              		.loc 1 1606 0 discriminator 1
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 71


 1894 073e 002B     		cmp	r3, #0
 1895 0740 0CDC     		bgt	.L181
 1896 0742 1546     		mov	r5, r2
 1897              	.LVL165:
 1898 0744 BDE7     		b	.L125
 1899              	.L189:
 1900 0746 00BF     		.align	2
 1901              	.L188:
 1902 0748 00000000 		.word	.LANCHOR6
 1903 074c 00000000 		.word	.LANCHOR7
 1904 0750 00000000 		.word	.LANCHOR10
 1905 0754 00000000 		.word	.LANCHOR11
 1906 0758 00000000 		.word	.LANCHOR12
 1907              	.LVL166:
 1908              	.L181:
1608:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   /* segment "next" already contains all data */
 1909              		.loc 1 1608 0
 1910 075c 8089     		ldrh	r0, [r0, #12]	@ unaligned
 1911 075e FFF7FEFF 		bl	lwip_htons
 1912              	.LVL167:
 1913 0762 10F0010F 		tst	r0, #1
 1914 0766 67D1     		bne	.L58
1612:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                 if (next->next != NULL) {
 1915              		.loc 1 1612 0
 1916 0768 3448     		ldr	r0, .L190
 1917 076a FFF7FEFF 		bl	tcp_seg_copy
 1918              	.LVL168:
 1919 076e 2860     		str	r0, [r5]
1613:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   if (TCP_SEQ_GT(next->tcphdr->seqno + next->len, seqno)) {
 1920              		.loc 1 1613 0
 1921 0770 0028     		cmp	r0, #0
 1922 0772 61D0     		beq	.L58
1614:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     /* We need to trim the last segment. */
 1923              		.loc 1 1614 0
 1924 0774 EB68     		ldr	r3, [r5, #12]
 1925 0776 5968     		ldr	r1, [r3, #4]	@ unaligned
 1926 0778 2A89     		ldrh	r2, [r5, #8]
 1927 077a 0A44     		add	r2, r2, r1
 1928 077c 304B     		ldr	r3, .L190+4
 1929 077e 1B68     		ldr	r3, [r3]
 1930 0780 D21A     		subs	r2, r2, r3
 1931 0782 002A     		cmp	r2, #0
 1932 0784 05DD     		ble	.L132
1616:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     pbuf_realloc(next->p, next->len);
 1933              		.loc 1 1616 0
 1934 0786 5B1A     		subs	r3, r3, r1
 1935 0788 99B2     		uxth	r1, r3
 1936 078a 2981     		strh	r1, [r5, #8]	@ movhi
1617:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                   }
 1937              		.loc 1 1617 0
 1938 078c 6868     		ldr	r0, [r5, #4]
 1939 078e FFF7FEFF 		bl	pbuf_realloc
 1940              	.LVL169:
 1941              	.L132:
1620:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     LWIP_DEBUGF(TCP_INPUT_DEBUG,
 1942              		.loc 1 1620 0
 1943 0792 2C4B     		ldr	r3, .L190+8
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 72


 1944 0794 1B88     		ldrh	r3, [r3]
 1945 0796 2A4A     		ldr	r2, .L190+4
 1946 0798 1268     		ldr	r2, [r2]
 1947 079a 1344     		add	r3, r3, r2
 1948 079c 626A     		ldr	r2, [r4, #36]
 1949 079e 218D     		ldrh	r1, [r4, #40]
 1950 07a0 0A44     		add	r2, r2, r1
 1951 07a2 9B1A     		subs	r3, r3, r2
 1952 07a4 002B     		cmp	r3, #0
 1953 07a6 47DD     		ble	.L58
1625:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                       /* Must remove the FIN from the header as we're trimming
 1954              		.loc 1 1625 0
 1955 07a8 2B68     		ldr	r3, [r5]
 1956 07aa DB68     		ldr	r3, [r3, #12]
 1957 07ac 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1958 07ae FFF7FEFF 		bl	lwip_htons
 1959              	.LVL170:
 1960 07b2 10F0010F 		tst	r0, #1
 1961 07b6 1CD1     		bne	.L182
 1962              	.L133:
1631:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     pbuf_realloc(next->next->p, next->next->len);
 1963              		.loc 1 1631 0
 1964 07b8 2A68     		ldr	r2, [r5]
 1965 07ba 616A     		ldr	r1, [r4, #36]
 1966 07bc 238D     		ldrh	r3, [r4, #40]
 1967 07be 0B44     		add	r3, r3, r1
 1968 07c0 9BB2     		uxth	r3, r3
 1969 07c2 1F49     		ldr	r1, .L190+4
 1970 07c4 0968     		ldr	r1, [r1]
 1971 07c6 5B1A     		subs	r3, r3, r1
 1972 07c8 1381     		strh	r3, [r2, #8]	@ movhi
1632:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     tcplen = TCP_TCPLEN(next->next);
 1973              		.loc 1 1632 0
 1974 07ca 2B68     		ldr	r3, [r5]
 1975 07cc 1989     		ldrh	r1, [r3, #8]
 1976 07ce 5868     		ldr	r0, [r3, #4]
 1977 07d0 FFF7FEFF 		bl	pbuf_realloc
 1978              	.LVL171:
1633:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     LWIP_ASSERT("tcp_receive: segment not trimmed correctly to rcv_wnd\n",
 1979              		.loc 1 1633 0
 1980 07d4 2B68     		ldr	r3, [r5]
 1981 07d6 1C89     		ldrh	r4, [r3, #8]
 1982              	.LVL172:
 1983 07d8 DB68     		ldr	r3, [r3, #12]
 1984 07da 9889     		ldrh	r0, [r3, #12]	@ unaligned
 1985 07dc FFF7FEFF 		bl	lwip_htons
 1986              	.LVL173:
 1987 07e0 10F0030F 		tst	r0, #3
 1988 07e4 14D1     		bne	.L183
 1989 07e6 0023     		movs	r3, #0
 1990              	.L134:
1633:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     LWIP_ASSERT("tcp_receive: segment not trimmed correctly to rcv_wnd\n",
 1991              		.loc 1 1633 0 is_stmt 0 discriminator 4
 1992 07e8 2344     		add	r3, r3, r4
 1993 07ea 164A     		ldr	r2, .L190+8
 1994 07ec 1380     		strh	r3, [r2]	@ movhi
 1995 07ee BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 73


 1996              	.LVL174:
 1997              	.L182:
1628:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     }
 1998              		.loc 1 1628 0 is_stmt 1
 1999 07f2 2B68     		ldr	r3, [r5]
 2000 07f4 DF68     		ldr	r7, [r3, #12]
 2001 07f6 B889     		ldrh	r0, [r7, #12]	@ unaligned
 2002 07f8 20F47C56 		bic	r6, r0, #16128
 2003 07fc B6B2     		uxth	r6, r6
 2004 07fe FFF7FEFF 		bl	lwip_htons
 2005              	.LVL175:
 2006 0802 00F03E00 		and	r0, r0, #62
 2007 0806 FFF7FEFF 		bl	lwip_htons
 2008              	.LVL176:
 2009 080a 3043     		orrs	r0, r0, r6
 2010 080c B881     		strh	r0, [r7, #12]	@ unaligned
 2011 080e D3E7     		b	.L133
 2012              	.LVL177:
 2013              	.L183:
1633:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                     LWIP_ASSERT("tcp_receive: segment not trimmed correctly to rcv_wnd\n",
 2014              		.loc 1 1633 0
 2015 0810 0123     		movs	r3, #1
 2016 0812 E9E7     		b	.L134
 2017              	.LVL178:
 2018              	.L178:
 2019 0814 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2020              	.LVL179:
 2021              	.L86:
1678:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_ack_now(pcb);
 2022              		.loc 1 1678 0
 2023 0818 094B     		ldr	r3, .L190+4
 2024 081a 1B68     		ldr	r3, [r3]
 2025 081c 626A     		ldr	r2, [r4, #36]
 2026 081e 991A     		subs	r1, r3, r2
 2027 0820 0029     		cmp	r1, #0
 2028 0822 05DB     		blt	.L136
1678:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_ack_now(pcb);
 2029              		.loc 1 1678 0 is_stmt 0 discriminator 1
 2030 0824 218D     		ldrh	r1, [r4, #40]
 2031 0826 0A44     		add	r2, r2, r1
 2032 0828 9B1A     		subs	r3, r3, r2
 2033 082a 0133     		adds	r3, r3, #1
 2034 082c 002B     		cmp	r3, #0
 2035 082e 03DD     		ble	.L58
 2036              	.L136:
1679:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 2037              		.loc 1 1679 0 is_stmt 1
 2038 0830 A37E     		ldrb	r3, [r4, #26]	@ zero_extendqisi2
 2039 0832 43F00203 		orr	r3, r3, #2
 2040 0836 A376     		strb	r3, [r4, #26]
 2041              	.LVL180:
 2042              	.L58:
 2043 0838 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2044              	.L191:
 2045              		.align	2
 2046              	.L190:
 2047 083c 00000000 		.word	.LANCHOR10
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 74


 2048 0840 00000000 		.word	.LANCHOR6
 2049 0844 00000000 		.word	.LANCHOR7
 2050              		.cfi_endproc
 2051              	.LFE141:
 2053              		.section	.text.tcp_process,"ax",%progbits
 2054              		.align	1
 2055              		.syntax unified
 2056              		.thumb
 2057              		.thumb_func
 2058              		.fpu fpv5-sp-d16
 2060              	tcp_process:
 2061              	.LFB139:
 683:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_seg *rseg;
 2062              		.loc 1 683 0
 2063              		.cfi_startproc
 2064              		@ args = 0, pretend = 0, frame = 0
 2065              		@ frame_needed = 0, uses_anonymous_args = 0
 2066              	.LVL181:
 2067 0000 70B5     		push	{r4, r5, r6, lr}
 2068              	.LCFI15:
 2069              		.cfi_def_cfa_offset 16
 2070              		.cfi_offset 4, -16
 2071              		.cfi_offset 5, -12
 2072              		.cfi_offset 6, -8
 2073              		.cfi_offset 14, -4
 2074 0002 82B0     		sub	sp, sp, #8
 2075              	.LCFI16:
 2076              		.cfi_def_cfa_offset 24
 2077              	.LVL182:
 691:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* First, determine if the reset is acceptable. */
 2078              		.loc 1 691 0
 2079 0004 AA4B     		ldr	r3, .L279
 2080 0006 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2081 0008 13F0040F 		tst	r3, #4
 2082 000c 34D0     		beq	.L193
 693:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* "In the SYN-SENT state (a RST received in response to an initial SYN),
 2083              		.loc 1 693 0
 2084 000e 037D     		ldrb	r3, [r0, #20]	@ zero_extendqisi2
 2085 0010 022B     		cmp	r3, #2
 2086 0012 12D0     		beq	.L256
 702:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         acceptable = 1;
 2087              		.loc 1 702 0
 2088 0014 426A     		ldr	r2, [r0, #36]
 2089 0016 A74B     		ldr	r3, .L279+4
 2090 0018 1B68     		ldr	r3, [r3]
 2091 001a 9A42     		cmp	r2, r3
 2092 001c 1CD0     		beq	.L230
 704:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                   pcb->rcv_nxt + pcb->rcv_wnd)) {
 2093              		.loc 1 704 0
 2094 001e 991A     		subs	r1, r3, r2
 2095 0020 0029     		cmp	r1, #0
 2096 0022 1BDB     		blt	.L231
 704:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                                   pcb->rcv_nxt + pcb->rcv_wnd)) {
 2097              		.loc 1 704 0 is_stmt 0 discriminator 1
 2098 0024 018D     		ldrh	r1, [r0, #40]
 2099 0026 0A44     		add	r2, r2, r1
 2100 0028 9B1A     		subs	r3, r3, r2
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 75


 2101 002a 002B     		cmp	r3, #0
 2102 002c 0CDD     		ble	.L257
 685:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   err_t err;
 2103              		.loc 1 685 0 is_stmt 1
 2104 002e 0023     		movs	r3, #0
 2105              	.L195:
 2106              	.LVL183:
 714:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_process: Connection RESET\n"));
 2107              		.loc 1 714 0
 2108 0030 B3B9     		cbnz	r3, .L258
 725:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 2109              		.loc 1 725 0
 2110 0032 0025     		movs	r5, #0
 2111              	.LVL184:
 2112              	.L196:
 937:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 2113              		.loc 1 937 0
 2114 0034 2846     		mov	r0, r5
 2115 0036 02B0     		add	sp, sp, #8
 2116              	.LCFI17:
 2117              		.cfi_remember_state
 2118              		.cfi_def_cfa_offset 16
 2119              		@ sp needed
 2120 0038 70BD     		pop	{r4, r5, r6, pc}
 2121              	.LVL185:
 2122              	.L256:
 2123              	.LCFI18:
 2124              		.cfi_restore_state
 696:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         acceptable = 1;
 2125              		.loc 1 696 0
 2126 003a C26C     		ldr	r2, [r0, #76]
 2127 003c 9E4B     		ldr	r3, .L279+8
 2128 003e 1B68     		ldr	r3, [r3]
 2129 0040 9A42     		cmp	r2, r3
 2130 0042 07D0     		beq	.L229
 685:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   err_t err;
 2131              		.loc 1 685 0
 2132 0044 0023     		movs	r3, #0
 2133 0046 F3E7     		b	.L195
 2134              	.L257:
 710:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 2135              		.loc 1 710 0
 2136 0048 837E     		ldrb	r3, [r0, #26]	@ zero_extendqisi2
 2137 004a 43F00203 		orr	r3, r3, #2
 2138 004e 8376     		strb	r3, [r0, #26]
 685:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   err_t err;
 2139              		.loc 1 685 0
 2140 0050 0023     		movs	r3, #0
 2141 0052 EDE7     		b	.L195
 2142              	.L229:
 697:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 2143              		.loc 1 697 0
 2144 0054 0123     		movs	r3, #1
 2145 0056 EBE7     		b	.L195
 2146              	.L230:
 703:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else  if (TCP_SEQ_BETWEEN(seqno, pcb->rcv_nxt,
 2147              		.loc 1 703 0
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 76


 2148 0058 0123     		movs	r3, #1
 2149 005a E9E7     		b	.L195
 2150              	.L231:
 685:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   err_t err;
 2151              		.loc 1 685 0
 2152 005c 0023     		movs	r3, #0
 2153 005e E7E7     		b	.L195
 2154              	.LVL186:
 2155              	.L258:
 717:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->flags &= ~TF_ACK_DELAY;
 2156              		.loc 1 717 0
 2157 0060 964A     		ldr	r2, .L279+12
 2158 0062 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 2159              	.LVL187:
 2160 0064 43F00803 		orr	r3, r3, #8
 2161 0068 1370     		strb	r3, [r2]
 718:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       return ERR_RST;
 2162              		.loc 1 718 0
 2163 006a 837E     		ldrb	r3, [r0, #26]	@ zero_extendqisi2
 2164 006c 23F00103 		bic	r3, r3, #1
 2165 0070 8376     		strb	r3, [r0, #26]
 719:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     } else {
 2166              		.loc 1 719 0
 2167 0072 6FF00D05 		mvn	r5, #13
 2168 0076 DDE7     		b	.L196
 2169              	.LVL188:
 2170              	.L193:
 729:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Cope with new connection attempt after remote end crashed */
 2171              		.loc 1 729 0
 2172 0078 13F0020F 		tst	r3, #2
 2173 007c 0AD0     		beq	.L197
 729:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Cope with new connection attempt after remote end crashed */
 2174              		.loc 1 729 0 is_stmt 0 discriminator 1
 2175 007e 037D     		ldrb	r3, [r0, #20]	@ zero_extendqisi2
 2176 0080 023B     		subs	r3, r3, #2
 2177 0082 DBB2     		uxtb	r3, r3
 2178 0084 012B     		cmp	r3, #1
 2179 0086 05D9     		bls	.L197
 731:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     return ERR_OK;
 2180              		.loc 1 731 0 is_stmt 1
 2181 0088 837E     		ldrb	r3, [r0, #26]	@ zero_extendqisi2
 2182 008a 43F00203 		orr	r3, r3, #2
 2183 008e 8376     		strb	r3, [r0, #26]
 732:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 2184              		.loc 1 732 0
 2185 0090 0025     		movs	r5, #0
 2186 0092 CFE7     		b	.L196
 2187              	.L197:
 735:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* Update the PCB (in)activity timer unless rx is closed (see tcp_shutdown) */
 2188              		.loc 1 735 0
 2189 0094 837E     		ldrb	r3, [r0, #26]	@ zero_extendqisi2
 2190 0096 13F0100F 		tst	r3, #16
 2191 009a 02D1     		bne	.L198
 737:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 2192              		.loc 1 737 0
 2193 009c 884B     		ldr	r3, .L279+16
 2194 009e 1B68     		ldr	r3, [r3]
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 77


 2195 00a0 0362     		str	r3, [r0, #32]
 2196              	.L198:
 2197 00a2 0446     		mov	r4, r0
 739:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 2198              		.loc 1 739 0
 2199 00a4 0023     		movs	r3, #0
 2200 00a6 80F89630 		strb	r3, [r0, #150]
 741:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 2201              		.loc 1 741 0
 2202 00aa FFF7FEFF 		bl	tcp_parseopt
 2203              	.LVL189:
 744:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   case SYN_SENT:
 2204              		.loc 1 744 0
 2205 00ae 237D     		ldrb	r3, [r4, #20]	@ zero_extendqisi2
 2206 00b0 023B     		subs	r3, r3, #2
 2207 00b2 072B     		cmp	r3, #7
 2208 00b4 00F2F081 		bhi	.L234
 2209 00b8 DFE813F0 		tbh	[pc, r3, lsl #1]
 2210              	.L200:
 2211 00bc 0800     		.2byte	(.L199-.L200)/2
 2212 00be 8400     		.2byte	(.L201-.L200)/2
 2213 00c0 0C01     		.2byte	(.L202-.L200)/2
 2214 00c2 1D01     		.2byte	(.L203-.L200)/2
 2215 00c4 7301     		.2byte	(.L204-.L200)/2
 2216 00c6 0C01     		.2byte	(.L202-.L200)/2
 2217 00c8 A101     		.2byte	(.L205-.L200)/2
 2218 00ca D401     		.2byte	(.L206-.L200)/2
 2219              		.p2align 1
 2220              	.L199:
 749:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         && (ackno == pcb->lastack + 1)) {
 2221              		.loc 1 749 0
 2222 00cc 784B     		ldr	r3, .L279
 2223 00ce 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2224 00d0 03F01202 		and	r2, r3, #18
 2225 00d4 122A     		cmp	r2, #18
 2226 00d6 04D0     		beq	.L259
 2227              	.L207:
 803:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* send a RST to bring the other side in a non-synchronized state. */
 2228              		.loc 1 803 0
 2229 00d8 13F0100F 		tst	r3, #16
 2230 00dc 5AD1     		bne	.L260
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2231              		.loc 1 936 0
 2232 00de 0025     		movs	r5, #0
 2233 00e0 A8E7     		b	.L196
 2234              	.L259:
 750:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->rcv_nxt = seqno + 1;
 2235              		.loc 1 750 0
 2236 00e2 626C     		ldr	r2, [r4, #68]
 2237 00e4 0132     		adds	r2, r2, #1
 2238 00e6 7449     		ldr	r1, .L279+8
 2239 00e8 0968     		ldr	r1, [r1]
 2240 00ea 8A42     		cmp	r2, r1
 2241 00ec F4D1     		bne	.L207
 751:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->rcv_ann_right_edge = pcb->rcv_nxt;
 2242              		.loc 1 751 0
 2243 00ee 714B     		ldr	r3, .L279+4
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 78


 2244 00f0 1B68     		ldr	r3, [r3]
 2245 00f2 5A1C     		adds	r2, r3, #1
 2246 00f4 6262     		str	r2, [r4, #36]
 752:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->lastack = ackno;
 2247              		.loc 1 752 0
 2248 00f6 E262     		str	r2, [r4, #44]
 753:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wnd = SND_WND_SCALE(pcb, tcphdr->wnd);
 2249              		.loc 1 753 0
 2250 00f8 6164     		str	r1, [r4, #68]
 754:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wnd_max = pcb->snd_wnd;
 2251              		.loc 1 754 0
 2252 00fa 724A     		ldr	r2, .L279+20
 2253 00fc 1268     		ldr	r2, [r2]
 2254 00fe D289     		ldrh	r2, [r2, #14]	@ unaligned
 2255 0100 A4F85C20 		strh	r2, [r4, #92]	@ movhi
 755:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->snd_wl1 = seqno - 1; /* initialise to seqno - 1 to force window update */
 2256              		.loc 1 755 0
 2257 0104 A4F85E20 		strh	r2, [r4, #94]	@ movhi
 756:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = ESTABLISHED;
 2258              		.loc 1 756 0
 2259 0108 013B     		subs	r3, r3, #1
 2260 010a 2365     		str	r3, [r4, #80]
 757:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 2261              		.loc 1 757 0
 2262 010c 0423     		movs	r3, #4
 2263 010e 2375     		strb	r3, [r4, #20]
 760:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_CALCULATE_EFF_SEND_MSS */
 2264              		.loc 1 760 0
 2265 0110 E118     		adds	r1, r4, r3
 2266 0112 608E     		ldrh	r0, [r4, #50]
 2267 0114 FFF7FEFF 		bl	tcp_eff_send_mss_impl
 2268              	.LVL190:
 2269 0118 6086     		strh	r0, [r4, #50]	@ movhi
 764:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 2270              		.loc 1 764 0
 2271 011a B4F85C30 		ldrh	r3, [r4, #92]
 2272 011e A4F84A30 		strh	r3, [r4, #74]	@ movhi
 766:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_CWND_DEBUG, ("tcp_process (SENT): cwnd %"TCPWNDSIZE_F
 2273              		.loc 1 766 0
 2274 0122 4300     		lsls	r3, r0, #1
 2275 0124 41F21C12 		movw	r2, #4380
 2276 0128 9342     		cmp	r3, r2
 2277 012a 38BF     		it	cc
 2278 012c 1346     		movcc	r3, r2
 2279 012e 8000     		lsls	r0, r0, #2
 2280 0130 8342     		cmp	r3, r0
 2281 0132 28BF     		it	cs
 2282 0134 0346     		movcs	r3, r0
 2283 0136 A4F84830 		strh	r3, [r4, #72]	@ movhi
 770:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       --pcb->snd_queuelen;
 2284              		.loc 1 770 0
 2285 013a B4F86230 		ldrh	r3, [r4, #98]
 771:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_QLEN_DEBUG, ("tcp_process: SYN-SENT --queuelen %"TCPWNDSIZE_F"\n", (tcpwnd_si
 2286              		.loc 1 771 0
 2287 013e 013B     		subs	r3, r3, #1
 2288 0140 A4F86230 		strh	r3, [r4, #98]	@ movhi
 773:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (rseg == NULL) {
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 79


 2289              		.loc 1 773 0
 2290 0144 E06E     		ldr	r0, [r4, #108]
 2291              	.LVL191:
 774:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* might happen if tcp_output fails in tcp_rexmit_rto()
 2292              		.loc 1 774 0
 2293 0146 D8B1     		cbz	r0, .L261
 781:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 2294              		.loc 1 781 0
 2295 0148 0368     		ldr	r3, [r0]
 2296 014a E366     		str	r3, [r4, #108]
 2297              	.L209:
 783:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 2298              		.loc 1 783 0
 2299 014c FFF7FEFF 		bl	tcp_seg_free
 2300              	.LVL192:
 787:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->rtime = -1;
 2301              		.loc 1 787 0
 2302 0150 E36E     		ldr	r3, [r4, #108]
 2303 0152 CBB1     		cbz	r3, .L262
 790:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->nrtx = 0;
 2304              		.loc 1 790 0
 2305 0154 0023     		movs	r3, #0
 2306 0156 2386     		strh	r3, [r4, #48]	@ movhi
 791:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 2307              		.loc 1 791 0
 2308 0158 84F84230 		strb	r3, [r4, #66]
 2309              	.L211:
 796:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (err == ERR_ABRT) {
 2310              		.loc 1 796 0
 2311 015c D4F88430 		ldr	r3, [r4, #132]
 2312 0160 B3B1     		cbz	r3, .L235
 796:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (err == ERR_ABRT) {
 2313              		.loc 1 796 0 is_stmt 0 discriminator 1
 2314 0162 0022     		movs	r2, #0
 2315 0164 2146     		mov	r1, r4
 2316 0166 2069     		ldr	r0, [r4, #16]
 2317 0168 9847     		blx	r3
 2318              	.LVL193:
 2319 016a 0546     		mov	r5, r0
 2320              	.LVL194:
 2321              	.L212:
 797:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         return ERR_ABRT;
 2322              		.loc 1 797 0 is_stmt 1
 2323 016c 15F10D0F 		cmn	r5, #13
 2324 0170 3FF460AF 		beq	.L196
 800:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 2325              		.loc 1 800 0
 2326 0174 A37E     		ldrb	r3, [r4, #26]	@ zero_extendqisi2
 2327 0176 43F00203 		orr	r3, r3, #2
 2328 017a A376     		strb	r3, [r4, #26]
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2329              		.loc 1 936 0
 2330 017c 0025     		movs	r5, #0
 2331              	.LVL195:
 800:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 2332              		.loc 1 800 0
 2333 017e 59E7     		b	.L196
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 80


 2334              	.LVL196:
 2335              	.L261:
 777:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_ASSERT("no segment to free", rseg != NULL);
 2336              		.loc 1 777 0
 2337 0180 A06E     		ldr	r0, [r4, #104]
 2338              	.LVL197:
 779:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 2339              		.loc 1 779 0
 2340 0182 0368     		ldr	r3, [r0]
 2341 0184 A366     		str	r3, [r4, #104]
 2342 0186 E1E7     		b	.L209
 2343              	.LVL198:
 2344              	.L262:
 788:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 2345              		.loc 1 788 0
 2346 0188 4FF6FF73 		movw	r3, #65535
 2347 018c 2386     		strh	r3, [r4, #48]	@ movhi
 2348 018e E5E7     		b	.L211
 2349              	.L235:
 796:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (err == ERR_ABRT) {
 2350              		.loc 1 796 0
 2351 0190 0025     		movs	r5, #0
 2352 0192 EBE7     		b	.L212
 2353              	.L260:
 806:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Resend SYN immediately (don't wait for rto timeout) to establish
 2354              		.loc 1 806 0
 2355 0194 4B4B     		ldr	r3, .L279+20
 2356 0196 1B68     		ldr	r3, [r3]
 805:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_current_src_addr(), tcphdr->dest, tcphdr->src);
 2357              		.loc 1 805 0
 2358 0198 4B4A     		ldr	r2, .L279+24
 2359 019a 4C49     		ldr	r1, .L279+28
 2360 019c 0D88     		ldrh	r5, [r1]
 2361 019e 4549     		ldr	r1, .L279+4
 2362 01a0 0968     		ldr	r1, [r1]
 2363 01a2 4548     		ldr	r0, .L279+8
 2364 01a4 0068     		ldr	r0, [r0]
 2365 01a6 1E88     		ldrh	r6, [r3]	@ unaligned
 2366 01a8 0196     		str	r6, [sp, #4]
 2367 01aa 5B88     		ldrh	r3, [r3, #2]	@ unaligned
 2368 01ac 0093     		str	r3, [sp]
 2369 01ae 1346     		mov	r3, r2
 2370 01b0 0432     		adds	r2, r2, #4
 2371 01b2 2944     		add	r1, r1, r5
 2372 01b4 FFF7FEFF 		bl	tcp_rst
 2373              	.LVL199:
 809:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_rexmit_rto(pcb);
 2374              		.loc 1 809 0
 2375 01b8 0025     		movs	r5, #0
 2376 01ba 2586     		strh	r5, [r4, #48]	@ movhi
 810:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 2377              		.loc 1 810 0
 2378 01bc 2046     		mov	r0, r4
 2379 01be FFF7FEFF 		bl	tcp_rexmit_rto
 2380              	.LVL200:
 2381 01c2 37E7     		b	.L196
 2382              	.L201:
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 81


 814:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* expected ACK number? */
 2383              		.loc 1 814 0
 2384 01c4 3A4B     		ldr	r3, .L279
 2385 01c6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2386 01c8 13F0100F 		tst	r3, #16
 2387 01cc 5ED0     		beq	.L213
 816:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = ESTABLISHED;
 2388              		.loc 1 816 0
 2389 01ce 3A4B     		ldr	r3, .L279+8
 2390 01d0 1868     		ldr	r0, [r3]
 2391 01d2 636C     		ldr	r3, [r4, #68]
 2392 01d4 C31A     		subs	r3, r0, r3
 2393 01d6 012B     		cmp	r3, #1
 2394 01d8 03D4     		bmi	.L214
 816:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = ESTABLISHED;
 2395              		.loc 1 816 0 is_stmt 0 discriminator 1
 2396 01da E36C     		ldr	r3, [r4, #76]
 2397 01dc C31A     		subs	r3, r0, r3
 2398 01de 002B     		cmp	r3, #0
 2399 01e0 11DD     		ble	.L263
 2400              	.L214:
 867:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 2401              		.loc 1 867 0 is_stmt 1
 2402 01e2 384B     		ldr	r3, .L279+20
 2403 01e4 1B68     		ldr	r3, [r3]
 866:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           ip_current_src_addr(), tcphdr->dest, tcphdr->src);
 2404              		.loc 1 866 0
 2405 01e6 384A     		ldr	r2, .L279+24
 2406 01e8 3849     		ldr	r1, .L279+28
 2407 01ea 0C88     		ldrh	r4, [r1]
 2408              	.LVL201:
 2409 01ec 3149     		ldr	r1, .L279+4
 2410 01ee 0968     		ldr	r1, [r1]
 2411 01f0 1D88     		ldrh	r5, [r3]	@ unaligned
 2412 01f2 0195     		str	r5, [sp, #4]
 2413 01f4 5B88     		ldrh	r3, [r3, #2]	@ unaligned
 2414 01f6 0093     		str	r3, [sp]
 2415 01f8 1346     		mov	r3, r2
 2416 01fa 0432     		adds	r2, r2, #4
 2417 01fc 2144     		add	r1, r1, r4
 2418 01fe FFF7FEFF 		bl	tcp_rst
 2419              	.LVL202:
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2420              		.loc 1 936 0
 2421 0202 0025     		movs	r5, #0
 2422 0204 16E7     		b	.L196
 2423              	.LVL203:
 2424              	.L263:
 817:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_DEBUG, ("TCP connection established %"U16_F" -> %"U16_F".\n", inseg.tcphdr-
 2425              		.loc 1 817 0
 2426 0206 0423     		movs	r3, #4
 2427 0208 2375     		strb	r3, [r4, #20]
 820:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           (pcb->listener == NULL) || (pcb->listener->accept != NULL));
 2428              		.loc 1 820 0
 2429 020a A36F     		ldr	r3, [r4, #120]
 822:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* listen pcb might be closed by now */
 2430              		.loc 1 822 0
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 82


 2431 020c 8BB1     		cbz	r3, .L237
 830:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 2432              		.loc 1 830 0 discriminator 1
 2433 020e 9B69     		ldr	r3, [r3, #24]
 2434 0210 93B1     		cbz	r3, .L238
 830:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 2435              		.loc 1 830 0 is_stmt 0 discriminator 3
 2436 0212 0022     		movs	r2, #0
 2437 0214 2146     		mov	r1, r4
 2438 0216 2069     		ldr	r0, [r4, #16]
 2439 0218 9847     		blx	r3
 2440              	.LVL204:
 2441 021a 0546     		mov	r5, r0
 2442              	.LVL205:
 2443              	.L215:
 832:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* If the accept function returns with an error, we abort
 2444              		.loc 1 832 0 is_stmt 1
 2445 021c 7DB1     		cbz	r5, .L216
 836:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             tcp_abort(pcb);
 2446              		.loc 1 836 0
 2447 021e 15F10D0F 		cmn	r5, #13
 2448 0222 3FF407AF 		beq	.L196
 837:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 2449              		.loc 1 837 0
 2450 0226 2046     		mov	r0, r4
 2451 0228 FFF7FEFF 		bl	tcp_abort
 2452              	.LVL206:
 839:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 2453              		.loc 1 839 0
 2454 022c 6FF00C05 		mvn	r5, #12
 2455              	.LVL207:
 2456 0230 00E7     		b	.L196
 2457              	.LVL208:
 2458              	.L237:
 824:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         } else
 2459              		.loc 1 824 0
 2460 0232 6FF00505 		mvn	r5, #5
 2461 0236 F1E7     		b	.L215
 2462              	.L238:
 830:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 2463              		.loc 1 830 0
 2464 0238 6FF00F05 		mvn	r5, #15
 2465 023c EEE7     		b	.L215
 2466              	.LVL209:
 2467              	.L216:
 843:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 2468              		.loc 1 843 0
 2469 023e 2046     		mov	r0, r4
 2470 0240 FFF7FEFF 		bl	tcp_receive
 2471              	.LVL210:
 848:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 2472              		.loc 1 848 0
 2473 0244 B4F85C30 		ldrh	r3, [r4, #92]
 2474 0248 A4F84A30 		strh	r3, [r4, #74]	@ movhi
 851:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           recv_acked--;
 2475              		.loc 1 851 0
 2476 024c 204B     		ldr	r3, .L279+32
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 83


 2477 024e 1B88     		ldrh	r3, [r3]
 2478 0250 13B1     		cbz	r3, .L217
 852:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 2479              		.loc 1 852 0
 2480 0252 013B     		subs	r3, r3, #1
 2481 0254 1E4A     		ldr	r2, .L279+32
 2482 0256 1380     		strh	r3, [r2]	@ movhi
 2483              	.L217:
 855:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_CWND_DEBUG, ("tcp_process (SYN_RCVD): cwnd %"TCPWNDSIZE_F
 2484              		.loc 1 855 0
 2485 0258 628E     		ldrh	r2, [r4, #50]
 2486 025a 5300     		lsls	r3, r2, #1
 2487 025c 41F21C11 		movw	r1, #4380
 2488 0260 8B42     		cmp	r3, r1
 2489 0262 38BF     		it	cc
 2490 0264 0B46     		movcc	r3, r1
 2491 0266 9200     		lsls	r2, r2, #2
 2492 0268 9342     		cmp	r3, r2
 2493 026a 28BF     		it	cs
 2494 026c 1346     		movcs	r3, r2
 2495 026e A4F84830 		strh	r3, [r4, #72]	@ movhi
 860:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           tcp_ack_now(pcb);
 2496              		.loc 1 860 0
 2497 0272 124B     		ldr	r3, .L279+12
 2498 0274 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2499 0276 13F0200F 		tst	r3, #32
 2500 027a 3FF4DBAE 		beq	.L196
 861:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->state = CLOSE_WAIT;
 2501              		.loc 1 861 0
 2502 027e A37E     		ldrb	r3, [r4, #26]	@ zero_extendqisi2
 2503 0280 43F00203 		orr	r3, r3, #2
 2504 0284 A376     		strb	r3, [r4, #26]
 862:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 2505              		.loc 1 862 0
 2506 0286 0723     		movs	r3, #7
 2507 0288 2375     		strb	r3, [r4, #20]
 2508 028a D3E6     		b	.L196
 2509              	.LVL211:
 2510              	.L213:
 869:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Looks like another copy of the SYN - retransmit our SYN-ACK */
 2511              		.loc 1 869 0
 2512 028c 13F0020F 		tst	r3, #2
 2513 0290 00F00481 		beq	.L239
 869:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Looks like another copy of the SYN - retransmit our SYN-ACK */
 2514              		.loc 1 869 0 is_stmt 0 discriminator 1
 2515 0294 636A     		ldr	r3, [r4, #36]
 2516 0296 013B     		subs	r3, r3, #1
 2517 0298 064A     		ldr	r2, .L279+4
 2518 029a 1268     		ldr	r2, [r2]
 2519 029c 9342     		cmp	r3, r2
 2520 029e 01D0     		beq	.L264
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2521              		.loc 1 936 0 is_stmt 1
 2522 02a0 0025     		movs	r5, #0
 2523 02a2 C7E6     		b	.L196
 2524              	.L264:
 871:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 84


 2525              		.loc 1 871 0
 2526 02a4 2046     		mov	r0, r4
 2527 02a6 FFF7FEFF 		bl	tcp_rexmit
 2528              	.LVL212:
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2529              		.loc 1 936 0
 2530 02aa 0025     		movs	r5, #0
 2531 02ac C2E6     		b	.L196
 2532              	.L280:
 2533 02ae 00BF     		.align	2
 2534              	.L279:
 2535 02b0 00000000 		.word	.LANCHOR5
 2536 02b4 00000000 		.word	.LANCHOR6
 2537 02b8 00000000 		.word	.LANCHOR8
 2538 02bc 00000000 		.word	.LANCHOR12
 2539 02c0 00000000 		.word	tcp_ticks
 2540 02c4 00000000 		.word	.LANCHOR3
 2541 02c8 10000000 		.word	ip_data+16
 2542 02cc 00000000 		.word	.LANCHOR7
 2543 02d0 00000000 		.word	.LANCHOR9
 2544              	.L202:
 877:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (recv_flags & TF_GOT_FIN) { /* passive close */
 2545              		.loc 1 877 0
 2546 02d4 2046     		mov	r0, r4
 2547 02d6 FFF7FEFF 		bl	tcp_receive
 2548              	.LVL213:
 878:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_ack_now(pcb);
 2549              		.loc 1 878 0
 2550 02da 754B     		ldr	r3, .L281
 2551 02dc 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2552 02de 13F0200F 		tst	r3, #32
 2553 02e2 00F0DD80 		beq	.L241
 879:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = CLOSE_WAIT;
 2554              		.loc 1 879 0
 2555 02e6 A37E     		ldrb	r3, [r4, #26]	@ zero_extendqisi2
 2556 02e8 43F00203 		orr	r3, r3, #2
 2557 02ec A376     		strb	r3, [r4, #26]
 880:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 2558              		.loc 1 880 0
 2559 02ee 0723     		movs	r3, #7
 2560 02f0 2375     		strb	r3, [r4, #20]
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2561              		.loc 1 936 0
 2562 02f2 0025     		movs	r5, #0
 2563 02f4 9EE6     		b	.L196
 2564              	.L203:
 884:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (recv_flags & TF_GOT_FIN) {
 2565              		.loc 1 884 0
 2566 02f6 2046     		mov	r0, r4
 2567 02f8 FFF7FEFF 		bl	tcp_receive
 2568              	.LVL214:
 885:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if ((flags & TCP_ACK) && (ackno == pcb->snd_nxt) &&
 2569              		.loc 1 885 0
 2570 02fc 6C4B     		ldr	r3, .L281
 2571 02fe 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2572 0300 13F0200F 		tst	r3, #32
 2573 0304 38D0     		beq	.L218
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 85


 886:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->unsent == NULL) {
 2574              		.loc 1 886 0
 2575 0306 6B4B     		ldr	r3, .L281+4
 2576 0308 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2577 030a 13F0100F 		tst	r3, #16
 2578 030e 04D0     		beq	.L219
 886:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->unsent == NULL) {
 2579              		.loc 1 886 0 is_stmt 0 discriminator 1
 2580 0310 E26C     		ldr	r2, [r4, #76]
 2581 0312 694B     		ldr	r3, .L281+8
 2582 0314 1B68     		ldr	r3, [r3]
 2583 0316 9A42     		cmp	r2, r3
 2584 0318 07D0     		beq	.L265
 2585              	.L219:
 896:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = CLOSING;
 2586              		.loc 1 896 0 is_stmt 1
 2587 031a A37E     		ldrb	r3, [r4, #26]	@ zero_extendqisi2
 2588 031c 43F00203 		orr	r3, r3, #2
 2589 0320 A376     		strb	r3, [r4, #26]
 897:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 2590              		.loc 1 897 0
 2591 0322 0823     		movs	r3, #8
 2592 0324 2375     		strb	r3, [r4, #20]
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2593              		.loc 1 936 0
 2594 0326 0025     		movs	r5, #0
 2595 0328 84E6     		b	.L196
 2596              	.L265:
 887:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         LWIP_DEBUGF(TCP_DEBUG,
 2597              		.loc 1 887 0 discriminator 2
 2598 032a A36E     		ldr	r3, [r4, #104]
 886:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->unsent == NULL) {
 2599              		.loc 1 886 0 discriminator 2
 2600 032c 002B     		cmp	r3, #0
 2601 032e F4D1     		bne	.L219
 890:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_pcb_purge(pcb);
 2602              		.loc 1 890 0
 2603 0330 A37E     		ldrb	r3, [r4, #26]	@ zero_extendqisi2
 2604 0332 43F00203 		orr	r3, r3, #2
 2605 0336 A376     		strb	r3, [r4, #26]
 891:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCP_RMV_ACTIVE(pcb);
 2606              		.loc 1 891 0
 2607 0338 2046     		mov	r0, r4
 2608 033a FFF7FEFF 		bl	tcp_pcb_purge
 2609              	.LVL215:
 892:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = TIME_WAIT;
 2610              		.loc 1 892 0
 2611 033e 5F4B     		ldr	r3, .L281+12
 2612 0340 1B68     		ldr	r3, [r3]
 2613 0342 9C42     		cmp	r4, r3
 2614 0344 05D0     		beq	.L266
 2615              	.L220:
 2616              	.LVL216:
 2617              	.LBB10:
 892:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = TIME_WAIT;
 2618              		.loc 1 892 0 is_stmt 0 discriminator 8
 2619 0346 53B1     		cbz	r3, .L221
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 86


 892:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = TIME_WAIT;
 2620              		.loc 1 892 0 discriminator 9
 2621 0348 DA68     		ldr	r2, [r3, #12]
 2622 034a 9442     		cmp	r4, r2
 2623 034c 05D0     		beq	.L267
 892:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = TIME_WAIT;
 2624              		.loc 1 892 0
 2625 034e 1346     		mov	r3, r2
 2626              	.LVL217:
 2627 0350 F9E7     		b	.L220
 2628              	.L266:
 2629              	.LBE10:
 892:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = TIME_WAIT;
 2630              		.loc 1 892 0 discriminator 1
 2631 0352 DA68     		ldr	r2, [r3, #12]
 2632 0354 594B     		ldr	r3, .L281+12
 2633 0356 1A60     		str	r2, [r3]
 2634 0358 01E0     		b	.L221
 2635              	.LVL218:
 2636              	.L267:
 2637              	.LBB11:
 892:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = TIME_WAIT;
 2638              		.loc 1 892 0 discriminator 5
 2639 035a E268     		ldr	r2, [r4, #12]
 2640 035c DA60     		str	r2, [r3, #12]
 2641              	.LVL219:
 2642              	.L221:
 2643              	.LBE11:
 892:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->state = TIME_WAIT;
 2644              		.loc 1 892 0 discriminator 10
 2645 035e 0122     		movs	r2, #1
 2646 0360 574B     		ldr	r3, .L281+16
 2647 0362 1A70     		strb	r2, [r3]
 893:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         TCP_REG(&tcp_tw_pcbs, pcb);
 2648              		.loc 1 893 0 is_stmt 1 discriminator 10
 2649 0364 0A23     		movs	r3, #10
 2650 0366 2375     		strb	r3, [r4, #20]
 894:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 2651              		.loc 1 894 0 discriminator 10
 2652 0368 564B     		ldr	r3, .L281+20
 2653 036a 1A68     		ldr	r2, [r3]
 2654 036c E260     		str	r2, [r4, #12]
 2655 036e 1C60     		str	r4, [r3]
 2656 0370 FFF7FEFF 		bl	tcp_timer_needed
 2657              	.LVL220:
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2658              		.loc 1 936 0 discriminator 10
 2659 0374 0025     		movs	r5, #0
 894:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 2660              		.loc 1 894 0 discriminator 10
 2661 0376 5DE6     		b	.L196
 2662              	.L218:
 899:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                pcb->unsent == NULL) {
 2663              		.loc 1 899 0
 2664 0378 4E4B     		ldr	r3, .L281+4
 2665 037a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2666 037c 13F0100F 		tst	r3, #16
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 87


 2667 0380 00F09080 		beq	.L243
 899:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                pcb->unsent == NULL) {
 2668              		.loc 1 899 0 is_stmt 0 discriminator 1
 2669 0384 E26C     		ldr	r2, [r4, #76]
 2670 0386 4C4B     		ldr	r3, .L281+8
 2671 0388 1B68     		ldr	r3, [r3]
 2672 038a 9A42     		cmp	r2, r3
 2673 038c 01D0     		beq	.L268
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2674              		.loc 1 936 0 is_stmt 1
 2675 038e 0025     		movs	r5, #0
 2676 0390 50E6     		b	.L196
 2677              	.L268:
 900:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = FIN_WAIT_2;
 2678              		.loc 1 900 0 discriminator 2
 2679 0392 A36E     		ldr	r3, [r4, #104]
 899:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****                pcb->unsent == NULL) {
 2680              		.loc 1 899 0 discriminator 2
 2681 0394 0BB1     		cbz	r3, .L269
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2682              		.loc 1 936 0
 2683 0396 0025     		movs	r5, #0
 2684 0398 4CE6     		b	.L196
 2685              	.L269:
 901:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 2686              		.loc 1 901 0
 2687 039a 0623     		movs	r3, #6
 2688 039c 2375     		strb	r3, [r4, #20]
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2689              		.loc 1 936 0
 2690 039e 0025     		movs	r5, #0
 2691 03a0 48E6     		b	.L196
 2692              	.L204:
 905:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (recv_flags & TF_GOT_FIN) {
 2693              		.loc 1 905 0
 2694 03a2 2046     		mov	r0, r4
 2695 03a4 FFF7FEFF 		bl	tcp_receive
 2696              	.LVL221:
 906:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("TCP connection closed: FIN_WAIT_2 %"U16_F" -> %"U16_F".\n", inseg.tc
 2697              		.loc 1 906 0
 2698 03a8 414B     		ldr	r3, .L281
 2699 03aa 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2700 03ac 13F0200F 		tst	r3, #32
 2701 03b0 01D1     		bne	.L270
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2702              		.loc 1 936 0
 2703 03b2 0025     		movs	r5, #0
 2704 03b4 3EE6     		b	.L196
 2705              	.L270:
 908:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       tcp_pcb_purge(pcb);
 2706              		.loc 1 908 0
 2707 03b6 A37E     		ldrb	r3, [r4, #26]	@ zero_extendqisi2
 2708 03b8 43F00203 		orr	r3, r3, #2
 2709 03bc A376     		strb	r3, [r4, #26]
 909:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_RMV_ACTIVE(pcb);
 2710              		.loc 1 909 0
 2711 03be 2046     		mov	r0, r4
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 88


 2712 03c0 FFF7FEFF 		bl	tcp_pcb_purge
 2713              	.LVL222:
 910:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2714              		.loc 1 910 0
 2715 03c4 3D4B     		ldr	r3, .L281+12
 2716 03c6 1B68     		ldr	r3, [r3]
 2717 03c8 9C42     		cmp	r4, r3
 2718 03ca 05D0     		beq	.L271
 2719              	.L223:
 2720              	.LVL223:
 2721              	.LBB12:
 910:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2722              		.loc 1 910 0 is_stmt 0 discriminator 8
 2723 03cc 53B1     		cbz	r3, .L224
 910:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2724              		.loc 1 910 0 discriminator 9
 2725 03ce DA68     		ldr	r2, [r3, #12]
 2726 03d0 9442     		cmp	r4, r2
 2727 03d2 05D0     		beq	.L272
 910:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2728              		.loc 1 910 0
 2729 03d4 1346     		mov	r3, r2
 2730              	.LVL224:
 2731 03d6 F9E7     		b	.L223
 2732              	.L271:
 2733              	.LBE12:
 910:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2734              		.loc 1 910 0 discriminator 1
 2735 03d8 DA68     		ldr	r2, [r3, #12]
 2736 03da 384B     		ldr	r3, .L281+12
 2737 03dc 1A60     		str	r2, [r3]
 2738 03de 01E0     		b	.L224
 2739              	.LVL225:
 2740              	.L272:
 2741              	.LBB13:
 910:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2742              		.loc 1 910 0 discriminator 5
 2743 03e0 E268     		ldr	r2, [r4, #12]
 2744 03e2 DA60     		str	r2, [r3, #12]
 2745              	.LVL226:
 2746              	.L224:
 2747              	.LBE13:
 910:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2748              		.loc 1 910 0 discriminator 10
 2749 03e4 0122     		movs	r2, #1
 2750 03e6 364B     		ldr	r3, .L281+16
 2751 03e8 1A70     		strb	r2, [r3]
 911:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_REG(&tcp_tw_pcbs, pcb);
 2752              		.loc 1 911 0 is_stmt 1 discriminator 10
 2753 03ea 0A23     		movs	r3, #10
 2754 03ec 2375     		strb	r3, [r4, #20]
 912:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 2755              		.loc 1 912 0 discriminator 10
 2756 03ee 354B     		ldr	r3, .L281+20
 2757 03f0 1A68     		ldr	r2, [r3]
 2758 03f2 E260     		str	r2, [r4, #12]
 2759 03f4 1C60     		str	r4, [r3]
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 89


 2760 03f6 FFF7FEFF 		bl	tcp_timer_needed
 2761              	.LVL227:
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2762              		.loc 1 936 0 discriminator 10
 2763 03fa 0025     		movs	r5, #0
 2764 03fc 1AE6     		b	.L196
 2765              	.L205:
 916:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (flags & TCP_ACK && ackno == pcb->snd_nxt && pcb->unsent == NULL) {
 2766              		.loc 1 916 0
 2767 03fe 2046     		mov	r0, r4
 2768 0400 FFF7FEFF 		bl	tcp_receive
 2769              	.LVL228:
 917:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("TCP connection closed: CLOSING %"U16_F" -> %"U16_F".\n", inseg.tcphd
 2770              		.loc 1 917 0
 2771 0404 2B4B     		ldr	r3, .L281+4
 2772 0406 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2773 0408 13F0100F 		tst	r3, #16
 2774 040c 4CD0     		beq	.L248
 917:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("TCP connection closed: CLOSING %"U16_F" -> %"U16_F".\n", inseg.tcphd
 2775              		.loc 1 917 0 is_stmt 0 discriminator 1
 2776 040e E26C     		ldr	r2, [r4, #76]
 2777 0410 294B     		ldr	r3, .L281+8
 2778 0412 1B68     		ldr	r3, [r3]
 2779 0414 9A42     		cmp	r2, r3
 2780 0416 01D0     		beq	.L273
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2781              		.loc 1 936 0 is_stmt 1
 2782 0418 0025     		movs	r5, #0
 2783 041a 0BE6     		b	.L196
 2784              	.L273:
 917:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("TCP connection closed: CLOSING %"U16_F" -> %"U16_F".\n", inseg.tcphd
 2785              		.loc 1 917 0 discriminator 2
 2786 041c A36E     		ldr	r3, [r4, #104]
 2787 041e 0BB1     		cbz	r3, .L274
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2788              		.loc 1 936 0
 2789 0420 0025     		movs	r5, #0
 2790 0422 07E6     		b	.L196
 2791              	.L274:
 919:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_RMV_ACTIVE(pcb);
 2792              		.loc 1 919 0
 2793 0424 2046     		mov	r0, r4
 2794 0426 FFF7FEFF 		bl	tcp_pcb_purge
 2795              	.LVL229:
 920:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2796              		.loc 1 920 0
 2797 042a 244B     		ldr	r3, .L281+12
 2798 042c 1B68     		ldr	r3, [r3]
 2799 042e 9C42     		cmp	r4, r3
 2800 0430 05D0     		beq	.L275
 2801              	.L226:
 2802              	.LVL230:
 2803              	.LBB14:
 920:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2804              		.loc 1 920 0 is_stmt 0 discriminator 8
 2805 0432 53B1     		cbz	r3, .L227
 920:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 90


 2806              		.loc 1 920 0 discriminator 9
 2807 0434 DA68     		ldr	r2, [r3, #12]
 2808 0436 9442     		cmp	r4, r2
 2809 0438 05D0     		beq	.L276
 920:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2810              		.loc 1 920 0
 2811 043a 1346     		mov	r3, r2
 2812              	.LVL231:
 2813 043c F9E7     		b	.L226
 2814              	.L275:
 2815              	.LBE14:
 920:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2816              		.loc 1 920 0 discriminator 1
 2817 043e DA68     		ldr	r2, [r3, #12]
 2818 0440 1E4B     		ldr	r3, .L281+12
 2819 0442 1A60     		str	r2, [r3]
 2820 0444 01E0     		b	.L227
 2821              	.LVL232:
 2822              	.L276:
 2823              	.LBB15:
 920:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2824              		.loc 1 920 0 discriminator 5
 2825 0446 E268     		ldr	r2, [r4, #12]
 2826 0448 DA60     		str	r2, [r3, #12]
 2827              	.LVL233:
 2828              	.L227:
 2829              	.LBE15:
 920:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pcb->state = TIME_WAIT;
 2830              		.loc 1 920 0 discriminator 10
 2831 044a 0122     		movs	r2, #1
 2832 044c 1C4B     		ldr	r3, .L281+16
 2833 044e 1A70     		strb	r2, [r3]
 921:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_REG(&tcp_tw_pcbs, pcb);
 2834              		.loc 1 921 0 is_stmt 1 discriminator 10
 2835 0450 0A23     		movs	r3, #10
 2836 0452 2375     		strb	r3, [r4, #20]
 922:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 2837              		.loc 1 922 0 discriminator 10
 2838 0454 1B4B     		ldr	r3, .L281+20
 2839 0456 1A68     		ldr	r2, [r3]
 2840 0458 E260     		str	r2, [r4, #12]
 2841 045a 1C60     		str	r4, [r3]
 2842 045c FFF7FEFF 		bl	tcp_timer_needed
 2843              	.LVL234:
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2844              		.loc 1 936 0 discriminator 10
 2845 0460 0025     		movs	r5, #0
 2846 0462 E7E5     		b	.L196
 2847              	.L206:
 926:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     if (flags & TCP_ACK && ackno == pcb->snd_nxt && pcb->unsent == NULL) {
 2848              		.loc 1 926 0
 2849 0464 2046     		mov	r0, r4
 2850 0466 FFF7FEFF 		bl	tcp_receive
 2851              	.LVL235:
 927:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("TCP connection closed: LAST_ACK %"U16_F" -> %"U16_F".\n", inseg.tcph
 2852              		.loc 1 927 0
 2853 046a 124B     		ldr	r3, .L281+4
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 91


 2854 046c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2855 046e 13F0100F 		tst	r3, #16
 2856 0472 1BD0     		beq	.L252
 927:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("TCP connection closed: LAST_ACK %"U16_F" -> %"U16_F".\n", inseg.tcph
 2857              		.loc 1 927 0 is_stmt 0 discriminator 1
 2858 0474 E26C     		ldr	r2, [r4, #76]
 2859 0476 104B     		ldr	r3, .L281+8
 2860 0478 1B68     		ldr	r3, [r3]
 2861 047a 9A42     		cmp	r2, r3
 2862 047c 01D0     		beq	.L277
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2863              		.loc 1 936 0 is_stmt 1
 2864 047e 0025     		movs	r5, #0
 2865 0480 D8E5     		b	.L196
 2866              	.L277:
 927:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_DEBUGF(TCP_DEBUG, ("TCP connection closed: LAST_ACK %"U16_F" -> %"U16_F".\n", inseg.tcph
 2867              		.loc 1 927 0 discriminator 2
 2868 0482 A36E     		ldr	r3, [r4, #104]
 2869 0484 0BB1     		cbz	r3, .L278
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2870              		.loc 1 936 0
 2871 0486 0025     		movs	r5, #0
 2872 0488 D4E5     		b	.L196
 2873              	.L278:
 930:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 2874              		.loc 1 930 0
 2875 048a 094A     		ldr	r2, .L281
 2876 048c 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 2877 048e 43F01003 		orr	r3, r3, #16
 2878 0492 1370     		strb	r3, [r2]
 936:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 2879              		.loc 1 936 0
 2880 0494 0025     		movs	r5, #0
 2881 0496 CDE5     		b	.L196
 2882              	.L234:
 2883 0498 0025     		movs	r5, #0
 2884 049a CBE5     		b	.L196
 2885              	.L239:
 2886 049c 0025     		movs	r5, #0
 2887 049e C9E5     		b	.L196
 2888              	.L241:
 2889 04a0 0025     		movs	r5, #0
 2890 04a2 C7E5     		b	.L196
 2891              	.L243:
 2892 04a4 0025     		movs	r5, #0
 2893 04a6 C5E5     		b	.L196
 2894              	.L248:
 2895 04a8 0025     		movs	r5, #0
 2896 04aa C3E5     		b	.L196
 2897              	.L252:
 2898 04ac 0025     		movs	r5, #0
 2899 04ae C1E5     		b	.L196
 2900              	.L282:
 2901              		.align	2
 2902              	.L281:
 2903 04b0 00000000 		.word	.LANCHOR12
 2904 04b4 00000000 		.word	.LANCHOR5
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 92


 2905 04b8 00000000 		.word	.LANCHOR8
 2906 04bc 00000000 		.word	tcp_active_pcbs
 2907 04c0 00000000 		.word	tcp_active_pcbs_changed
 2908 04c4 00000000 		.word	tcp_tw_pcbs
 2909              		.cfi_endproc
 2910              	.LFE139:
 2912              		.section	.text.tcp_input,"ax",%progbits
 2913              		.align	1
 2914              		.global	tcp_input
 2915              		.syntax unified
 2916              		.thumb
 2917              		.thumb_func
 2918              		.fpu fpv5-sp-d16
 2920              	tcp_input:
 2921              	.LFB136:
 105:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   struct tcp_pcb *pcb, *prev;
 2922              		.loc 1 105 0
 2923              		.cfi_startproc
 2924              		@ args = 0, pretend = 0, frame = 0
 2925              		@ frame_needed = 0, uses_anonymous_args = 0
 2926              	.LVL236:
 2927 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 2928              	.LCFI19:
 2929              		.cfi_def_cfa_offset 20
 2930              		.cfi_offset 4, -20
 2931              		.cfi_offset 5, -16
 2932              		.cfi_offset 6, -12
 2933              		.cfi_offset 7, -8
 2934              		.cfi_offset 14, -4
 2935 0002 83B0     		sub	sp, sp, #12
 2936              	.LCFI20:
 2937              		.cfi_def_cfa_offset 32
 2938 0004 0446     		mov	r4, r0
 122:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 2939              		.loc 1 122 0
 2940 0006 4268     		ldr	r2, [r0, #4]
 2941 0008 8F4B     		ldr	r3, .L329
 2942 000a 1A60     		str	r2, [r3]
 129:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* drop short packets */
 2943              		.loc 1 129 0
 2944 000c 4389     		ldrh	r3, [r0, #10]
 2945 000e 132B     		cmp	r3, #19
 2946 0010 74D9     		bls	.L284
 137:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       ip_addr_ismulticast(ip_current_dest_addr())) {
 2947              		.loc 1 137 0
 2948 0012 8E4B     		ldr	r3, .L329+4
 2949 0014 1968     		ldr	r1, [r3]
 2950              	.LVL237:
 2951 0016 5869     		ldr	r0, [r3, #20]
 2952              	.LVL238:
 2953 0018 FFF7FEFF 		bl	ip4_addr_isbroadcast_u32
 2954              	.LVL239:
 2955 001c 0028     		cmp	r0, #0
 2956 001e 6DD1     		bne	.L284
 138:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     TCP_STATS_INC(tcp.proterr);
 2957              		.loc 1 138 0 discriminator 1
 2958 0020 8A4B     		ldr	r3, .L329+4
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 93


 2959 0022 5B69     		ldr	r3, [r3, #20]
 2960 0024 03F0F003 		and	r3, r3, #240
 137:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       ip_addr_ismulticast(ip_current_dest_addr())) {
 2961              		.loc 1 137 0 discriminator 1
 2962 0028 E02B     		cmp	r3, #224
 2963 002a 67D0     		beq	.L284
 159:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if ((hdrlen_bytes < TCP_HLEN) || (hdrlen_bytes > p->tot_len)) {
 2964              		.loc 1 159 0
 2965 002c 864B     		ldr	r3, .L329
 2966 002e 1B68     		ldr	r3, [r3]
 2967 0030 9889     		ldrh	r0, [r3, #12]	@ unaligned
 2968 0032 FFF7FEFF 		bl	lwip_htons
 2969              	.LVL240:
 2970 0036 C0F30F31 		ubfx	r1, r0, #12, #16
 2971 003a 8900     		lsls	r1, r1, #2
 2972 003c C9B2     		uxtb	r1, r1
 2973              	.LVL241:
 160:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_input: invalid header length (%"U16_F")\n", (u16_t)hdrlen_by
 2974              		.loc 1 160 0
 2975 003e 1329     		cmp	r1, #19
 2976 0040 5CD9     		bls	.L284
 160:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_input: invalid header length (%"U16_F")\n", (u16_t)hdrlen_by
 2977              		.loc 1 160 0 is_stmt 0 discriminator 1
 2978 0042 89B2     		uxth	r1, r1
 2979              	.LVL242:
 2980 0044 2389     		ldrh	r3, [r4, #8]
 2981 0046 9942     		cmp	r1, r3
 2982 0048 58D8     		bhi	.L284
 168:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcphdr_opt2 = NULL;
 2983              		.loc 1 168 0 is_stmt 1
 2984 004a A1F11403 		sub	r3, r1, #20
 2985 004e 9BB2     		uxth	r3, r3
 2986 0050 7F4A     		ldr	r2, .L329+8
 2987 0052 1380     		strh	r3, [r2]	@ movhi
 169:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   if (p->len >= hdrlen_bytes) {
 2988              		.loc 1 169 0
 2989 0054 0020     		movs	r0, #0
 2990              	.LVL243:
 2991 0056 7F4A     		ldr	r2, .L329+12
 2992 0058 1060     		str	r0, [r2]
 170:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* all options are in the first pbuf */
 2993              		.loc 1 170 0
 2994 005a 6289     		ldrh	r2, [r4, #10]
 2995 005c 9142     		cmp	r1, r2
 2996 005e 38D8     		bhi	.L285
 172:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     pbuf_header(p, -(s16_t)hdrlen_bytes); /* cannot fail */
 2997              		.loc 1 172 0
 2998 0060 7D4A     		ldr	r2, .L329+16
 2999 0062 1380     		strh	r3, [r2]	@ movhi
 173:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   } else {
 3000              		.loc 1 173 0
 3001 0064 4942     		negs	r1, r1
 3002 0066 2046     		mov	r0, r4
 3003 0068 FFF7FEFF 		bl	pbuf_header
 3004              	.LVL244:
 3005              	.L286:
 212:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcphdr->dest = lwip_ntohs(tcphdr->dest);
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 94


 3006              		.loc 1 212 0
 3007 006c 764D     		ldr	r5, .L329
 3008 006e 2E68     		ldr	r6, [r5]
 3009 0070 3088     		ldrh	r0, [r6]	@ unaligned
 3010 0072 FFF7FEFF 		bl	lwip_htons
 3011              	.LVL245:
 3012 0076 3080     		strh	r0, [r6]	@ unaligned
 213:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   seqno = tcphdr->seqno = lwip_ntohl(tcphdr->seqno);
 3013              		.loc 1 213 0
 3014 0078 2E68     		ldr	r6, [r5]
 3015 007a 7088     		ldrh	r0, [r6, #2]	@ unaligned
 3016 007c FFF7FEFF 		bl	lwip_htons
 3017              	.LVL246:
 3018 0080 7080     		strh	r0, [r6, #2]	@ unaligned
 214:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   ackno = tcphdr->ackno = lwip_ntohl(tcphdr->ackno);
 3019              		.loc 1 214 0
 3020 0082 2E68     		ldr	r6, [r5]
 3021 0084 7068     		ldr	r0, [r6, #4]	@ unaligned
 3022 0086 FFF7FEFF 		bl	lwip_htonl
 3023              	.LVL247:
 3024 008a 7060     		str	r0, [r6, #4]	@ unaligned
 3025 008c 734B     		ldr	r3, .L329+20
 3026 008e 1860     		str	r0, [r3]
 215:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcphdr->wnd = lwip_ntohs(tcphdr->wnd);
 3027              		.loc 1 215 0
 3028 0090 2E68     		ldr	r6, [r5]
 3029 0092 B068     		ldr	r0, [r6, #8]	@ unaligned
 3030 0094 FFF7FEFF 		bl	lwip_htonl
 3031              	.LVL248:
 3032 0098 B060     		str	r0, [r6, #8]	@ unaligned
 3033 009a 714B     		ldr	r3, .L329+24
 3034 009c 1860     		str	r0, [r3]
 216:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 3035              		.loc 1 216 0
 3036 009e 2E68     		ldr	r6, [r5]
 3037 00a0 F089     		ldrh	r0, [r6, #14]	@ unaligned
 3038 00a2 FFF7FEFF 		bl	lwip_htons
 3039              	.LVL249:
 3040 00a6 F081     		strh	r0, [r6, #14]	@ unaligned
 218:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   tcplen = p->tot_len + ((flags & (TCP_FIN | TCP_SYN)) ? 1 : 0);
 3041              		.loc 1 218 0
 3042 00a8 2B68     		ldr	r3, [r5]
 3043 00aa 9889     		ldrh	r0, [r3, #12]	@ unaligned
 3044 00ac FFF7FEFF 		bl	lwip_htons
 3045              	.LVL250:
 3046 00b0 00F03F07 		and	r7, r0, #63
 3047 00b4 6B4B     		ldr	r3, .L329+28
 3048 00b6 1F70     		strb	r7, [r3]
 219:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 3049              		.loc 1 219 0
 3050 00b8 2389     		ldrh	r3, [r4, #8]
 3051 00ba 17F00302 		ands	r2, r7, #3
 3052 00be 18BF     		it	ne
 3053 00c0 0122     		movne	r2, #1
 3054 00c2 1344     		add	r3, r3, r2
 3055 00c4 684A     		ldr	r2, .L329+32
 3056 00c6 1380     		strh	r3, [r2]	@ movhi
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 95


 3057              	.LVL251:
 225:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_ASSERT("tcp_input: active pcb->state != CLOSED", pcb->state != CLOSED);
 3058              		.loc 1 225 0
 3059 00c8 684B     		ldr	r3, .L329+36
 3060 00ca 1868     		ldr	r0, [r3]
 3061              	.LVL252:
 3062 00cc 0546     		mov	r5, r0
 223:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 3063              		.loc 1 223 0
 3064 00ce 0026     		movs	r6, #0
 225:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_ASSERT("tcp_input: active pcb->state != CLOSED", pcb->state != CLOSED);
 3065              		.loc 1 225 0
 3066 00d0 26E0     		b	.L287
 3067              	.LVL253:
 3068              	.L285:
 3069              	.LBB16:
 181:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 3070              		.loc 1 181 0
 3071 00d2 6FF01301 		mvn	r1, #19
 3072 00d6 2046     		mov	r0, r4
 3073 00d8 FFF7FEFF 		bl	pbuf_header
 3074              	.LVL254:
 184:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     opt2len = tcphdr_optlen - tcphdr_opt1len;
 3075              		.loc 1 184 0
 3076 00dc 6189     		ldrh	r1, [r4, #10]
 3077 00de 5E4B     		ldr	r3, .L329+16
 3078 00e0 1980     		strh	r1, [r3]	@ movhi
 185:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 3079              		.loc 1 185 0
 3080 00e2 5B4B     		ldr	r3, .L329+8
 3081 00e4 1D88     		ldrh	r5, [r3]
 3082 00e6 6D1A     		subs	r5, r5, r1
 3083 00e8 ADB2     		uxth	r5, r5
 3084              	.LVL255:
 189:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 3085              		.loc 1 189 0
 3086 00ea 4942     		negs	r1, r1
 3087 00ec 09B2     		sxth	r1, r1
 3088 00ee 2046     		mov	r0, r4
 3089 00f0 FFF7FEFF 		bl	pbuf_header
 3090              	.LVL256:
 192:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* drop short packets */
 3091              		.loc 1 192 0
 3092 00f4 2068     		ldr	r0, [r4]
 3093 00f6 4389     		ldrh	r3, [r0, #10]
 3094 00f8 9D42     		cmp	r5, r3
 3095 00fa 04D9     		bls	.L324
 3096              	.LVL257:
 3097              	.L284:
 3098              	.LBE16:
 529:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
 3099              		.loc 1 529 0
 3100 00fc 2046     		mov	r0, r4
 3101 00fe FFF7FEFF 		bl	pbuf_free
 3102              	.LVL258:
 3103              	.L283:
 530:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 96


 3104              		.loc 1 530 0
 3105 0102 03B0     		add	sp, sp, #12
 3106              	.LCFI21:
 3107              		.cfi_remember_state
 3108              		.cfi_def_cfa_offset 20
 3109              		@ sp needed
 3110 0104 F0BD     		pop	{r4, r5, r6, r7, pc}
 3111              	.LVL259:
 3112              	.L324:
 3113              	.LCFI22:
 3114              		.cfi_restore_state
 3115              	.LBB17:
 200:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 3116              		.loc 1 200 0
 3117 0106 4268     		ldr	r2, [r0, #4]
 3118 0108 524B     		ldr	r3, .L329+12
 3119 010a 1A60     		str	r2, [r3]
 204:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     p->tot_len -= opt2len;
 3120              		.loc 1 204 0
 3121 010c 6942     		negs	r1, r5
 3122 010e 09B2     		sxth	r1, r1
 3123 0110 FFF7FEFF 		bl	pbuf_header
 3124              	.LVL260:
 205:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 3125              		.loc 1 205 0
 3126 0114 2389     		ldrh	r3, [r4, #8]
 3127 0116 5D1B     		subs	r5, r3, r5
 3128              	.LVL261:
 3129 0118 2581     		strh	r5, [r4, #8]	@ movhi
 3130 011a A7E7     		b	.L286
 3131              	.LVL262:
 3132              	.L288:
 3133              	.LBE17:
 247:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 3134              		.loc 1 247 0 discriminator 2
 3135 011c 2E46     		mov	r6, r5
 225:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_ASSERT("tcp_input: active pcb->state != CLOSED", pcb->state != CLOSED);
 3136              		.loc 1 225 0 discriminator 2
 3137 011e ED68     		ldr	r5, [r5, #12]
 3138              	.LVL263:
 3139              	.L287:
 225:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     LWIP_ASSERT("tcp_input: active pcb->state != CLOSED", pcb->state != CLOSED);
 3140              		.loc 1 225 0 is_stmt 0 discriminator 1
 3141 0120 CDB1     		cbz	r5, .L290
 229:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->local_port == tcphdr->dest &&
 3142              		.loc 1 229 0 is_stmt 1
 3143 0122 298B     		ldrh	r1, [r5, #24]
 3144 0124 484B     		ldr	r3, .L329
 3145 0126 1B68     		ldr	r3, [r3]
 3146 0128 1A88     		ldrh	r2, [r3]	@ unaligned
 3147 012a 9142     		cmp	r1, r2
 3148 012c F6D1     		bne	.L288
 230:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_addr_cmp(&pcb->remote_ip, ip_current_src_addr()) &&
 3149              		.loc 1 230 0 discriminator 1
 3150 012e EA8A     		ldrh	r2, [r5, #22]
 3151 0130 5B88     		ldrh	r3, [r3, #2]	@ unaligned
 229:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->local_port == tcphdr->dest &&
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 97


 3152              		.loc 1 229 0 discriminator 1
 3153 0132 9A42     		cmp	r2, r3
 3154 0134 F2D1     		bne	.L288
 231:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_addr_cmp(&pcb->local_ip, ip_current_dest_addr())) {
 3155              		.loc 1 231 0
 3156 0136 6A68     		ldr	r2, [r5, #4]
 3157 0138 444B     		ldr	r3, .L329+4
 3158 013a 1B69     		ldr	r3, [r3, #16]
 230:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_addr_cmp(&pcb->remote_ip, ip_current_src_addr()) &&
 3159              		.loc 1 230 0
 3160 013c 9A42     		cmp	r2, r3
 3161 013e EDD1     		bne	.L288
 232:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Move this PCB to the front of the list so that subsequent
 3162              		.loc 1 232 0
 3163 0140 2A68     		ldr	r2, [r5]
 3164 0142 424B     		ldr	r3, .L329+4
 3165 0144 5B69     		ldr	r3, [r3, #20]
 231:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_addr_cmp(&pcb->local_ip, ip_current_dest_addr())) {
 3166              		.loc 1 231 0
 3167 0146 9A42     		cmp	r2, r3
 3168 0148 E8D1     		bne	.L288
 236:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (prev != NULL) {
 3169              		.loc 1 236 0
 3170 014a EB68     		ldr	r3, [r5, #12]
 237:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         prev->next = pcb->next;
 3171              		.loc 1 237 0
 3172 014c 1EB1     		cbz	r6, .L290
 238:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pcb->next = tcp_active_pcbs;
 3173              		.loc 1 238 0
 3174 014e F360     		str	r3, [r6, #12]
 239:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_active_pcbs = pcb;
 3175              		.loc 1 239 0
 3176 0150 E860     		str	r0, [r5, #12]
 240:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 3177              		.loc 1 240 0
 3178 0152 464B     		ldr	r3, .L329+36
 3179 0154 1D60     		str	r5, [r3]
 3180              	.L290:
 250:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* If it did not go to an active connection, we check the connections
 3181              		.loc 1 250 0
 3182 0156 002D     		cmp	r5, #0
 3183 0158 51D0     		beq	.L325
 3184              	.LVL264:
 3185              	.L292:
 335:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* The incoming segment belongs to a connection. */
 3186              		.loc 1 335 0
 3187 015a 002D     		cmp	r5, #0
 3188 015c 00F02981 		beq	.L302
 342:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     inseg.len = p->tot_len;
 3189              		.loc 1 342 0
 3190 0160 434A     		ldr	r2, .L329+40
 3191 0162 0023     		movs	r3, #0
 3192 0164 1360     		str	r3, [r2]
 343:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     inseg.p = p;
 3193              		.loc 1 343 0
 3194 0166 2189     		ldrh	r1, [r4, #8]
 3195 0168 1181     		strh	r1, [r2, #8]	@ movhi
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 98


 344:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     inseg.tcphdr = tcphdr;
 3196              		.loc 1 344 0
 3197 016a 5460     		str	r4, [r2, #4]
 345:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 3198              		.loc 1 345 0
 3199 016c 3649     		ldr	r1, .L329
 3200 016e 0968     		ldr	r1, [r1]
 3201 0170 D160     		str	r1, [r2, #12]
 347:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     recv_flags = 0;
 3202              		.loc 1 347 0
 3203 0172 404A     		ldr	r2, .L329+44
 3204 0174 1360     		str	r3, [r2]
 348:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     recv_acked = 0;
 3205              		.loc 1 348 0
 3206 0176 404A     		ldr	r2, .L329+48
 3207 0178 1370     		strb	r3, [r2]
 349:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 3208              		.loc 1 349 0
 3209 017a 404A     		ldr	r2, .L329+52
 3210 017c 1380     		strh	r3, [r2]	@ movhi
 351:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       p->flags |= PBUF_FLAG_PUSH;
 3211              		.loc 1 351 0
 3212 017e 17F0080F 		tst	r7, #8
 3213 0182 03D0     		beq	.L303
 352:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 3214              		.loc 1 352 0
 3215 0184 637B     		ldrb	r3, [r4, #13]	@ zero_extendqisi2
 3216 0186 43F00103 		orr	r3, r3, #1
 3217 018a 6373     		strb	r3, [r4, #13]
 3218              	.L303:
 356:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if ((tcp_process_refused_data(pcb) == ERR_ABRT) ||
 3219              		.loc 1 356 0
 3220 018c 6B6F     		ldr	r3, [r5, #116]
 3221 018e 53B1     		cbz	r3, .L304
 357:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ((pcb->refused_data != NULL) && (tcplen > 0))) {
 3222              		.loc 1 357 0
 3223 0190 2846     		mov	r0, r5
 3224 0192 FFF7FEFF 		bl	tcp_process_refused_data
 3225              	.LVL265:
 3226 0196 10F10D0F 		cmn	r0, #13
 3227 019a 21D0     		beq	.L305
 358:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* pcb has been aborted or refused data is still refused and the new
 3228              		.loc 1 358 0 discriminator 1
 3229 019c 6B6F     		ldr	r3, [r5, #116]
 357:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ((pcb->refused_data != NULL) && (tcplen > 0))) {
 3230              		.loc 1 357 0 discriminator 1
 3231 019e 13B1     		cbz	r3, .L304
 358:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* pcb has been aborted or refused data is still refused and the new
 3232              		.loc 1 358 0
 3233 01a0 314B     		ldr	r3, .L329+32
 3234 01a2 1B88     		ldrh	r3, [r3]
 3235 01a4 E3B9     		cbnz	r3, .L305
 3236              	.L304:
 366:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     err = tcp_process(pcb);
 3237              		.loc 1 366 0
 3238 01a6 364B     		ldr	r3, .L329+56
 3239 01a8 1D60     		str	r5, [r3]
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 99


 367:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     /* A return value of ERR_ABRT means that tcp_abort() was called
 3240              		.loc 1 367 0
 3241 01aa 2846     		mov	r0, r5
 3242 01ac FFF7FEFF 		bl	tcp_process
 3243              	.LVL266:
 370:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (recv_flags & TF_RESET) {
 3244              		.loc 1 370 0
 3245 01b0 10F10D0F 		cmn	r0, #13
 3246 01b4 14D0     		beq	.L305
 371:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* TF_RESET means that the connection was reset by the other
 3247              		.loc 1 371 0
 3248 01b6 304B     		ldr	r3, .L329+48
 3249 01b8 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3250 01ba 13F0080F 		tst	r3, #8
 3251 01be 00F08580 		beq	.L306
 376:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_pcb_remove(&tcp_active_pcbs, pcb);
 3252              		.loc 1 376 0
 3253 01c2 D5F88C30 		ldr	r3, [r5, #140]
 3254 01c6 1BB1     		cbz	r3, .L307
 376:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         tcp_pcb_remove(&tcp_active_pcbs, pcb);
 3255              		.loc 1 376 0 is_stmt 0 discriminator 1
 3256 01c8 6FF00D01 		mvn	r1, #13
 3257 01cc 2869     		ldr	r0, [r5, #16]
 3258              	.LVL267:
 3259 01ce 9847     		blx	r3
 3260              	.LVL268:
 3261              	.L307:
 377:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         memp_free(MEMP_TCP_PCB, pcb);
 3262              		.loc 1 377 0 is_stmt 1
 3263 01d0 2946     		mov	r1, r5
 3264 01d2 2648     		ldr	r0, .L329+36
 3265 01d4 FFF7FEFF 		bl	tcp_pcb_remove
 3266              	.LVL269:
 378:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 3267              		.loc 1 378 0
 3268 01d8 2946     		mov	r1, r5
 3269 01da 0120     		movs	r0, #1
 3270 01dc FFF7FEFF 		bl	memp_free
 3271              	.LVL270:
 3272              	.L305:
 500:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     recv_data = NULL;
 3273              		.loc 1 500 0
 3274 01e0 0023     		movs	r3, #0
 3275 01e2 274A     		ldr	r2, .L329+56
 3276 01e4 1360     		str	r3, [r2]
 501:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
 3277              		.loc 1 501 0
 3278 01e6 234A     		ldr	r2, .L329+44
 3279 01e8 1360     		str	r3, [r2]
 504:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     {
 3280              		.loc 1 504 0
 3281 01ea 214B     		ldr	r3, .L329+40
 3282 01ec 5868     		ldr	r0, [r3, #4]
 3283 01ee 0028     		cmp	r0, #0
 3284 01f0 87D0     		beq	.L283
 506:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       inseg.p = NULL;
 3285              		.loc 1 506 0
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 100


 3286 01f2 FFF7FEFF 		bl	pbuf_free
 3287              	.LVL271:
 507:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 3288              		.loc 1 507 0
 3289 01f6 0022     		movs	r2, #0
 3290 01f8 1D4B     		ldr	r3, .L329+40
 3291 01fa 5A60     		str	r2, [r3, #4]
 3292 01fc 81E7     		b	.L283
 3293              	.LVL272:
 3294              	.L325:
 253:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("tcp_input: TIME-WAIT pcb->state == TIME-WAIT", pcb->state == TIME_WAIT);
 3295              		.loc 1 253 0
 3296 01fe 214B     		ldr	r3, .L329+60
 3297 0200 1D68     		ldr	r5, [r3]
 3298              	.LVL273:
 3299 0202 00E0     		b	.L293
 3300              	.L294:
 253:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("tcp_input: TIME-WAIT pcb->state == TIME-WAIT", pcb->state == TIME_WAIT);
 3301              		.loc 1 253 0 is_stmt 0 discriminator 2
 3302 0204 ED68     		ldr	r5, [r5, #12]
 3303              	.LVL274:
 3304              	.L293:
 253:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       LWIP_ASSERT("tcp_input: TIME-WAIT pcb->state == TIME-WAIT", pcb->state == TIME_WAIT);
 3305              		.loc 1 253 0 discriminator 1
 3306 0206 D5B1     		cbz	r5, .L326
 255:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->local_port == tcphdr->dest &&
 3307              		.loc 1 255 0 is_stmt 1
 3308 0208 298B     		ldrh	r1, [r5, #24]
 3309 020a 0F4B     		ldr	r3, .L329
 3310 020c 1B68     		ldr	r3, [r3]
 3311 020e 1A88     		ldrh	r2, [r3]	@ unaligned
 3312 0210 9142     		cmp	r1, r2
 3313 0212 F7D1     		bne	.L294
 256:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           ip_addr_cmp(&pcb->remote_ip, ip_current_src_addr()) &&
 3314              		.loc 1 256 0 discriminator 1
 3315 0214 EA8A     		ldrh	r2, [r5, #22]
 3316 0216 5B88     		ldrh	r3, [r3, #2]	@ unaligned
 255:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           pcb->local_port == tcphdr->dest &&
 3317              		.loc 1 255 0 discriminator 1
 3318 0218 9A42     		cmp	r2, r3
 3319 021a F3D1     		bne	.L294
 257:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           ip_addr_cmp(&pcb->local_ip, ip_current_dest_addr())) {
 3320              		.loc 1 257 0
 3321 021c 6A68     		ldr	r2, [r5, #4]
 3322 021e 0B4B     		ldr	r3, .L329+4
 3323 0220 1B69     		ldr	r3, [r3, #16]
 256:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           ip_addr_cmp(&pcb->remote_ip, ip_current_src_addr()) &&
 3324              		.loc 1 256 0
 3325 0222 9A42     		cmp	r2, r3
 3326 0224 EED1     		bne	.L294
 258:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* We don't really care enough to move this PCB to the front
 3327              		.loc 1 258 0
 3328 0226 2A68     		ldr	r2, [r5]
 3329 0228 084B     		ldr	r3, .L329+4
 3330 022a 5B69     		ldr	r3, [r3, #20]
 257:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           ip_addr_cmp(&pcb->local_ip, ip_current_dest_addr())) {
 3331              		.loc 1 257 0
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 101


 3332 022c 9A42     		cmp	r2, r3
 3333 022e E9D1     		bne	.L294
 263:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         pbuf_free(p);
 3334              		.loc 1 263 0
 3335 0230 2846     		mov	r0, r5
 3336 0232 FFF7FEFF 		bl	tcp_timewait_input
 3337              	.LVL275:
 264:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         return;
 3338              		.loc 1 264 0
 3339 0236 2046     		mov	r0, r4
 3340 0238 FFF7FEFF 		bl	pbuf_free
 3341              	.LVL276:
 265:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
 3342              		.loc 1 265 0
 3343 023c 61E7     		b	.L283
 3344              	.L326:
 3345              	.LVL277:
 272:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (lpcb->local_port == tcphdr->dest) {
 3346              		.loc 1 272 0
 3347 023e 124B     		ldr	r3, .L329+64
 3348 0240 1E68     		ldr	r6, [r3]
 3349              	.LVL278:
 3350 0242 3046     		mov	r0, r6
 271:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     for (lpcb = tcp_listen_pcbs.listen_pcbs; lpcb != NULL; lpcb = lpcb->next) {
 3351              		.loc 1 271 0
 3352 0244 2946     		mov	r1, r5
 272:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (lpcb->local_port == tcphdr->dest) {
 3353              		.loc 1 272 0
 3354 0246 23E0     		b	.L297
 3355              	.L330:
 3356              		.align	2
 3357              	.L329:
 3358 0248 00000000 		.word	.LANCHOR3
 3359 024c 00000000 		.word	ip_data
 3360 0250 00000000 		.word	.LANCHOR4
 3361 0254 00000000 		.word	.LANCHOR0
 3362 0258 00000000 		.word	.LANCHOR2
 3363 025c 00000000 		.word	.LANCHOR6
 3364 0260 00000000 		.word	.LANCHOR8
 3365 0264 00000000 		.word	.LANCHOR5
 3366 0268 00000000 		.word	.LANCHOR7
 3367 026c 00000000 		.word	tcp_active_pcbs
 3368 0270 00000000 		.word	.LANCHOR10
 3369 0274 00000000 		.word	.LANCHOR11
 3370 0278 00000000 		.word	.LANCHOR12
 3371 027c 00000000 		.word	.LANCHOR9
 3372 0280 00000000 		.word	tcp_input_pcb
 3373 0284 00000000 		.word	tcp_tw_pcbs
 3374 0288 00000000 		.word	tcp_listen_pcbs
 3375              	.LVL279:
 3376              	.L298:
 297:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
 3377              		.loc 1 297 0 discriminator 2
 3378 028c 0146     		mov	r1, r0
 272:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (lpcb->local_port == tcphdr->dest) {
 3379              		.loc 1 272 0 discriminator 2
 3380 028e C068     		ldr	r0, [r0, #12]
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 102


 3381              	.LVL280:
 3382              	.L297:
 272:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       if (lpcb->local_port == tcphdr->dest) {
 3383              		.loc 1 272 0 is_stmt 0 discriminator 1
 3384 0290 68B1     		cbz	r0, .L299
 273:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         if (IP_IS_ANY_TYPE_VAL(lpcb->local_ip)) {
 3385              		.loc 1 273 0 is_stmt 1
 3386 0292 C28A     		ldrh	r2, [r0, #22]
 3387 0294 564B     		ldr	r3, .L331
 3388 0296 1B68     		ldr	r3, [r3]
 3389 0298 5B88     		ldrh	r3, [r3, #2]	@ unaligned
 3390 029a 9A42     		cmp	r2, r3
 3391 029c F6D1     		bne	.L298
 283:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* found an exact match */
 3392              		.loc 1 283 0
 3393 029e 0368     		ldr	r3, [r0]
 3394 02a0 544A     		ldr	r2, .L331+4
 3395 02a2 5269     		ldr	r2, [r2, #20]
 3396 02a4 9342     		cmp	r3, r2
 3397 02a6 02D0     		beq	.L299
 286:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* found an ANY-match */
 3398              		.loc 1 286 0
 3399 02a8 08B1     		cbz	r0, .L299
 286:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* found an ANY-match */
 3400              		.loc 1 286 0 is_stmt 0 discriminator 1
 3401 02aa 002B     		cmp	r3, #0
 3402 02ac EED1     		bne	.L298
 3403              	.L299:
 307:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       /* Move this PCB to the front of the list so that subsequent
 3404              		.loc 1 307 0 is_stmt 1
 3405 02ae 0028     		cmp	r0, #0
 3406 02b0 3FF453AF 		beq	.L292
 311:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ((struct tcp_pcb_listen *)prev)->next = lpcb->next;
 3407              		.loc 1 311 0
 3408 02b4 21B1     		cbz	r1, .L301
 312:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               /* our successor is the remainder of the listening list */
 3409              		.loc 1 312 0
 3410 02b6 C368     		ldr	r3, [r0, #12]
 3411 02b8 CB60     		str	r3, [r1, #12]
 314:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               /* put this listening pcb at the head of the listening list */
 3412              		.loc 1 314 0
 3413 02ba C660     		str	r6, [r0, #12]
 316:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       } else {
 3414              		.loc 1 316 0
 3415 02bc 4E4B     		ldr	r3, .L331+8
 3416 02be 1860     		str	r0, [r3]
 3417              	.L301:
 322:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       pbuf_free(p);
 3418              		.loc 1 322 0
 3419 02c0 FFF7FEFF 		bl	tcp_listen_input
 3420              	.LVL281:
 323:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       return;
 3421              		.loc 1 323 0
 3422 02c4 2046     		mov	r0, r4
 3423 02c6 FFF7FEFF 		bl	pbuf_free
 3424              	.LVL282:
 324:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 103


 3425              		.loc 1 324 0
 3426 02ca 1AE7     		b	.L283
 3427              	.LVL283:
 3428              	.L306:
 384:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           u16_t acked16;
 3429              		.loc 1 384 0
 3430 02cc 4B4B     		ldr	r3, .L331+12
 3431 02ce 1A88     		ldrh	r2, [r3]
 3432 02d0 5AB1     		cbz	r2, .L308
 3433              	.LVL284:
 3434              	.LBB18:
 397:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (err == ERR_ABRT) {
 3435              		.loc 1 397 0
 3436 02d2 EB6F     		ldr	r3, [r5, #124]
 3437 02d4 13B3     		cbz	r3, .L321
 397:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (err == ERR_ABRT) {
 3438              		.loc 1 397 0 is_stmt 0 discriminator 1
 3439 02d6 2946     		mov	r1, r5
 3440 02d8 2869     		ldr	r0, [r5, #16]
 3441 02da 9847     		blx	r3
 3442              	.LVL285:
 3443              	.L309:
 398:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               goto aborted;
 3444              		.loc 1 398 0 is_stmt 1
 3445 02dc 10F10D0F 		cmn	r0, #13
 3446 02e0 3FF47EAF 		beq	.L305
 402:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 3447              		.loc 1 402 0
 3448 02e4 0022     		movs	r2, #0
 3449 02e6 454B     		ldr	r3, .L331+12
 3450 02e8 1A80     		strh	r2, [r3]	@ movhi
 3451              	.LVL286:
 3452              	.L308:
 3453              	.LBE18:
 404:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           /* The connection has been closed and we will deallocate the
 3454              		.loc 1 404 0
 3455 02ea 454B     		ldr	r3, .L331+16
 3456 02ec 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3457 02ee 13F0100F 		tst	r3, #16
 3458 02f2 15D0     		beq	.L310
 407:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Connection closed although the application has only shut down the
 3459              		.loc 1 407 0
 3460 02f4 AB7E     		ldrb	r3, [r5, #26]	@ zero_extendqisi2
 3461 02f6 13F0100F 		tst	r3, #16
 3462 02fa 06D1     		bne	.L311
 411:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 3463              		.loc 1 411 0
 3464 02fc D5F88C30 		ldr	r3, [r5, #140]
 3465 0300 1BB1     		cbz	r3, .L311
 411:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 3466              		.loc 1 411 0 is_stmt 0 discriminator 1
 3467 0302 6FF00E01 		mvn	r1, #14
 3468 0306 2869     		ldr	r0, [r5, #16]
 3469 0308 9847     		blx	r3
 3470              	.LVL287:
 3471              	.L311:
 413:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           memp_free(MEMP_TCP_PCB, pcb);
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 104


 3472              		.loc 1 413 0 is_stmt 1
 3473 030a 2946     		mov	r1, r5
 3474 030c 3D48     		ldr	r0, .L331+20
 3475 030e FFF7FEFF 		bl	tcp_pcb_remove
 3476              	.LVL288:
 414:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           goto aborted;
 3477              		.loc 1 414 0
 3478 0312 2946     		mov	r1, r5
 3479 0314 0120     		movs	r0, #1
 3480 0316 FFF7FEFF 		bl	memp_free
 3481              	.LVL289:
 415:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         }
 3482              		.loc 1 415 0
 3483 031a 61E7     		b	.L305
 3484              	.LVL290:
 3485              	.L321:
 3486              	.LBB19:
 397:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (err == ERR_ABRT) {
 3487              		.loc 1 397 0
 3488 031c 0020     		movs	r0, #0
 3489 031e DDE7     		b	.L309
 3490              	.LVL291:
 3491              	.L310:
 3492              	.LBE19:
 422:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #endif /* TCP_QUEUE_OOSEQ && LWIP_WND_SCALE */
 3493              		.loc 1 422 0
 3494 0320 394B     		ldr	r3, .L331+24
 3495 0322 1A68     		ldr	r2, [r3]
 3496 0324 92B1     		cbz	r2, .L312
 426:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* received data although already closed -> abort (send RST) to
 3497              		.loc 1 426 0
 3498 0326 AB7E     		ldrb	r3, [r5, #26]	@ zero_extendqisi2
 3499 0328 13F0100F 		tst	r3, #16
 3500 032c 20D1     		bne	.L327
 440:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (err == ERR_ABRT) {
 3501              		.loc 1 440 0
 3502 032e D5F88040 		ldr	r4, [r5, #128]
 3503              	.LVL292:
 3504 0332 24B3     		cbz	r4, .L314
 440:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (err == ERR_ABRT) {
 3505              		.loc 1 440 0 is_stmt 0 discriminator 1
 3506 0334 0023     		movs	r3, #0
 3507 0336 2946     		mov	r1, r5
 3508 0338 2869     		ldr	r0, [r5, #16]
 3509 033a A047     		blx	r4
 3510              	.LVL293:
 3511              	.L315:
 441:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ && LWIP_WND_SCALE
 3512              		.loc 1 441 0 is_stmt 1
 3513 033c 10F10D0F 		cmn	r0, #13
 3514 0340 3FF44EAF 		beq	.L305
 451:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ && LWIP_WND_SCALE
 3515              		.loc 1 451 0
 3516 0344 10B1     		cbz	r0, .L312
 457:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             LWIP_DEBUGF(TCP_INPUT_DEBUG, ("tcp_input: keep incoming packet, because pcb is \"full\"
 3517              		.loc 1 457 0
 3518 0346 304B     		ldr	r3, .L331+24
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 105


 3519 0348 1B68     		ldr	r3, [r3]
 3520 034a 6B67     		str	r3, [r5, #116]
 3521              	.LVL294:
 3522              	.L312:
 470:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (pcb->refused_data != NULL) {
 3523              		.loc 1 470 0
 3524 034c 2C4B     		ldr	r3, .L331+16
 3525 034e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3526 0350 13F0200F 		tst	r3, #32
 3527 0354 05D0     		beq	.L316
 471:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             /* Delay this if we have refused data. */
 3528              		.loc 1 471 0
 3529 0356 6B6F     		ldr	r3, [r5, #116]
 3530 0358 BBB1     		cbz	r3, .L317
 473:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           } else {
 3531              		.loc 1 473 0
 3532 035a 5A7B     		ldrb	r2, [r3, #13]	@ zero_extendqisi2
 3533 035c 42F02002 		orr	r2, r2, #32
 3534 0360 5A73     		strb	r2, [r3, #13]
 3535              	.L316:
 487:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         /* Try to send something out. */
 3536              		.loc 1 487 0
 3537 0362 0022     		movs	r2, #0
 3538 0364 294B     		ldr	r3, .L331+28
 3539 0366 1A60     		str	r2, [r3]
 489:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_INPUT_DEBUG
 3540              		.loc 1 489 0
 3541 0368 2846     		mov	r0, r5
 3542 036a FFF7FEFF 		bl	tcp_output
 3543              	.LVL295:
 3544 036e 37E7     		b	.L305
 3545              	.LVL296:
 3546              	.L327:
 429:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** #if TCP_QUEUE_OOSEQ && LWIP_WND_SCALE
 3547              		.loc 1 429 0
 3548 0370 1046     		mov	r0, r2
 3549 0372 FFF7FEFF 		bl	pbuf_free
 3550              	.LVL297:
 435:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             goto aborted;
 3551              		.loc 1 435 0
 3552 0376 2846     		mov	r0, r5
 3553 0378 FFF7FEFF 		bl	tcp_abort
 3554              	.LVL298:
 436:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           }
 3555              		.loc 1 436 0
 3556 037c 30E7     		b	.L305
 3557              	.LVL299:
 3558              	.L314:
 440:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****           if (err == ERR_ABRT) {
 3559              		.loc 1 440 0 discriminator 2
 3560 037e 0023     		movs	r3, #0
 3561 0380 2946     		mov	r1, r5
 3562 0382 1846     		mov	r0, r3
 3563 0384 FFF7FEFF 		bl	tcp_recv_null
 3564              	.LVL300:
 3565 0388 D8E7     		b	.L315
 3566              	.LVL301:
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 106


 3567              	.L317:
 477:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               pcb->rcv_wnd++;
 3568              		.loc 1 477 0
 3569 038a 2B8D     		ldrh	r3, [r5, #40]
 3570 038c B3F5066F 		cmp	r3, #2144
 3571 0390 01D0     		beq	.L318
 478:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             }
 3572              		.loc 1 478 0
 3573 0392 0133     		adds	r3, r3, #1
 3574 0394 2B85     		strh	r3, [r5, #40]	@ movhi
 3575              	.L318:
 480:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (err == ERR_ABRT) {
 3576              		.loc 1 480 0
 3577 0396 D5F88040 		ldr	r4, [r5, #128]
 3578 039a 44B1     		cbz	r4, .L322
 480:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (err == ERR_ABRT) {
 3579              		.loc 1 480 0 is_stmt 0 discriminator 1
 3580 039c 0023     		movs	r3, #0
 3581 039e 1A46     		mov	r2, r3
 3582 03a0 2946     		mov	r1, r5
 3583 03a2 2869     		ldr	r0, [r5, #16]
 3584 03a4 A047     		blx	r4
 3585              	.LVL302:
 3586              	.L319:
 481:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****               goto aborted;
 3587              		.loc 1 481 0 is_stmt 1
 3588 03a6 10F10D0F 		cmn	r0, #13
 3589 03aa DAD1     		bne	.L316
 3590 03ac 18E7     		b	.L305
 3591              	.LVL303:
 3592              	.L322:
 480:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****             if (err == ERR_ABRT) {
 3593              		.loc 1 480 0
 3594 03ae 0020     		movs	r0, #0
 3595 03b0 F9E7     		b	.L319
 3596              	.LVL304:
 3597              	.L302:
 514:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       TCP_STATS_INC(tcp.proterr);
 3598              		.loc 1 514 0
 3599 03b2 0F4B     		ldr	r3, .L331
 3600 03b4 1B68     		ldr	r3, [r3]
 3601 03b6 9889     		ldrh	r0, [r3, #12]	@ unaligned
 3602 03b8 FFF7FEFF 		bl	lwip_htons
 3603              	.LVL305:
 3604 03bc 10F0040F 		tst	r0, #4
 3605 03c0 03D0     		beq	.L328
 3606              	.LVL306:
 3607              	.L320:
 520:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
 3608              		.loc 1 520 0
 3609 03c2 2046     		mov	r0, r4
 3610 03c4 FFF7FEFF 		bl	pbuf_free
 3611              	.LVL307:
 3612 03c8 9BE6     		b	.L283
 3613              	.LVL308:
 3614              	.L328:
 518:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 107


 3615              		.loc 1 518 0
 3616 03ca 094B     		ldr	r3, .L331
 3617 03cc 1B68     		ldr	r3, [r3]
 517:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****         ip_current_src_addr(), tcphdr->dest, tcphdr->src);
 3618              		.loc 1 517 0
 3619 03ce 104A     		ldr	r2, .L331+32
 3620 03d0 1049     		ldr	r1, .L331+36
 3621 03d2 0888     		ldrh	r0, [r1]
 3622 03d4 1049     		ldr	r1, .L331+40
 3623 03d6 0968     		ldr	r1, [r1]
 3624 03d8 1D88     		ldrh	r5, [r3]	@ unaligned
 3625              	.LVL309:
 3626 03da 0195     		str	r5, [sp, #4]
 3627 03dc 5B88     		ldrh	r3, [r3, #2]	@ unaligned
 3628 03de 0093     		str	r3, [sp]
 3629 03e0 1346     		mov	r3, r2
 3630 03e2 0432     		adds	r2, r2, #4
 3631 03e4 0144     		add	r1, r1, r0
 3632 03e6 0D48     		ldr	r0, .L331+44
 3633 03e8 0068     		ldr	r0, [r0]
 3634 03ea FFF7FEFF 		bl	tcp_rst
 3635              	.LVL310:
 3636 03ee E8E7     		b	.L320
 3637              	.L332:
 3638              		.align	2
 3639              	.L331:
 3640 03f0 00000000 		.word	.LANCHOR3
 3641 03f4 00000000 		.word	ip_data
 3642 03f8 00000000 		.word	tcp_listen_pcbs
 3643 03fc 00000000 		.word	.LANCHOR9
 3644 0400 00000000 		.word	.LANCHOR12
 3645 0404 00000000 		.word	tcp_active_pcbs
 3646 0408 00000000 		.word	.LANCHOR11
 3647 040c 00000000 		.word	tcp_input_pcb
 3648 0410 10000000 		.word	ip_data+16
 3649 0414 00000000 		.word	.LANCHOR7
 3650 0418 00000000 		.word	.LANCHOR6
 3651 041c 00000000 		.word	.LANCHOR8
 3652              		.cfi_endproc
 3653              	.LFE136:
 3655              		.section	.text.tcp_trigger_input_pcb_close,"ax",%progbits
 3656              		.align	1
 3657              		.global	tcp_trigger_input_pcb_close
 3658              		.syntax unified
 3659              		.thumb
 3660              		.thumb_func
 3661              		.fpu fpv5-sp-d16
 3663              	tcp_trigger_input_pcb_close:
 3664              	.LFB144:
1802:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****       }
1803:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****     }
1804:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   }
1805:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** }
1806:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** 
1807:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** void
1808:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** tcp_trigger_input_pcb_close(void)
1809:Middlewares/Third_Party/LwIP/src/core/tcp_in.c **** {
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 108


 3665              		.loc 1 1809 0
 3666              		.cfi_startproc
 3667              		@ args = 0, pretend = 0, frame = 0
 3668              		@ frame_needed = 0, uses_anonymous_args = 0
 3669              		@ link register save eliminated.
1810:Middlewares/Third_Party/LwIP/src/core/tcp_in.c ****   recv_flags |= TF_CLOSED;
 3670              		.loc 1 1810 0
 3671 0000 024A     		ldr	r2, .L334
 3672 0002 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 3673 0004 43F01003 		orr	r3, r3, #16
 3674 0008 1370     		strb	r3, [r2]
 3675 000a 7047     		bx	lr
 3676              	.L335:
 3677              		.align	2
 3678              	.L334:
 3679 000c 00000000 		.word	.LANCHOR12
 3680              		.cfi_endproc
 3681              	.LFE144:
 3683              		.comm	tcp_input_pcb,4,4
 3684              		.section	.bss.ackno,"aw",%nobits
 3685              		.align	2
 3686              		.set	.LANCHOR8,. + 0
 3689              	ackno:
 3690 0000 00000000 		.space	4
 3691              		.section	.bss.flags,"aw",%nobits
 3692              		.set	.LANCHOR5,. + 0
 3695              	flags:
 3696 0000 00       		.space	1
 3697              		.section	.bss.inseg,"aw",%nobits
 3698              		.align	2
 3699              		.set	.LANCHOR10,. + 0
 3702              	inseg:
 3703 0000 00000000 		.space	16
 3703      00000000 
 3703      00000000 
 3703      00000000 
 3704              		.section	.bss.recv_acked,"aw",%nobits
 3705              		.align	1
 3706              		.set	.LANCHOR9,. + 0
 3709              	recv_acked:
 3710 0000 0000     		.space	2
 3711              		.section	.bss.recv_data,"aw",%nobits
 3712              		.align	2
 3713              		.set	.LANCHOR11,. + 0
 3716              	recv_data:
 3717 0000 00000000 		.space	4
 3718              		.section	.bss.recv_flags,"aw",%nobits
 3719              		.set	.LANCHOR12,. + 0
 3722              	recv_flags:
 3723 0000 00       		.space	1
 3724              		.section	.bss.seqno,"aw",%nobits
 3725              		.align	2
 3726              		.set	.LANCHOR6,. + 0
 3729              	seqno:
 3730 0000 00000000 		.space	4
 3731              		.section	.bss.tcp_optidx,"aw",%nobits
 3732              		.align	1
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 109


 3733              		.set	.LANCHOR1,. + 0
 3736              	tcp_optidx:
 3737 0000 0000     		.space	2
 3738              		.section	.bss.tcphdr,"aw",%nobits
 3739              		.align	2
 3740              		.set	.LANCHOR3,. + 0
 3743              	tcphdr:
 3744 0000 00000000 		.space	4
 3745              		.section	.bss.tcphdr_opt1len,"aw",%nobits
 3746              		.align	1
 3747              		.set	.LANCHOR2,. + 0
 3750              	tcphdr_opt1len:
 3751 0000 0000     		.space	2
 3752              		.section	.bss.tcphdr_opt2,"aw",%nobits
 3753              		.align	2
 3754              		.set	.LANCHOR0,. + 0
 3757              	tcphdr_opt2:
 3758 0000 00000000 		.space	4
 3759              		.section	.bss.tcphdr_optlen,"aw",%nobits
 3760              		.align	1
 3761              		.set	.LANCHOR4,. + 0
 3764              	tcphdr_optlen:
 3765 0000 0000     		.space	2
 3766              		.section	.bss.tcplen,"aw",%nobits
 3767              		.align	1
 3768              		.set	.LANCHOR7,. + 0
 3771              	tcplen:
 3772 0000 0000     		.space	2
 3773              		.text
 3774              	.Letext0:
 3775              		.file 2 "c:\\gcc_toolchain\\6_2017-q1-update\\arm-none-eabi\\include\\machine\\_default_types.h"
 3776              		.file 3 "c:\\gcc_toolchain\\6_2017-q1-update\\arm-none-eabi\\include\\sys\\_stdint.h"
 3777              		.file 4 "Drivers/CMSIS/Include/core_cm7.h"
 3778              		.file 5 "Drivers/CMSIS/Device/ST/STM32F7xx/Include/system_stm32f7xx.h"
 3779              		.file 6 "c:\\gcc_toolchain\\6_2017-q1-update\\arm-none-eabi\\include\\sys\\lock.h"
 3780              		.file 7 "c:\\gcc_toolchain\\6_2017-q1-update\\arm-none-eabi\\include\\sys\\_types.h"
 3781              		.file 8 "c:\\gcc_toolchain\\6_2017-q1-update\\lib\\gcc\\arm-none-eabi\\6.3.1\\include\\stddef.h"
 3782              		.file 9 "c:\\gcc_toolchain\\6_2017-q1-update\\arm-none-eabi\\include\\sys\\reent.h"
 3783              		.file 10 "c:\\gcc_toolchain\\6_2017-q1-update\\arm-none-eabi\\include\\stdlib.h"
 3784              		.file 11 "Middlewares/Third_Party/LwIP/src/include/lwip/arch.h"
 3785              		.file 12 "Middlewares/Third_Party/LwIP/src/include/lwip/err.h"
 3786              		.file 13 "Middlewares/Third_Party/LwIP/src/include/lwip/pbuf.h"
 3787              		.file 14 "Middlewares/Third_Party/LwIP/src/include/lwip/ip4_addr.h"
 3788              		.file 15 "Middlewares/Third_Party/LwIP/src/include/lwip/ip_addr.h"
 3789              		.file 16 "Middlewares/Third_Party/LwIP/src/include/lwip/memp.h"
 3790              		.file 17 "Middlewares/Third_Party/LwIP/src/include/lwip/priv/memp_priv.h"
 3791              		.file 18 "Middlewares/Third_Party/LwIP/src/include/lwip/netif.h"
 3792              		.file 19 "Middlewares/Third_Party/LwIP/src/include/lwip/prot/ip4.h"
 3793              		.file 20 "Middlewares/Third_Party/LwIP/src/include/lwip/ip.h"
 3794              		.file 21 "Middlewares/Third_Party/LwIP/src/include/lwip/tcp.h"
 3795              		.file 22 "Middlewares/Third_Party/LwIP/src/include/lwip/priv/tcp_priv.h"
 3796              		.file 23 "Middlewares/Third_Party/LwIP/src/include/lwip/prot/tcp.h"
 3797              		.file 24 "Middlewares/Third_Party/LwIP/src/include/lwip/def.h"
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 110


DEFINED SYMBOLS
                            *ABS*:00000000 tcp_in.c
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:18     .text.tcp_getoptbyte:00000000 $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:24     .text.tcp_getoptbyte:00000000 tcp_getoptbyte
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:86     .text.tcp_getoptbyte:0000003c $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:95     .text.tcp_parseopt:00000000 $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:101    .text.tcp_parseopt:00000000 tcp_parseopt
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:204    .text.tcp_parseopt:00000080 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:211    .text.tcp_timewait_input:00000000 $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:217    .text.tcp_timewait_input:00000000 tcp_timewait_input
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:316    .text.tcp_timewait_input:00000074 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:327    .text.tcp_listen_input:00000000 $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:333    .text.tcp_listen_input:00000000 tcp_listen_input
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:528    .text.tcp_listen_input:000000f0 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:541    .text.tcp_oos_insert_segment:00000000 $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:547    .text.tcp_oos_insert_segment:00000000 tcp_oos_insert_segment
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:653    .text.tcp_oos_insert_segment:00000080 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:658    .text.tcp_receive:00000000 $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:664    .text.tcp_receive:00000000 tcp_receive
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:1095   .text.tcp_receive:00000284 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:1103   .text.tcp_receive:0000029c $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:1511   .text.tcp_receive:000004f8 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:1519   .text.tcp_receive:00000510 $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:1902   .text.tcp_receive:00000748 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:1910   .text.tcp_receive:0000075c $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:2047   .text.tcp_receive:0000083c $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:2054   .text.tcp_process:00000000 $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:2060   .text.tcp_process:00000000 tcp_process
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:2211   .text.tcp_process:000000bc $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:2219   .text.tcp_process:000000cc $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:2535   .text.tcp_process:000002b0 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:2546   .text.tcp_process:000002d4 $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:2903   .text.tcp_process:000004b0 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:2913   .text.tcp_input:00000000 $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:2920   .text.tcp_input:00000000 tcp_input
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3358   .text.tcp_input:00000248 $d
                            *COM*:00000004 tcp_input_pcb
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3378   .text.tcp_input:0000028c $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3640   .text.tcp_input:000003f0 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3656   .text.tcp_trigger_input_pcb_close:00000000 $t
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3663   .text.tcp_trigger_input_pcb_close:00000000 tcp_trigger_input_pcb_close
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3679   .text.tcp_trigger_input_pcb_close:0000000c $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3685   .bss.ackno:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3689   .bss.ackno:00000000 ackno
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3695   .bss.flags:00000000 flags
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3696   .bss.flags:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3698   .bss.inseg:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3702   .bss.inseg:00000000 inseg
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3705   .bss.recv_acked:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3709   .bss.recv_acked:00000000 recv_acked
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3712   .bss.recv_data:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3716   .bss.recv_data:00000000 recv_data
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3722   .bss.recv_flags:00000000 recv_flags
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3723   .bss.recv_flags:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3725   .bss.seqno:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3729   .bss.seqno:00000000 seqno
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3732   .bss.tcp_optidx:00000000 $d
ARM GAS  C:\Users\Student\AppData\Local\Temp\cczovU3g.s 			page 111


C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3736   .bss.tcp_optidx:00000000 tcp_optidx
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3739   .bss.tcphdr:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3743   .bss.tcphdr:00000000 tcphdr
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3746   .bss.tcphdr_opt1len:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3750   .bss.tcphdr_opt1len:00000000 tcphdr_opt1len
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3753   .bss.tcphdr_opt2:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3757   .bss.tcphdr_opt2:00000000 tcphdr_opt2
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3760   .bss.tcphdr_optlen:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3764   .bss.tcphdr_optlen:00000000 tcphdr_optlen
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3767   .bss.tcplen:00000000 $d
C:\Users\Student\AppData\Local\Temp\cczovU3g.s:3771   .bss.tcplen:00000000 tcplen
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
tcp_rst
tcp_output
ip_data
tcp_ticks
tcp_alloc
tcp_timer_needed
tcp_eff_send_mss_impl
tcp_enqueue_flags
tcp_abandon
tcp_active_pcbs
tcp_active_pcbs_changed
lwip_htons
tcp_segs_free
tcp_seg_free
pbuf_realloc
tcp_send_empty_ack
tcp_rexmit_fast
pbuf_clen
lwip_htonl
pbuf_header
tcp_update_rcv_ann_wnd
pbuf_cat
tcp_seg_copy
tcp_rexmit_rto
tcp_abort
tcp_rexmit
tcp_pcb_purge
tcp_tw_pcbs
ip4_addr_isbroadcast_u32
pbuf_free
tcp_process_refused_data
tcp_pcb_remove
memp_free
tcp_listen_pcbs
tcp_recv_null
